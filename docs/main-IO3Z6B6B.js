import{$ as k,A as nn,Aa as Td,B as Aa,Ba as Ad,C as Un,Ca as is,D as Zi,Da as Cd,E as xt,Ea as Sd,F as Ca,Fa as Pd,G as es,Ga as Rd,H as Br,I as dd,J as ts,K as fd,L as pd,M as U,N as jr,O as Vt,P as md,Q as qr,R as le,S as fe,T as Sa,U as je,V as gt,W as se,X as gd,Y as _d,Z as Pa,_ as Q,a as ve,aa as R,b as Re,ba as oe,c as A,ca as Mt,d as tn,da as rn,e as od,ea as yd,f as ad,fa as vd,g as cd,ga as wd,h as va,ha as ns,i as wa,ia as Fe,j as Ia,ja as Je,k as Ea,ka as Id,l as Lr,la as _t,m as ud,ma as V,n as ba,na as qe,o as ld,oa as Le,p as Ur,pa as Bn,q as Fn,qa as $r,r as Ln,ra as Ed,s as Ta,sa as Ft,t as Ye,ta as zr,u as we,ua as Ra,v as Qi,va as bd,w as hd,wa as Da,x as Yi,xa as Ge,y as Ji,ya as rs,z as Xi,za as Ie}from"./chunk-KFXVM2SA.js";var W_=()=>({exact:!0});function H_(n,e){if(n&1){let t=ns();k(0,"li")(1,"a",7),Fe("click",function(){Ji(t);let i=Je();return Xi(i.closeMobileMenu())}),V(2),R()()}if(n&2){let t=e.$implicit;U(),Q("routerLink",t.path)("fragment",t.fragment)("routerLinkActiveOptions",$r(4,W_)),U(),Le(" ",t.label," ")}}var ss=class n{mobileMenuOpen=!1;scrolled=!1;links=[{label:"Start",path:"/",fragment:"start"},{label:"\xDCber uns",path:"/",fragment:"ueber-uns"},{label:"Preise",path:"/",fragment:"preise"},{label:"Galerie",path:"/",fragment:"galerie"},{label:"Kontakt",path:"/",fragment:"kontakt"}];toggleMobileMenu(){this.mobileMenuOpen=!this.mobileMenuOpen}closeMobileMenu(){this.mobileMenuOpen=!1}onScroll(){this.scrolled=window.scrollY>20}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-navigation"]],hostBindings:function(t,r){t&1&&Fe("scroll",function(){return r.onScroll()},pd)},decls:15,vars:5,consts:[[1,"nav-container"],["routerLink","/","fragment","start",1,"brand",3,"click"],["type","button","aria-label","Men\xFC umschalten",1,"menu-toggle",3,"click"],[1,"nav-links"],[4,"ngFor","ngForOf"],[1,"cta"],["routerLink","/","fragment","termine",3,"click"],["routerLinkActive","active",3,"click","routerLink","fragment","routerLinkActiveOptions"]],template:function(t,r){t&1&&(k(0,"header")(1,"nav",0)(2,"a",1),Fe("click",function(){return r.closeMobileMenu()}),k(3,"span"),V(4,"City"),R(),V(5,"-Style "),R(),k(6,"button",2),Fe("click",function(){return r.toggleMobileMenu()}),oe(7,"span")(8,"span")(9,"span"),R(),k(10,"ul",3),se(11,H_,3,5,"li",4),k(12,"li",5)(13,"a",6),Fe("click",function(){return r.closeMobileMenu()}),V(14," Termin buchen "),R()()()()()),t&2&&(_t("scrolled",r.scrolled),U(10),_t("open",r.mobileMenuOpen),U(),Q("ngForOf",r.links))},dependencies:[Ie,Ge,is,Cd],styles:['header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;z-index:1000;transition:background-color .4s ease,box-shadow .4s ease,padding .4s ease;padding:1.75rem 0}header.scrolled[_ngcontent-%COMP%]{background:#0c0a18cc;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:.85rem 0;box-shadow:0 10px 30px #00000059}.nav-container[_ngcontent-%COMP%]{max-width:1100px;margin:0 auto;padding:0 1.5rem;display:flex;align-items:center;justify-content:space-between}.brand[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:1.9rem;font-weight:600;color:#fff;text-decoration:none;letter-spacing:.15rem;transition:color .3s ease}.brand[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#e4c05f}.brand[_ngcontent-%COMP%]:hover{color:#dcbf68}.nav-links[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.4rem;list-style:none;margin:0;padding:0;transition:transform .4s ease,opacity .4s ease}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-weight:500;letter-spacing:.04rem;position:relative;padding:.35rem 0;transition:color .3s ease}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:0;width:100%;height:2px;background:linear-gradient(90deg,#f7e7b4,#dcbf68);transform:scaleX(0);transform-origin:right;transition:transform .3s ease}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:left}.nav-links[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#dcbf68}.nav-links[_ngcontent-%COMP%]   .cta[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:.55rem 1.3rem;border-radius:999px;background:linear-gradient(135deg,#f7e7b4,#dcbf68);color:#0c0a18;font-weight:600;box-shadow:0 10px 30px #dcbf6859}.nav-links[_ngcontent-%COMP%]   .cta[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#0c0a18;box-shadow:0 10px 35px #dcbf687a}.menu-toggle[_ngcontent-%COMP%]{display:none;flex-direction:column;gap:.4rem;background:transparent;border:none;cursor:pointer}.menu-toggle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:2rem;height:.2rem;background:#fff;border-radius:999px;transition:transform .3s ease}@media (max-width: 900px){.menu-toggle[_ngcontent-%COMP%]{display:flex}.nav-links[_ngcontent-%COMP%]{position:absolute;top:100%;right:1.5rem;padding:1.5rem;background:#0c0a18f2;border-radius:1.2rem;flex-direction:column;align-items:flex-start;transform:translateY(-10px);opacity:0;pointer-events:none}.nav-links.open[_ngcontent-%COMP%]{transform:translateY(0);opacity:1;pointer-events:auto}.nav-links[_ngcontent-%COMP%]   .cta[_ngcontent-%COMP%]{align-self:stretch;width:100%}.nav-links[_ngcontent-%COMP%]   .cta[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;text-align:center}}']})};var Dd=()=>["/datenschutzundimpressum"],os=class n{year=new Date().getFullYear();static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-footer"]],decls:11,vars:5,consts:[[1,"footer"],[1,"footer-content"],[1,"links"],[3,"routerLink"],["fragment","datenschutz",3,"routerLink"],["routerLink","/","fragment","termine"]],template:function(t,r){t&1&&(k(0,"footer",0)(1,"div",1)(2,"p"),V(3),R(),k(4,"div",2)(5,"a",3),V(6," Impressum "),R(),k(7,"a",4),V(8," Datenschutz "),R(),k(9,"a",5),V(10," Termin buchen "),R()()()()),t&2&&(U(3),Le("\xA9 ",r.year," City-Style Salon \xB7 Urban Hair Excellence"),U(2),Q("routerLink",$r(3,Dd)),U(2),Q("routerLink",$r(4,Dd)))},dependencies:[Ie,is],styles:[".footer[_ngcontent-%COMP%]{background:#0c0a18;color:#ffffffbf;padding:2rem 1.5rem}.footer-content[_ngcontent-%COMP%]{max-width:1100px;margin:0 auto;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:1rem}.links[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ffffffbf;text-decoration:none;font-weight:500;transition:color .3s ease}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#dcbf68}@media (max-width: 600px){.footer-content[_ngcontent-%COMP%]{flex-direction:column;text-align:center}}"]})};var as=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-root"]],decls:3,vars:0,template:function(t,r){t&1&&oe(0,"app-navigation")(1,"router-outlet")(2,"app-footer")},dependencies:[Ad,ss,os],styles:["[_nghost-%COMP%]{display:block;background:#fdfcfe;color:#0c0a18;scroll-behavior:smooth}"]})};var cs=class n{highlights=["Signature-Stylings inspiriert von den Modemetropolen","Premium-Produkte & ma\xDFgeschneiderte Beratung","Late-Night-Services f\xFCr After-Work-Termine"];static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-hero"]],decls:18,vars:0,consts:[["id","start",1,"hero"],[1,"backdrop"],[1,"hero-content"],["data-animate","fade-up",1,"intro"],[1,"eyebrow"],[1,"description"],[1,"cta-group"],["href","#termine",1,"primary-cta"],["href","#galerie",1,"secondary-cta"]],template:function(t,r){t&1&&(Mt(0,"section",0),yd(1,"div",1),Mt(2,"div",2)(3,"div",3)(4,"p",4),V(5,"City-Style \xB7 Urban Eleganz"),rn(),Mt(6,"h1"),V(7," Dein exklusiver "),Mt(8,"span"),V(9,"Friseursalon"),rn(),V(10," im Herzen der Stadt "),rn(),Mt(11,"p",5),V(12," Erlebe personalisierte Looks, moderne Schnitte und Farbakzente, die Deinen Lifestyle widerspiegeln. Unsere Expert:innen bringen Runway-Trends direkt zu Dir \u2013 f\xFCr Selbstbewusstsein bei jedem Auftritt. "),rn(),Mt(13,"div",6)(14,"a",7),V(15,"Termin vereinbaren"),rn(),Mt(16,"a",8),V(17,"Inspiration entdecken"),rn()()()()())},dependencies:[Ie],styles:[".hero[_ngcontent-%COMP%]{position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:5.5rem 1.5rem 3.5rem;color:#fff;background-image:url(https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=1600&q=80);background-size:cover;background-position:center;overflow:hidden}.backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(120deg,#0c0a18d9,#0c0a1866);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);z-index:0}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:1;max-width:1100px;width:100%;display:grid;grid-template-columns:1.2fr .8fr;gap:3rem;align-items:center}.eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.5rem;font-weight:500;color:#fffc;margin-bottom:1.8rem}h1[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:clamp(2.75rem,4vw,4rem);line-height:1.1;margin-bottom:1.5rem}h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#e4c05f}.description[_ngcontent-%COMP%]{font-size:1.05rem;max-width:36rem;line-height:1.6;margin-bottom:1.9rem;color:#ffffffd9}.cta-group[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap}.primary-cta[_ngcontent-%COMP%], .secondary-cta[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:.9rem 2rem;border-radius:999px;font-weight:600;text-decoration:none;transition:transform .3s ease,box-shadow .3s ease,background .3s ease;letter-spacing:.05rem}.primary-cta[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f7e7b4,#dcbf68);color:#0c0a18;box-shadow:0 20px 35px #dcbf6859}.primary-cta[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 26px 45px #dcbf6873}.secondary-cta[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.45);color:#fff;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}.secondary-cta[_ngcontent-%COMP%]:hover{transform:translateY(-4px);background:#ffffff26}.highlight-panel[_ngcontent-%COMP%]{background:#0c0a18a6;border-radius:1.8rem;padding:2rem;box-shadow:0 20px 45px #00000059;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.08);animation:_ngcontent-%COMP%_float 6s ease-in-out infinite}.highlight-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:grid;gap:1.4rem}.highlight-panel[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.85rem;font-size:1rem;color:#ffffffe6}.highlight-panel[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.35rem}.availability[_ngcontent-%COMP%]{margin-top:1.5rem;display:inline-flex;align-items:center;gap:.65rem;padding:.7rem 1.1rem;border-radius:999px;background:#1affad1f;color:#acffdc;font-weight:600;letter-spacing:.04rem}.availability[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:.7rem;height:.7rem;border-radius:50%;background:#1affad;box-shadow:0 0 15px #1affadcc}[data-animate=fade-up][_ngcontent-%COMP%], [data-animate=fade-left][_ngcontent-%COMP%]{opacity:0;transform:translate3d(0,20px,0);animation:_ngcontent-%COMP%_fadeIn 1.4s ease forwards .3s}[data-animate=fade-left][_ngcontent-%COMP%]{transform:translate3d(20px,0,0);animation-delay:.6s}@keyframes _ngcontent-%COMP%_fadeIn{to{opacity:1;transform:translateZ(0)}}@keyframes _ngcontent-%COMP%_float{0%,to{transform:translateY(0)}50%{transform:translateY(-12px)}}@media (max-width: 900px){.hero[_ngcontent-%COMP%]{padding-top:7.5rem}.hero-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:2.5rem}.highlight-panel[_ngcontent-%COMP%]{animation:none}}@media (max-width: 600px){.cta-group[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}"]})};function K_(n,e){if(n&1&&(k(0,"div",6)(1,"span",7),V(2),R(),k(3,"span",8),V(4),R()()),n&2){let t=e.$implicit;U(2),qe(t.value),U(2),qe(t.label)}}var us=class n{highlights=[{value:"15+",label:"Jahre Erfahrung im Hair Design"},{value:"1.200+",label:"zufriedene Kunden"}];static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-about"]],decls:13,vars:1,consts:[["id","ueber-uns",1,"about-section"],["data-animate","fade-right",1,"image-wrapper"],["src","assets/city1.jpeg","alt","Stylistin beim Schneiden eines modernen Haarschnitts"],["data-animate","fade-left",1,"content"],[1,"highlights"],["class","highlight",4,"ngFor","ngForOf"],[1,"highlight"],[1,"value"],[1,"label"]],template:function(t,r){t&1&&(k(0,"section",0)(1,"div",1)(2,"figure"),oe(3,"img",2),R()(),k(4,"div",3)(5,"h2"),V(6,"\xDCber City-Style"),R(),k(7,"p"),V(8," City-Style vereint internationale Trends mit pers\xF6nlicher Beratung. Unser Team aus preisgekr\xF6nten Stylist:innen entwickelt individuelle Looks, die Deinen Charakter betonen und gleichzeitig f\xFCr Deinen Alltag funktionieren. Wir nehmen uns Zeit, h\xF6ren zu und arbeiten mit nachhaltigen Premium-Produkten, die Dein Haar langfristig st\xE4rken. "),R(),k(9,"p"),V(10," Egal ob Business-Look, mutige Coloration oder Glam-Event-Styling \u2013 unsere City-Style-Expert:innen begleiten Dich von der Idee bis zum Finish. Ganz nebenbei verwandeln wir Deinen Termin in eine kleine Auszeit vom Gro\xDFstadttrubel. "),R(),k(11,"div",4),se(12,K_,5,2,"div",5),R()()()),t&2&&(U(12),Q("ngForOf",r.highlights))},dependencies:[Ie,Ge],styles:['.about-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr);gap:3.5rem;align-items:center;max-width:1100px;margin:0 auto;padding:4.5rem 1.5rem;min-height:100vh}.image-wrapper[_ngcontent-%COMP%]{position:relative}.image-wrapper[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2.5rem -2.5rem 2.5rem 2.5rem;background:linear-gradient(135deg,#e7c36b66,#dcbf6866);border-radius:2rem;filter:blur(40px);z-index:0}figure[_ngcontent-%COMP%]{position:relative;margin:0;border-radius:1.8rem;overflow:hidden;box-shadow:0 40px 80px #0c0a1833;z-index:1}figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:100%;object-fit:cover;transform:scale(1.02);transition:transform .6s ease}figure[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.06)}figcaption[_ngcontent-%COMP%]{position:absolute;left:1.5rem;bottom:1.5rem;right:1.5rem;background:#0c0a18bf;color:#fff;padding:1.2rem 1.4rem;border-radius:1.2rem;font-size:.95rem;line-height:1.5;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}.highlights[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:1.3rem;margin-top:1.8rem}.highlight[_ngcontent-%COMP%]{padding:1.4rem;border-radius:1.2rem;background:linear-gradient(135deg,#e7c36b24,#dcbf682e);border:1px solid rgba(220,191,104,.4);box-shadow:0 12px 25px #dcbf6833;transition:transform .35s ease,box-shadow .35s ease}.highlight[_ngcontent-%COMP%]:hover{transform:translateY(-6px);box-shadow:0 18px 40px #dcbf684d}.highlight[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:block;font-size:2rem;font-weight:700;color:#dcbf68}.highlight[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;font-size:.95rem;color:#0c0a18a6;margin-top:.4rem}[data-animate=fade-right][_ngcontent-%COMP%], [data-animate=fade-left][_ngcontent-%COMP%]{opacity:0;transform:translate3d(-30px,0,0);animation:_ngcontent-%COMP%_aboutFade 1.1s ease forwards}[data-animate=fade-left][_ngcontent-%COMP%]{transform:translate3d(30px,0,0);animation-delay:.2s}@keyframes _ngcontent-%COMP%_aboutFade{to{opacity:1;transform:translateZ(0)}}@media (max-width: 900px){.about-section[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:2.2rem}.highlights[_ngcontent-%COMP%]{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (max-width: 600px){.highlights[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})};function Q_(n,e){if(n&1&&(k(0,"span",13),V(1),R()),n&2){let t=Je().$implicit;U(),qe(t.note)}}function Y_(n,e){if(n&1&&(k(0,"tr")(1,"td",9)(2,"span",10),V(3),R(),se(4,Q_,2,1,"span",11),R(),k(5,"td",12),V(6),R()()),n&2){let t=e.$implicit;U(3),qe(t.name),U(),Q("ngIf",t.note),U(2),Le(" ",t.price," ")}}function J_(n,e){if(n&1&&(k(0,"div",5)(1,"div",6)(2,"h3"),V(3),R()(),k(4,"table",7)(5,"thead")(6,"tr")(7,"th"),V(8,"Service"),R(),k(9,"th"),V(10,"Preis"),R()()(),k(11,"tbody"),se(12,Y_,7,3,"tr",8),R()()()),n&2){let t=e.$implicit;U(3),qe(t.title),U(9),Q("ngForOf",t.items)}}var ls=class n{categories=[{title:"Herren",items:[{name:"Schneiden/F\xF6hnen",price:"18 \u20AC"},{name:"Waschen/Schneiden/F\xF6hnen",price:"18 \u20AC"},{name:"Nassrasur",price:"10 \u20AC"},{name:"Schneiden/Formen mit Schere",price:"10 \u20AC"},{name:"Bart stutzen",price:"10 \u20AC"},{name:"Bart formen",price:"7 \u20AC"},{name:"Augenbrauen zupfen mit Faden",price:"15 \u20AC"},{name:"Wachs Gesicht komplett",price:"ab 25 \u20AC"},{name:"Augenbrauen mit Messer",price:"ab 40 \u20AC"},{name:"Farbe/Str\xE4hnen",price:"ab 50 \u20AC"},{name:"Dauerwelle",price:"ab 40 \u20AC"},{name:"Haare Gl\xE4ttung",price:"ab 50 \u20AC"},{name:"Haare Waschen",price:"3 \u20AC"}]},{title:"Damen",items:[{name:"Waschen/Schneiden (kurz)",price:"22 \u20AC"},{name:"Waschen/Schneiden (lang)",price:"25 \u20AC"},{name:"Waschen/Schneiden/F\xF6hnen",price:"35 \u20AC"},{name:"Haarmaske",price:"6 \u20AC"},{name:"Pony schneiden",price:"7 \u20AC"},{name:"Ans\xE4tze f\xE4rben",price:"ab 25 \u20AC"},{name:"Komplett f\xE4rben",price:"ab 30 \u20AC"},{name:"Str\xE4hnen am Oberkopf",price:"ab 40 \u20AC"},{name:"Str\xE4hnen komplett",price:"ab 80 \u20AC"},{name:"F\xF6hnen",price:"ab 45 \u20AC"},{name:"Dauerwelle",price:"ab 65 \u20AC"},{name:"Haare Gl\xE4ttung",price:"ab 150 \u20AC"},{name:"Augenbrauen zupfen (mit Fadentechnik)",price:"13 \u20AC"},{name:"Augenbrauen f\xE4rben",price:"20 \u20AC"},{name:"Wimpern f\xE4rben",price:"18 \u20AC"},{name:"Balayage",price:"220 - 300 \u20AC"}]},{title:"Kinder",items:[{name:"Jungs bis 7 Jahre",price:"13 \u20AC"},{name:"M\xE4dchen bis 7 Jahre",price:"20 \u20AC"}]}];static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-pricing"]],decls:10,vars:1,consts:[["id","preise",1,"pricing-section"],[1,"section-heading"],[1,"eyebrow"],[1,"tables"],["class","table-wrapper",4,"ngFor","ngForOf"],[1,"table-wrapper"],[1,"table-heading"],[1,"pricing-table"],[4,"ngFor","ngForOf"],[1,"service"],[1,"name"],["class","note",4,"ngIf"],[1,"price"],[1,"note"]],template:function(t,r){t&1&&(k(0,"section",0)(1,"div",1)(2,"span",2),V(3,"Preise"),R(),k(4,"h2"),V(5,"City-Style Pricing"),R(),k(6,"p"),V(7," Alle Preise auf einen Blick \u2013 \xFCbersichtlich nach Herren, Damen und Kinder sortiert. "),R()(),k(8,"div",3),se(9,J_,13,2,"div",4),R()()),t&2&&(U(9),Q("ngForOf",r.categories))},dependencies:[Ie,Ge,rs],styles:[".pricing-section[_ngcontent-%COMP%]{padding:4.5rem 1.5rem;background:linear-gradient(140deg,#0c0a18,#1c1133 50%,#34224d);color:#fff;min-height:100vh;display:flex;flex-direction:column;justify-content:center;gap:2.5rem}.section-heading[_ngcontent-%COMP%]{text-align:center;max-width:680px;margin:0 auto 2rem}.section-heading[_ngcontent-%COMP%]   .eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.45rem;color:#dcbf68;display:block;margin-bottom:1.1rem}.section-heading[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:clamp(2.2rem,3.1vw,3.4rem);margin-bottom:1.2rem}.section-heading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ffffffbf;line-height:1.6;font-size:.98rem}.tables[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.table-heading[_ngcontent-%COMP%]{background:#dcbf682e;padding:.9rem 1.1rem;border-bottom:1px solid rgba(220,191,104,.25)}.table-heading[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#f7e7b4;letter-spacing:.05rem;font-size:1.05rem}.table-wrapper[_ngcontent-%COMP%]{background:#0c0a1859;border-radius:1.2rem;box-shadow:0 18px 40px #00000040;border:1px solid rgba(220,191,104,.25);-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);overflow:hidden}.pricing-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;color:#ffffffd9;font-size:.92rem}.pricing-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#dcbf68a6;color:#0c0a18}.pricing-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pricing-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.85rem 1.1rem;text-align:left;vertical-align:top}.pricing-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.85rem;letter-spacing:.07rem;text-transform:uppercase}.pricing-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid rgba(255,255,255,.08)}.pricing-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.pricing-table[_ngcontent-%COMP%]   .service[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:600;letter-spacing:.01rem;color:#fff}.pricing-table[_ngcontent-%COMP%]   .service[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{display:block;color:#ffffffa6;font-size:.85rem;margin-top:.25rem}.pricing-table[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-weight:600;color:#dcbf68;white-space:nowrap}.pricing-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#dcbf681f}@media (max-width: 768px){.table-wrapper[_ngcontent-%COMP%]{border-radius:1rem}.pricing-table[_ngcontent-%COMP%]{font-size:.9rem}.pricing-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .pricing-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.8rem}}"]})};var Bd=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(le(qr),le(Br))};static \u0275dir=je({type:n})}return n})(),Va=(()=>{class n extends Bd{static \u0275fac=(()=>{let t;return function(i){return(t||(t=es(n)))(i||n)}})();static \u0275dir=je({type:n,features:[gt]})}return n})(),ws=new Ye("");var X_={provide:ws,useExisting:Fn(()=>Is),multi:!0};function Z_(){let n=Da()?Da().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var ey=new Ye(""),Is=(()=>{class n extends Bd{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!Z_())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(le(qr),le(Br),le(ey,8))};static \u0275dir=je({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&Fe("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[Bn([X_]),gt]})}return n})();function Ma(n){return n==null||Fa(n)===0}function Fa(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var jd=new Ye(""),qd=new Ye(""),ty=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Xe=class{static min(e){return ny(e)}static max(e){return ry(e)}static required(e){return iy(e)}static requiredTrue(e){return sy(e)}static email(e){return oy(e)}static minLength(e){return ay(e)}static maxLength(e){return cy(e)}static pattern(e){return uy(e)}static nullValidator(e){return $d()}static compose(e){return Qd(e)}static composeAsync(e){return Jd(e)}};function ny(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function ry(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function iy(n){return Ma(n.value)?{required:!0}:null}function sy(n){return n.value===!0?null:{required:!0}}function oy(n){return Ma(n.value)||ty.test(n.value)?null:{email:!0}}function ay(n){return e=>{let t=e.value?.length??Fa(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function cy(n){return e=>{let t=e.value?.length??Fa(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function uy(n){if(!n)return $d;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Ma(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function $d(n){return null}function zd(n){return n!=null}function Gd(n){return gd(n)?Ea(n):n}function Wd(n){let e={};return n.forEach(t=>{e=t!=null?ve(ve({},e),t):e}),Object.keys(e).length===0?null:e}function Hd(n,e){return e.map(t=>t(n))}function ly(n){return!n.validate}function Kd(n){return n.map(e=>ly(e)?e:t=>e.validate(t))}function Qd(n){if(!n)return null;let e=n.filter(zd);return e.length==0?null:function(t){return Wd(Hd(t,e))}}function Yd(n){return n!=null?Qd(Kd(n)):null}function Jd(n){if(!n)return null;let e=n.filter(zd);return e.length==0?null:function(t){let r=Hd(t,e).map(Gd);return ud(r).pipe(Lr(Wd))}}function Xd(n){return n!=null?Jd(Kd(n)):null}function kd(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Zd(n){return n._rawValidators}function ef(n){return n._rawAsyncValidators}function ka(n){return n?Array.isArray(n)?n:[n]:[]}function fs(n,e){return Array.isArray(n)?n.includes(e):n===e}function Od(n,e){let t=ka(e);return ka(n).forEach(i=>{fs(t,i)||t.push(i)}),t}function Nd(n,e){return ka(e).filter(t=>!fs(n,t))}var ps=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Yd(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Xd(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},$n=class extends ps{name;get formDirective(){return null}get path(){return null}},Yr=class extends ps{_parent=null;name=null;valueAccessor=null},ms=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},hy={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},pT=Re(ve({},hy),{"[class.ng-submitted]":"isSubmitted"}),tf=(()=>{class n extends ms{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(le(Yr,2))};static \u0275dir=je({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&_t("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[gt]})}return n})(),nf=(()=>{class n extends ms{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(le($n,10))};static \u0275dir=je({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&_t("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[gt]})}return n})();var Wr="VALID",hs="INVALID",jn="PENDING",Hr="DISABLED",Lt=class{},gs=class extends Lt{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Kr=class extends Lt{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Qr=class extends Lt{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},qn=class extends Lt{status;source;constructor(e,t){super(),this.status=e,this.source=t}},Oa=class extends Lt{source;constructor(e){super(),this.source=e}},Jr=class extends Lt{source;constructor(e){super(),this.source=e}};function La(n){return(Es(n)?n.validators:n)||null}function dy(n){return Array.isArray(n)?Yd(n):n||null}function Ua(n,e){return(Es(e)?e.asyncValidators:n)||null}function fy(n){return Array.isArray(n)?Xd(n):n||null}function Es(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function rf(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Ur(1e3,"");if(!r[t])throw new Ur(1001,"")}function sf(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Ur(1002,"")})}var zn=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Ft(this.statusReactive)}set status(e){Ft(()=>this.statusReactive.set(e))}_status=zr(()=>this.statusReactive());statusReactive=Un(void 0);get valid(){return this.status===Wr}get invalid(){return this.status===hs}get pending(){return this.status==jn}get disabled(){return this.status===Hr}get enabled(){return this.status!==Hr}errors;get pristine(){return Ft(this.pristineReactive)}set pristine(e){Ft(()=>this.pristineReactive.set(e))}_pristine=zr(()=>this.pristineReactive());pristineReactive=Un(!0);get dirty(){return!this.pristine}get touched(){return Ft(this.touchedReactive)}set touched(e){Ft(()=>this.touchedReactive.set(e))}_touched=zr(()=>this.touchedReactive());touchedReactive=Un(!1);get untouched(){return!this.touched}_events=new od;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Od(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Od(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Nd(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Nd(e,this._rawAsyncValidators))}hasValidator(e){return fs(this._rawValidators,e)}hasAsyncValidator(e){return fs(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Re(ve({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Qr(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Qr(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Re(ve({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Kr(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Kr(!0,r))}markAsPending(e={}){this.status=jn;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new qn(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Re(ve({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Hr,this.errors=null,this._forEachChild(i=>{i.disable(Re(ve({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new gs(this.value,r)),this._events.next(new qn(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Re(ve({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Wr,this._forEachChild(r=>{r.enable(Re(ve({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Re(ve({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Wr||this.status===jn)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new gs(this.value,t)),this._events.next(new qn(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Re(ve({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Hr:Wr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=jn,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=Gd(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new qn(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new jr,this.statusChanges=new jr}_calculateStatus(){return this._allControlsDisabled()?Hr:this.errors?hs:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(jn)?jn:this._anyControlsHaveStatus(hs)?hs:Wr}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Kr(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Qr(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Es(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=dy(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=fy(this._rawAsyncValidators)}},_s=class extends zn{constructor(e,t,r){super(La(t),Ua(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){sf(this,!0,e),Object.keys(e).forEach(r=>{rf(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Jr(this))}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Na=class extends _s{};var of=new Ye("",{providedIn:"root",factory:()=>Ba}),Ba="always";function py(n,e){return[...e.path,n]}function xd(n,e,t=Ba){ja(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),gy(n,e),yy(n,e),_y(n,e),my(n,e)}function Vd(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),vs(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function ys(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function my(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function ja(n,e){let t=Zd(n);e.validator!==null?n.setValidators(kd(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=ef(n);e.asyncValidator!==null?n.setAsyncValidators(kd(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();ys(e._rawValidators,i),ys(e._rawAsyncValidators,i)}function vs(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=Zd(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.validator);o.length!==i.length&&(t=!0,n.setValidators(o))}}if(e.asyncValidator!==null){let i=ef(n);if(Array.isArray(i)&&i.length>0){let o=i.filter(a=>a!==e.asyncValidator);o.length!==i.length&&(t=!0,n.setAsyncValidators(o))}}}let r=()=>{};return ys(e._rawValidators,r),ys(e._rawAsyncValidators,r),t}function gy(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&af(n,e)})}function _y(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&af(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function af(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function yy(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function vy(n,e){n==null,ja(n,e)}function wy(n,e){return vs(n,e)}function Iy(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function Ey(n){return Object.getPrototypeOf(n.constructor)===Va}function by(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function Ty(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===Is?t=o:Ey(o)?r=o:i=o}),i||r||t||null}function Ay(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Md(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Fd(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var ds=class extends zn{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(La(t),Ua(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Es(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Fd(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new Jr(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Md(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Md(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Fd(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Cy=n=>n instanceof ds;var cf=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=je({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var uf=new Ye("");var Sy={provide:$n,useExisting:Fn(()=>qa)},qa=(()=>{class n extends $n{callSetDisabledState;get submitted(){return Ft(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=zr(()=>this._submittedReactive());_submittedReactive=Un(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new jr;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(vs(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return xd(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Vd(t.control||null,t,!1),Ay(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),by(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Oa(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0,r={}){this.form.reset(t,r),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Vd(r||null,t),Cy(i)&&(xd(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);vy(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&wy(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ja(this.form,this),this._oldForm&&vs(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(le(jd,10),le(qd,10),le(of,8))};static \u0275dir=je({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&Fe("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Bn([Sy]),gt,Ca]})}return n})();var Py={provide:Yr,useExisting:Fn(()=>$a)},$a=(()=>{class n extends Yr{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new jr;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,o,a){super(),this._ngModelWarningConfig=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=Ty(this,o)}ngOnChanges(t){this._added||this._setUpControl(),Iy(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return py(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(le($n,13),le(jd,10),le(qd,10),le(ws,10),le(uf,8))};static \u0275dir=je({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Bn([Py]),gt,Ca]})}return n})();var Ry={provide:ws,useExisting:Fn(()=>bs),multi:!0};function lf(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function Dy(n){return n.split(":")[0]}var bs=(()=>{class n extends Va{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=we(_d).injector;destroyRef=we(Aa);cdr=we(bd);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,md({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let r=this._getOptionId(t),i=lf(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=Dy(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=es(n)))(i||n)}})();static \u0275dir=je({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&Fe("change",function(a){return i.onChange(a.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bn([Ry]),gt]})}return n})(),hf=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(lf(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||n)(le(Br),le(qr),le(bs,9))};static \u0275dir=je({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),ky={provide:ws,useExisting:Fn(()=>df),multi:!0};function Ld(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function Oy(n){return n.split(":")[0]}var df=(()=>{class n extends Va{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,a)=>{o._setSelected(i.indexOf(a.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let h=a[u],d=this._getOptionValue(h.value);i.push(d)}}else{let a=r.options;for(let u=0;u<a.length;u++){let h=a[u];if(h.selected){let d=this._getOptionValue(h.value);i.push(d)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=Oy(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=es(n)))(i||n)}})();static \u0275dir=je({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&Fe("change",function(a){return i.onChange(a.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Bn([ky]),gt]})}return n})(),ff=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Ld(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Ld(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(le(Br),le(qr),le(df,9))};static \u0275dir=je({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var Ny=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Sa({type:n});static \u0275inj=Ta({})}return n})(),xa=class extends zn{constructor(e,t,r){super(La(t),Ua(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){Array.isArray(e)?e.forEach(r=>{this.controls.push(r),this._registerControl(r)}):(this.controls.push(e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){sf(this,!1,e),e.forEach((r,i)=>{rf(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t),t?.emitEvent!==!1&&this._events.next(new Jr(this))}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Ud(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var pf=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),o={};return Ud(r)?o=r:r!==null&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new _s(i,o)}record(t,r=null){let i=this._reduceControls(t);return new Na(i,r)}control(t,r,i){let o={};return this.useNonNullable?(Ud(r)?o=r:(o.validators=r,o.asyncValidators=i),new ds(t,Re(ve({},o),{nonNullable:!0}))):new ds(t,r,i)}array(t,r,i){let o=t.map(a=>this._createControl(a));return new xa(o,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof ds)return t;if(t instanceof zn)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(r,i,o)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ln({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var mf=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:uf,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:of,useValue:t.callSetDisabledState??Ba}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Sa({type:n});static \u0275inj=Ta({imports:[Ny]})}return n})();var gf=()=>{};var vf=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Vy=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Ts={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,y=(o&3)<<4|u>>4,w=(u&15)<<2|d>>6,S=d&63;h||(S=64,a||(w=64)),r.push(t[p],t[y],t[w],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(vf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Vy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let y=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||y==null)throw new Ga;let w=o<<2|u>>4;if(r.push(w),d!==64){let S=u<<4&240|d>>2;if(r.push(S),y!==64){let O=d<<6&192|y;r.push(O)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Ga=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},My=function(n){let e=vf(n);return Ts.encodeByteArray(e,!0)},Zr=function(n){return My(n).replace(/\./g,"")},As=function(n){try{return Ts.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Ha(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Fy=()=>Ha().__FIREBASE_DEFAULTS__,Ly=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Uy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&As(n[1]);return e&&JSON.parse(e)},Cs=()=>{try{return gf()||Fy()||Ly()||Uy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},wf=n=>{var e,t;return(t=(e=Cs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},If=n=>{let e=wf(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ka=()=>{var n;return(n=Cs())===null||n===void 0?void 0:n.config},Ef=n=>{var e;return(e=Cs())===null||e===void 0?void 0:e[`_${n}`]};var sn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function on(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function Qa(n){return A(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function bf(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Zr(JSON.stringify(t)),Zr(JSON.stringify(a)),""].join(".")}var Xr={};function By(){let n={prod:[],emulator:[]};for(let e of Object.keys(Xr))Xr[e]?n.emulator.push(e):n.prod.push(e);return n}function jy(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var _f=!1;function Ya(n,e){if(typeof window>"u"||typeof document>"u"||!on(window.location.host)||Xr[n]===e||Xr[n]||_f)return;Xr[n]=e;function t(w){return`__firebase__banner__${w}`}let r="__firebase__banner",o=By().prod.length>0;function a(){let w=document.getElementById(r);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function h(w,S){w.setAttribute("width","24"),w.setAttribute("id",S),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function d(){let w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{_f=!0,a()},w}function p(w,S){w.setAttribute("id",S),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function y(){let w=jy(r),S=t("text"),O=document.getElementById(S)||document.createElement("span"),L=t("learnmore"),N=document.getElementById(L)||document.createElement("a"),G=t("preprendIcon"),q=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){let W=w.element;u(W),p(N,L);let ne=d();h(q,G),W.append(q,O,N,ne),document.body.appendChild(W)}o?(O.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,O.innerText="Preview backend running in this workspace."),O.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}function $e(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Tf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function qy(){var n;let e=(n=Cs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Af(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Cf(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Sf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pf(){return!qy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ei(){try{return typeof indexedDB=="object"}catch{return!1}}function Rf(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var $y="FirebaseError",He=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=$y,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze.prototype.create)}},Ze=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?zy(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new He(i,u,r)}};function zy(n,e){return n.replace(Gy,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Gy=/\{\$([^}]+)}/g;function an(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(yf(o)&&yf(a)){if(!an(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function yf(n){return n!==null&&typeof n=="object"}function Ja(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Df(n,e){let t=new Wa(n,e);return t.subscribe.bind(t)}var Wa=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Wy(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=za),i.error===void 0&&(i.error=za),i.complete===void 0&&(i.complete=za);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Wy(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function za(){}var vT=14400*1e3;function Ue(n){return n&&n._delegate?n._delegate:n}var Me=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var cn="[DEFAULT]";var Xa=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new sn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Ky(e))try{this.getOrInitializeService({instanceIdentifier:cn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=cn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return A(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=cn){return this.instances.has(e)}getOptions(e=cn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Hy(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=cn){return this.component?this.component.multipleInstances?e:cn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Hy(n){return n===cn?void 0:n}function Ky(n){return n.instantiationMode==="EAGER"}var Ss=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Xa(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Qy=[],K=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(K||{}),Yy={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Jy=K.INFO,Xy={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},Zy=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Xy[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ot=class{constructor(e){this.name=e,this._logLevel=Jy,this._logHandler=Zy,this._userLogHandler=null,Qy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in K))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yy[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...e),this._logHandler(this,K.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...e),this._logHandler(this,K.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,K.INFO,...e),this._logHandler(this,K.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,K.WARN,...e),this._logHandler(this,K.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...e),this._logHandler(this,K.ERROR,...e)}};var ev=(n,e)=>e.some(t=>n instanceof t),kf,Of;function tv(){return kf||(kf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nv(){return Of||(Of=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Nf=new WeakMap,ec=new WeakMap,xf=new WeakMap,Za=new WeakMap,nc=new WeakMap;function rv(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(at(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Nf.set(t,n)}).catch(()=>{}),nc.set(e,n),e}function iv(n){if(ec.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});ec.set(n,e)}var tc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ec.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xf.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return at(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Vf(n){tc=n(tc)}function sv(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ps(this),e,...t);return xf.set(r,e.sort?e.sort():[e]),at(r)}:nv().includes(n)?function(...e){return n.apply(Ps(this),e),at(Nf.get(this))}:function(...e){return at(n.apply(Ps(this),e))}}function ov(n){return typeof n=="function"?sv(n):(n instanceof IDBTransaction&&iv(n),ev(n,tv())?new Proxy(n,tc):n)}function at(n){if(n instanceof IDBRequest)return rv(n);if(Za.has(n))return Za.get(n);let e=ov(n);return e!==n&&(Za.set(n,e),nc.set(e,n)),e}var Ps=n=>nc.get(n);function Ff(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=at(a);return r&&a.addEventListener("upgradeneeded",h=>{r(at(a.result),h.oldVersion,h.newVersion,at(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var av=["get","getKey","getAll","getAllKeys","count"],cv=["put","add","delete","clear"],rc=new Map;function Mf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(rc.get(e))return rc.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=cv.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||av.includes(t)))return;let o=function(a,...u){return A(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&h.done]))[0]})};return rc.set(e,o),o}Vf(n=>Re(ve({},n),{get:(e,t,r)=>Mf(e,t)||n.get(e,t,r),has:(e,t)=>!!Mf(e,t)||n.has(e,t)}));var sc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(uv(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function uv(n){let e=n.getComponent();return e?.type==="VERSION"}var oc="@firebase/app",Lf="0.13.2";var vt=new ot("@firebase/app"),lv="@firebase/app-compat",hv="@firebase/analytics-compat",dv="@firebase/analytics",fv="@firebase/app-check-compat",pv="@firebase/app-check",mv="@firebase/auth",gv="@firebase/auth-compat",_v="@firebase/database",yv="@firebase/data-connect",vv="@firebase/database-compat",wv="@firebase/functions",Iv="@firebase/functions-compat",Ev="@firebase/installations",bv="@firebase/installations-compat",Tv="@firebase/messaging",Av="@firebase/messaging-compat",Cv="@firebase/performance",Sv="@firebase/performance-compat",Pv="@firebase/remote-config",Rv="@firebase/remote-config-compat",Dv="@firebase/storage",kv="@firebase/storage-compat",Ov="@firebase/firestore",Nv="@firebase/ai",xv="@firebase/firestore-compat",Vv="firebase",Mv="11.10.0";var ac="[DEFAULT]",Fv={[oc]:"fire-core",[lv]:"fire-core-compat",[dv]:"fire-analytics",[hv]:"fire-analytics-compat",[pv]:"fire-app-check",[fv]:"fire-app-check-compat",[mv]:"fire-auth",[gv]:"fire-auth-compat",[_v]:"fire-rtdb",[yv]:"fire-data-connect",[vv]:"fire-rtdb-compat",[wv]:"fire-fn",[Iv]:"fire-fn-compat",[Ev]:"fire-iid",[bv]:"fire-iid-compat",[Tv]:"fire-fcm",[Av]:"fire-fcm-compat",[Cv]:"fire-perf",[Sv]:"fire-perf-compat",[Pv]:"fire-rc",[Rv]:"fire-rc-compat",[Dv]:"fire-gcs",[kv]:"fire-gcs-compat",[Ov]:"fire-fst",[xv]:"fire-fst-compat",[Nv]:"fire-vertex","fire-js":"fire-js",[Vv]:"fire-js-all"};var ti=new Map,Lv=new Map,cc=new Map;function Uf(n,e){try{n.container.addComponent(e)}catch(t){vt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function et(n){let e=n.name;if(cc.has(e))return vt.debug(`There were multiple attempts to register component ${e}.`),!1;cc.set(e,n);for(let t of ti.values())Uf(t,n);for(let t of Lv.values())Uf(t,n);return!0}function Rs(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function wt(n){return n==null?!1:n.settings!==void 0}var Uv={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ut=new Ze("app","Firebase",Uv);var uc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Me("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ut.create("app-deleted",{appName:this._name})}};var Gn=Mv;function dc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ac,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Ut.create("bad-app-name",{appName:String(i)});if(t||(t=Ka()),!t)throw Ut.create("no-options");let o=ti.get(i);if(o){if(an(t,o.options)&&an(r,o.config))return o;throw Ut.create("duplicate-app",{appName:i})}let a=new Ss(i);for(let h of cc.values())a.addComponent(h);let u=new uc(t,r,a);return ti.set(i,u),u}function Wn(n=ac){let e=ti.get(n);if(!e&&n===ac&&Ka())return dc();if(!e)throw Ut.create("no-app",{appName:n});return e}function Ds(){return Array.from(ti.values())}function de(n,e,t){var r;let i=(r=Fv[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vt.warn(u.join(" "));return}et(new Me(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Bv="firebase-heartbeat-database",jv=1,ni="firebase-heartbeat-store",ic=null;function $f(){return ic||(ic=Ff(Bv,jv,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ni)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ut.create("idb-open",{originalErrorMessage:n.message})})),ic}function qv(n){return A(this,null,function*(){try{let t=(yield $f()).transaction(ni),r=yield t.objectStore(ni).get(zf(n));return yield t.done,r}catch(e){if(e instanceof He)vt.warn(e.message);else{let t=Ut.create("idb-get",{originalErrorMessage:e?.message});vt.warn(t.message)}}})}function Bf(n,e){return A(this,null,function*(){try{let r=(yield $f()).transaction(ni,"readwrite");yield r.objectStore(ni).put(e,zf(n)),yield r.done}catch(t){if(t instanceof He)vt.warn(t.message);else{let r=Ut.create("idb-set",{originalErrorMessage:t?.message});vt.warn(r.message)}}})}function zf(n){return`${n.name}!${n.options.appId}`}var $v=1024,zv=30,lc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new hc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return A(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=jf();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>zv){let a=Wv(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){vt.warn(r)}})}getHeartbeatsHeader(){return A(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=jf(),{heartbeatsToSend:r,unsentEntries:i}=Gv(this._heartbeatsCache.heartbeats),o=Zr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return vt.warn(t),""}})}};function jf(){return new Date().toISOString().substring(0,10)}function Gv(n,e=$v){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),qf(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),qf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var hc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(this,null,function*(){return ei()?Rf().then(()=>!0).catch(()=>!1):!1})}read(){return A(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield qv(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return A(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bf(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function qf(n){return Zr(JSON.stringify({version:2,heartbeats:n})).length}function Wv(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Hv(n){et(new Me("platform-logger",e=>new sc(e),"PRIVATE")),et(new Me("heartbeat",e=>new lc(e),"PRIVATE")),de(oc,Lf,n),de(oc,Lf,"esm2017"),de("fire-js","")}Hv("");var Kv="firebase",Qv="11.10.0";de(Kv,Qv,"app");function Gf(n){n===void 0&&(n=we(nn));let e=n.get(Zi);return t=>new tn(r=>{let i=e.add(),o=!1;function a(){o||(i(),o=!0)}let u=t.subscribe({next:h=>{r.next(h),a()},complete:()=>{r.complete(),a()},error:h=>{r.error(h),a()}});return u.add(()=>{r.unsubscribe(),a()}),u})}var ln=new ba("ANGULARFIRE2_VERSION");function Os(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Kn=(n,e)=>{let t=e?[e]:Ds(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Hn=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Hn||{}),Wf=Ra()&&typeof Zone<"u"?Hn.WARN:Hn.SILENT;var ks=class{zone;delegate;constructor(e,t=cd){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(o,t,r)}},hn=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=we(Vt);this.outsideAngular=t.runOutsideAngular(()=>new ks(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ks(typeof Zone>"u"?void 0:Zone.current,ad))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ln({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Hf=!1;function Yv(n,e){!Hf&&(Wf>Hn.SILENT||Ra())&&(Hf=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Wf>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Jv(n){let e=we(Vt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function un(n){let e=we(Vt,{optional:!0});return e?e.run(()=>n()):n()}var Xv=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Yi(t,()=>un(()=>n.apply(void 0,r)))),tt=(n,e,t)=>(t||=e?Hn.WARN:Hn.VERBOSE,function(){let r,i=arguments,o,a,u;try{o=we(hn),a=we(Zi),u=we(hd)}catch{return Yv(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=un(()=>a.add())),i[d]=Xv(i[d],r,u));let h=Jv(()=>n.apply(this,i));return e?h instanceof tn?h.pipe(Ia(o.outsideAngular),wa(o.insideAngular),Gf(u)):h instanceof Promise?un(()=>{let d=a.add();return new Promise((p,y)=>{h.then(w=>Yi(u,()=>un(()=>p(w))),w=>Yi(u,()=>un(()=>y(w)))).finally(d)})}):typeof h=="function"&&r?function(){return setTimeout(r,0),h.apply(this,arguments)}:un(()=>h):h instanceof tn?h.pipe(Ia(o.outsideAngular),wa(o.insideAngular)):un(()=>h)});var dn=class{constructor(e){return e}},ri=class{constructor(){return Ds()}};function Zv(n){return n&&n.length===1?n[0]:new dn(Wn())}var fc=new Ye("angularfire2._apps"),e0={provide:dn,useFactory:Zv,deps:[[new xt,fc]]},t0={provide:ri,deps:[[new xt,fc]]};function n0(n){return(e,t)=>{let r=t.get(dd);de("angularfire",ln.full,"core"),de("angularfire",ln.full,"app"),de("angular",ld.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new dn(i)}}function Kf(n,...e){return Qi([e0,t0,{provide:fc,useFactory:n0(n),multi:!0,deps:[Vt,nn,hn,...e]}])}var Qf=tt(dc,!0);var r0=new Map,i0={activated:!1,tokenObservers:[]},s0={initialized:!1,enabled:!1};function nt(n){return r0.get(n)||Object.assign({},i0)}function Zf(){return s0}var o0="https://content-firebaseappcheck.googleapis.com/v1";var a0="exchangeDebugToken",Yf={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},EA=1440*60*1e3;var gc=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return A(this,null,function*(){this.stop();try{this.pending=new sn,this.pending.promise.catch(t=>{}),yield c0(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new sn,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function c0(n){return new Promise(e=>{setTimeout(e,n)})}var u0={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Bt=new Ze("appCheck","AppCheck",u0);function ep(n){if(!nt(n).activated)throw Bt.create("use-before-activation",{appName:n.name})}function tp(r,i){return A(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let S=yield a.getHeartbeatsHeader();S&&(o["X-Firebase-Client"]=S)}let u={method:"POST",body:JSON.stringify(e),headers:o},h;try{h=yield fetch(n,u)}catch(S){throw Bt.create("fetch-network-error",{originalErrorMessage:S?.message})}if(h.status!==200)throw Bt.create("fetch-status-error",{httpStatus:h.status});let d;try{d=yield h.json()}catch(S){throw Bt.create("fetch-parse-error",{originalErrorMessage:S?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Bt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let y=Number(p[1])*1e3,w=Date.now();return{token:d.token,expireTimeMillis:w+y,issuedAtTimeMillis:w}})}function np(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${o0}/projects/${t}/apps/${r}:${a0}?key=${i}`,body:{debug_token:e}}}var l0="firebase-app-check-database",h0=1,_c="firebase-app-check-store";var Ns=null;function d0(){return Ns||(Ns=new Promise((n,e)=>{try{let t=indexedDB.open(l0,h0);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Bt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(_c,{keyPath:"compositeKey"})}}}catch(t){e(Bt.create("storage-open",{originalErrorMessage:t?.message}))}}),Ns)}function f0(n,e){return p0(m0(n),e)}function p0(n,e){return A(this,null,function*(){let r=(yield d0()).transaction(_c,"readwrite"),o=r.objectStore(_c).put({compositeKey:n,value:e});return new Promise((a,u)=>{o.onsuccess=h=>{a()},r.onerror=h=>{var d;u(Bt.create("storage-set",{originalErrorMessage:(d=h.target.error)===null||d===void 0?void 0:d.message}))}})})}function m0(n){return`${n.options.appId}-${n.name}`}var ii=new ot("@firebase/app-check");function pc(n,e){return ei()?f0(n,e).catch(t=>{ii.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function rp(){return Zf().enabled}function ip(){return A(this,null,function*(){let n=Zf();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var g0={error:"UNKNOWN_ERROR"};function _0(n){return Ts.encodeString(JSON.stringify(n),!1)}function yc(n,e=!1,t=!1){return A(this,null,function*(){let r=n.app;ep(r);let i=nt(r),o=i.token,a;if(o&&!si(o)&&(i.token=void 0,o=void 0),!o){let d=yield i.cachedTokenPromise;d&&(si(d)?o=d:yield pc(r,void 0))}if(!e&&o&&si(o))return{token:o.token};let u=!1;if(rp())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=tp(np(r,yield ip()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=yield i.exchangeTokenPromise;return yield pc(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ii.warn(d.message):t&&ii.error(d),mc(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),o=yield nt(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?ii.warn(d.message):t&&ii.error(d),a=d}let h;return o?a?si(o)?h={token:o.token,internalError:a}:h=mc(a):(h={token:o.token},i.token=o,yield pc(r,o)):h=mc(a),u&&I0(r,h),h})}function y0(n){return A(this,null,function*(){let e=n.app;ep(e);let{provider:t}=nt(e);if(rp()){let r=yield ip(),{token:i}=yield tp(np(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function v0(n,e,t,r){let{app:i}=n,o=nt(i),a={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,a],o.token&&si(o.token)){let u=o.token;Promise.resolve().then(()=>{t({token:u.token}),Jf(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Jf(n))}function sp(n,e){let t=nt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Jf(n){let{app:e}=n,t=nt(e),r=t.tokenRefresher;r||(r=w0(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function w0(n){let{app:e}=n;return new gc(()=>A(null,null,function*(){let t=nt(e),r;if(t.token?r=yield yc(n,!0):r=yield yc(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=nt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Yf.RETRIAL_MIN_WAIT,Yf.RETRIAL_MAX_WAIT)}function I0(n,e){let t=nt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function si(n){return n.expireTimeMillis-Date.now()>0}function mc(n){return{token:_0(g0),error:n}}var vc=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=nt(this.app);for(let t of e)sp(this.app,t.next);return Promise.resolve()}};function E0(n,e){return new vc(n,e)}function b0(n){return{getToken:e=>yc(n,e),getLimitedUseToken:()=>y0(n),addTokenListener:e=>v0(n,"INTERNAL",e),removeTokenListener:e=>sp(n.app,e)}}var T0="@firebase/app-check",A0="0.10.1";var C0="app-check",Xf="app-check-internal";function S0(){et(new Me(C0,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return E0(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Xf).initialize()})),et(new Me(Xf,n=>{let e=n.getProvider("app-check").getImmediate();return b0(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),de(T0,A0)}S0();var P0="app-check";var xs=class{constructor(){return Kn(P0)}};var R0=["localhost","0.0.0.0","127.0.0.1"],VA=typeof window<"u"&&R0.includes(window.location.hostname);function fp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var pp=fp,mp=new Ze("auth","Firebase",fp());var Ls=new ot("@firebase/auth");function k0(n,...e){Ls.logLevel<=K.WARN&&Ls.warn(`Auth (${Gn}): ${n}`,...e)}function Ms(n,...e){Ls.logLevel<=K.ERROR&&Ls.error(`Auth (${Gn}): ${n}`,...e)}function op(n,...e){throw kc(n,...e)}function Dc(n,...e){return kc(n,...e)}function gp(n,e,t){let r=Object.assign(Object.assign({},pp()),{[e]:t});return new Ze("auth","Firebase",r).create(e,{appName:n.name})}function Fs(n){return gp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return mp.create(n,...e)}function Z(n,e,...t){if(!n)throw kc(e,...t)}function oi(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ms(e),new Error(e)}function Us(n,e){n||oi(e)}function O0(){return ap()==="http:"||ap()==="https:"}function ap(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function N0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(O0()||Cf()||"connection"in navigator)?navigator.onLine:!0}function x0(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var mn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Us(t>e,"Short delay should be less than long delay!"),this.isMobile=Tf()||Sf()}get(){return N0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function V0(n,e){Us(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Bs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var M0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var F0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],L0=new mn(3e4,6e4);function _p(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Gs(o,a,u,h){return A(this,arguments,function*(n,e,t,r,i={}){return yp(n,i,()=>A(null,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let y=Ja(Object.assign({key:n.config.apiKey},p)).slice(1),w=yield n._getAdditionalHeaders();w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:w},d);return Af()||(S.referrerPolicy="no-referrer"),n.emulatorConfig&&on(n.emulatorConfig.host)&&(S.credentials="include"),Bs.fetch()(yield vp(n,n.config.apiHost,t,y),S)}))})}function yp(n,e,t){return A(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},M0),e);try{let i=new Ec(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw Vs(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vs(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw Vs(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw Vs(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gp(n,p,d);op(n,p)}}catch(i){if(i instanceof He)throw i;op(n,"network-request-failed",{message:String(i)})}})}function vp(n,e,t,r){return A(this,null,function*(){let i=`${e}${t}?${r}`,o=n,a=o.config.emulator?V0(n.config,i):`${n.config.apiScheme}://${i}`;return F0.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a})}var Ec=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Dc(this.auth,"network-request-failed")),L0.get())})}};function Vs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Dc(n,e,r);return i.customData._tokenResponse=t,i}function U0(n,e){return A(this,null,function*(){return Gs(n,"POST","/v1/accounts:delete",e)})}function js(n,e){return A(this,null,function*(){return Gs(n,"POST","/v1/accounts:lookup",e)})}function ai(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Oc(n,e=!1){return A(this,null,function*(){let t=Ue(n),r=yield t.getIdToken(e),i=wp(r);Z(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:ai(wc(i.auth_time)),issuedAtTime:ai(wc(i.iat)),expirationTime:ai(wc(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function wc(n){return Number(n)*1e3}function wp(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ms("JWT malformed, contained fewer than 3 sections"),null;try{let i=As(t);return i?JSON.parse(i):(Ms("Failed to decode base64 JWT payload"),null)}catch(i){return Ms("Caught error parsing JWT payload as JSON",i?.toString()),null}}function cp(n){let e=wp(n);return Z(e,"internal-error"),Z(typeof e.exp<"u","internal-error"),Z(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function bc(n,e,t=!1){return A(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof He&&B0(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function B0({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Tc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>A(this,null,function*(){yield this.iteration()}),t)}iteration(){return A(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ui=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ai(this.lastLoginAt),this.creationTime=ai(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function qs(n){return A(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield bc(n,js(t,{idToken:r}));Z(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Ip(o.providerUserInfo):[],u=j0(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,p=h?d:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new ui(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,y)})}function Nc(n){return A(this,null,function*(){let e=Ue(n);yield qs(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function j0(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Ip(n){return n.map(e=>{var{providerId:t}=e,r=va(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function q0(n,e){return A(this,null,function*(){let t=yield yp(n,{},()=>A(null,null,function*(){let r=Ja({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=yield vp(n,i,"/v1/token",`key=${o}`),u=yield n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";let h={method:"POST",headers:u,body:r};return n.emulatorConfig&&on(n.emulatorConfig.host)&&(h.credentials="include"),Bs.fetch()(a,h)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function $0(n,e){return A(this,null,function*(){return Gs(n,"POST","/v2/accounts:revokeToken",_p(n,e))})}var ci=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Z(e.idToken,"internal-error"),Z(typeof e.idToken<"u","internal-error"),Z(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Z(e.length!==0,"internal-error");let t=cp(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return A(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Z(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return A(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield q0(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(Z(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(Z(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(Z(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return oi("not implemented")}};function jt(n,e){Z(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var fn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=va(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Tc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ui(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return A(this,null,function*(){let t=yield bc(this,this.stsTokenManager.getToken(this.auth,e));return Z(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Oc(this,e)}reload(){return Nc(this)}_assign(e){this!==e&&(Z(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Z(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return A(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield qs(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return A(this,null,function*(){if(wt(this.auth.app))return Promise.reject(Fs(this.auth));let e=yield this.getIdToken();return yield bc(this,U0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,p;let y=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,O=(a=t.photoURL)!==null&&a!==void 0?a:void 0,L=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,G=(d=t.createdAt)!==null&&d!==void 0?d:void 0,q=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:W,emailVerified:ne,isAnonymous:Ne,providerData:te,stsTokenManager:I}=t;Z(W&&I,e,"internal-error");let m=ci.fromJSON(this.name,I);Z(typeof W=="string",e,"internal-error"),jt(y,e.name),jt(w,e.name),Z(typeof ne=="boolean",e,"internal-error"),Z(typeof Ne=="boolean",e,"internal-error"),jt(S,e.name),jt(O,e.name),jt(L,e.name),jt(N,e.name),jt(G,e.name),jt(q,e.name);let _=new n({uid:W,auth:e,email:w,emailVerified:ne,displayName:y,isAnonymous:Ne,photoURL:O,phoneNumber:S,tenantId:L,stsTokenManager:m,createdAt:G,lastLoginAt:q});return te&&Array.isArray(te)&&(_.providerData=te.map(v=>Object.assign({},v))),N&&(_._redirectEventId=N),_}static _fromIdTokenResponse(e,t,r=!1){return A(this,null,function*(){let i=new ci;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield qs(o),o})}static _fromGetAccountInfoResponse(e,t,r){return A(this,null,function*(){let i=t.users[0];Z(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?Ip(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new ci;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ui(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var up=new Map;function pn(n){Us(n instanceof Function,"Expected a class definition");let e=up.get(n);return e?(Us(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,up.set(n,e),e)}var z0=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(this,null,function*(){return!0})}_set(t,r){return A(this,null,function*(){this.storage[t]=r})}_get(t){return A(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return A(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ac=z0;function Ic(n,e,t){return`firebase:${n}:${e}:${t}`}var $s=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Ic(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ic("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return A(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield js(this.auth,{idToken:e}).catch(()=>{});return t?fn._fromGetAccountInfoResponse(this.auth,t,e):null}return fn._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return A(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return A(this,null,function*(){if(!t.length)return new n(pn(Ac),e,r);let i=(yield Promise.all(t.map(d=>A(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||pn(Ac),a=Ic(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let y;if(typeof p=="string"){let w=yield js(e,{idToken:p}).catch(()=>{});if(!w)break;y=yield fn._fromGetAccountInfoResponse(e,w,p)}else y=fn._fromJSON(e,p);d!==o&&(u=y),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&(yield o._set(a,u.toJSON())),yield Promise.all(t.map(d=>A(null,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function lp(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(K0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(G0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Y0(e))return"Blackberry";if(J0(e))return"Webos";if(W0(e))return"Safari";if((e.includes("chrome/")||H0(e))&&!e.includes("edge/"))return"Chrome";if(Q0(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function G0(n=$e()){return/firefox\//i.test(n)}function W0(n=$e()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function H0(n=$e()){return/crios\//i.test(n)}function K0(n=$e()){return/iemobile/i.test(n)}function Q0(n=$e()){return/android/i.test(n)}function Y0(n=$e()){return/blackberry/i.test(n)}function J0(n=$e()){return/webos/i.test(n)}function Ep(n,e=[]){let t;switch(n){case"Browser":t=lp($e());break;case"Worker":t=`${lp($e())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Gn}/${r}`}var Cc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return A(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function X0(t){return A(this,arguments,function*(n,e={}){return Gs(n,"GET","/v2/passwordPolicy",_p(n,e))})}var Z0=6,Sc=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:Z0,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Pc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zs(this),this.idTokenSubscription=new zs(this),this.beforeStateQueue=new Cc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pn(t)),this._initializationPromise=this.queue(()=>A(this,null,function*(){var r,i,o;if(!this._deleted&&(this.persistenceManager=yield $s.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return A(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return A(this,null,function*(){try{let t=yield js(this,{idToken:e}),r=yield fn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return A(this,null,function*(){var t;if(wt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Z(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return A(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return A(this,null,function*(){try{yield qs(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=x0()}_delete(){return A(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return A(this,null,function*(){if(wt(this.app))return Promise.reject(Fs(this));let t=e?Ue(e):null;return t&&Z(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return A(this,null,function*(){if(!this._deleted)return e&&Z(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>A(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return A(this,null,function*(){return wt(this.app)?Promise.reject(Fs(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return wt(this.app)?Promise.reject(Fs(this)):this.queue(()=>A(this,null,function*(){yield this.assertedPersistence.setPersistence(pn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return A(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return A(this,null,function*(){let e=yield X0(this),t=new Sc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ze("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return A(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield $0(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return A(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return A(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&pn(e)||this._popupRedirectResolver;Z(t,this,"argument-error"),this.redirectPersistenceManager=yield $s.create(this,[pn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return A(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>A(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return A(this,null,function*(){if(e===this.currentUser)return this.queue(()=>A(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Z(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return A(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Z(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ep(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return A(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return A(this,null,function*(){var e;if(wt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&k0(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function ew(n){return Ue(n)}var zs=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Df(t=>this.observer=t)}get next(){return Z(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var tw={loadJS(){return A(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nw(n){tw=n}function rw(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function iw(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(pn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var HA=rw("rcb"),KA=new mn(3e4,6e4);var QA=new mn(2e3,1e4);var YA=600*1e3;var JA=new mn(3e4,6e4);var XA=new mn(5e3,15e3);var ZA=encodeURIComponent("fac");var hp="@firebase/auth",dp="1.10.8";var Rc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return A(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Z(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function sw(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ow(n){et(new Me("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;Z(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ep(n)},d=new Pc(r,i,o,h);return iw(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),et(new Me("auth-internal",e=>{let t=ew(e.getProvider("auth").getImmediate());return(r=>new Rc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),de(hp,dp,sw(n)),de(hp,dp,"esm2017")}var aw=300,eC=Ef("authIdTokenMaxAge")||aw;function cw(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}nw({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Dc("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",cw().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ow("Browser");var oI="auth";var Ws=class{constructor(){return Kn(oI)}};var bp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Tp={};var It,xc;(function(){var n;function e(I,m){function _(){}_.prototype=m.prototype,I.D=m.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(v,E,T){for(var g=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)g[ft-2]=arguments[ft];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=I.g[0],_=I.g[1],E=I.g[2];var T=I.g[3],g=m+(T^_&(E^T))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[1]+3905402710&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[2]+606105819&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[5]+1200080426&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[6]+2821735955&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[9]+2336552879&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[10]+4294925233&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(T^_&(E^T))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=T+(E^m&(_^E))+v[13]+4254626195&4294967295,T=m+(g<<12&4294967295|g>>>20),g=E+(_^T&(m^_))+v[14]+2792965006&4294967295,E=T+(g<<17&4294967295|g>>>15),g=_+(m^E&(T^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^T&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[6]+3225465664&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[11]+643717713&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[10]+38016083&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[15]+3634488961&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[14]+3275163606&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[3]+4107603335&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^T&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=T+(_^E&(m^_))+v[2]+4243563512&4294967295,T=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(T^m))+v[7]+1735328473&4294967295,E=T+(g<<14&4294967295|g>>>18),g=_+(T^m&(E^T))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^T)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[8]+2272392833&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[11]+1839030562&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[4]+1272893353&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[7]+4139469664&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[0]+3936430074&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[3]+3572445317&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^T)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=T+(m^_^E)+v[12]+3873151461&4294967295,T=m+(g<<11&4294967295|g>>>21),g=E+(T^m^_)+v[15]+530742520&4294967295,E=T+(g<<16&4294967295|g>>>16),g=_+(E^T^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~T))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[7]+1126891415&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[14]+2878612391&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[3]+2399980690&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[10]+4293915773&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[15]+4264355552&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[6]+2734768916&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~T))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=T+(_^(m|~E))+v[11]+3174756917&4294967295,T=m+(g<<10&4294967295|g>>>22),g=E+(m^(T|~_))+v[2]+718787259&4294967295,E=T+(g<<15&4294967295|g>>>17),g=_+(T^(E|~m))+v[9]+3951481745&4294967295,I.g[0]=I.g[0]+m&4294967295,I.g[1]=I.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,I.g[2]=I.g[2]+E&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,m){m===void 0&&(m=I.length);for(var _=m-this.blockSize,v=this.B,E=this.h,T=0;T<m;){if(E==0)for(;T<=_;)i(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<m;)if(v[E++]=I.charCodeAt(T++),E==this.blockSize){i(this,v),E=0;break}}else for(;T<m;)if(v[E++]=I[T++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var m=1;m<I.length-8;++m)I[m]=0;var _=8*this.o;for(m=I.length-8;m<I.length;++m)I[m]=_&255,_/=256;for(this.u(I),I=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)I[_++]=this.g[m]>>>v&255;return I};function o(I,m){var _=u;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=m(I)}function a(I,m){this.h=m;for(var _=[],v=!0,E=I.length-1;0<=E;E--){var T=I[E]|0;v&&T==m||(_[E]=T,v=!1)}this.g=_}var u={};function h(I){return-128<=I&&128>I?o(I,function(m){return new a([m|0],0>m?-1:0)}):new a([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return y;if(0>I)return N(d(-I));for(var m=[],_=1,v=0;I>=_;v++)m[v]=I/_|0,_*=4294967296;return new a(m,0)}function p(I,m){if(I.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(I.charAt(0)=="-")return N(p(I.substring(1),m));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=y,E=0;E<I.length;E+=8){var T=Math.min(8,I.length-E),g=parseInt(I.substring(E,E+T),m);8>T?(T=d(Math.pow(m,T)),v=v.j(T).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var y=h(0),w=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(L(this))return-N(this).m();for(var I=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);I+=(0<=v?v:4294967296+v)*m,m*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(O(this))return"0";if(L(this))return"-"+N(this).toString(I);for(var m=d(Math.pow(I,6)),_=this,v="";;){var E=ne(_,m).g;_=G(_,E.j(m));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=E,O(_))return T+v;for(;6>T.length;)T="0"+T;v=T+v}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function O(I){if(I.h!=0)return!1;for(var m=0;m<I.g.length;m++)if(I.g[m]!=0)return!1;return!0}function L(I){return I.h==-1}n.l=function(I){return I=G(this,I),L(I)?-1:O(I)?0:1};function N(I){for(var m=I.g.length,_=[],v=0;v<m;v++)_[v]=~I.g[v];return new a(_,~I.h).add(w)}n.abs=function(){return L(this)?N(this):this},n.add=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0,E=0;E<=m;E++){var T=v+(this.i(E)&65535)+(I.i(E)&65535),g=(T>>>16)+(this.i(E)>>>16)+(I.i(E)>>>16);v=g>>>16,T&=65535,g&=65535,_[E]=g<<16|T}return new a(_,_[_.length-1]&-2147483648?-1:0)};function G(I,m){return I.add(N(m))}n.j=function(I){if(O(this)||O(I))return y;if(L(this))return L(I)?N(this).j(N(I)):N(N(this).j(I));if(L(I))return N(this.j(N(I)));if(0>this.l(S)&&0>I.l(S))return d(this.m()*I.m());for(var m=this.g.length+I.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<I.g.length;E++){var T=this.i(v)>>>16,g=this.i(v)&65535,ft=I.i(E)>>>16,vr=I.i(E)&65535;_[2*v+2*E]+=g*vr,q(_,2*v+2*E),_[2*v+2*E+1]+=T*vr,q(_,2*v+2*E+1),_[2*v+2*E+1]+=g*ft,q(_,2*v+2*E+1),_[2*v+2*E+2]+=T*ft,q(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function q(I,m){for(;(I[m]&65535)!=I[m];)I[m+1]+=I[m]>>>16,I[m]&=65535,m++}function W(I,m){this.g=I,this.h=m}function ne(I,m){if(O(m))throw Error("division by zero");if(O(I))return new W(y,y);if(L(I))return m=ne(N(I),m),new W(N(m.g),N(m.h));if(L(m))return m=ne(I,N(m)),new W(N(m.g),m.h);if(30<I.g.length){if(L(I)||L(m))throw Error("slowDivide_ only works with positive integers.");for(var _=w,v=m;0>=v.l(I);)_=Ne(_),v=Ne(v);var E=te(_,1),T=te(v,1);for(v=te(v,2),_=te(_,2);!O(v);){var g=T.add(v);0>=g.l(I)&&(E=E.add(_),T=g),v=te(v,1),_=te(_,1)}return m=G(I,E.j(m)),new W(E,m)}for(E=y;0<=I.l(m);){for(_=Math.max(1,Math.floor(I.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),T=d(_),g=T.j(m);L(g)||0<g.l(I);)_-=v,T=d(_),g=T.j(m);O(T)&&(T=w),E=E.add(T),I=G(I,g)}return new W(E,I)}n.A=function(I){return ne(this,I).h},n.and=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&I.i(v);return new a(_,this.h&I.h)},n.or=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|I.i(v);return new a(_,this.h|I.h)},n.xor=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^I.i(v);return new a(_,this.h^I.h)};function Ne(I){for(var m=I.g.length+1,_=[],v=0;v<m;v++)_[v]=I.i(v)<<1|I.i(v-1)>>>31;return new a(_,I.h)}function te(I,m){var _=m>>5;m%=32;for(var v=I.g.length-_,E=[],T=0;T<v;T++)E[T]=0<m?I.i(T+_)>>>m|I.i(T+_+1)<<32-m:I.i(T+_);return new a(E,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xc=Tp.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,It=Tp.Integer=a}).apply(typeof bp<"u"?bp:typeof self<"u"?self:typeof window<"u"?window:{});var Hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Et={};var Vc,aI,Qn,Mc,li,Ks,Fc,Lc,Uc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hs=="object"&&Hs];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var b=s[f];if(!(b in l))break e;l=l[b]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,b={next:function(){if(!f&&l<s.length){var C=l++;return{value:c(C,s[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function p(s,c,l){return s.call.apply(s.bind,arguments)}function y(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,f),s.apply(c,b)}}return function(){return s.apply(c,arguments)}}function w(s,c,l){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,w.apply(null,arguments)}function S(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function O(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,b,C){for(var x=Array(arguments.length-2),re=2;re<arguments.length;re++)x[re-2]=arguments[re];return c.prototype[b].apply(f,x)}}function L(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function N(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let b=s.length||0,C=f.length||0;s.length=b+C;for(let x=0;x<C;x++)s[b+x]=f[x]}else s.push(f)}}class G{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function q(s){return/^[\s\xa0]*$/.test(s)}function W(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var Ne=W().indexOf("Gecko")!=-1&&!(W().toLowerCase().indexOf("webkit")!=-1&&W().indexOf("Edge")==-1)&&!(W().indexOf("Trident")!=-1||W().indexOf("MSIE")!=-1)&&W().indexOf("Edge")==-1;function te(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function I(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function m(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,c){let l,f;for(let b=1;b<arguments.length;b++){f=arguments[b];for(l in f)s[l]=f[l];for(let C=0;C<_.length;C++)l=_[C],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function T(s){u.setTimeout(()=>{throw s},0)}function g(){var s=Ko;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class ft{constructor(){this.h=this.g=null}add(c,l){let f=vr.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var vr=new G(()=>new d_,s=>s.reset());class d_{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let wr,Ir=!1,Ko=new ft,sh=()=>{let s=u.Promise.resolve(void 0);wr=()=>{s.then(f_)}};var f_=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){T(l)}var c=vr;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Ir=!1};function Dt(){this.s=this.s,this.C=this.C}Dt.prototype.s=!1,Dt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Dt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var p_=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s})();function Er(s,c){if(Ae.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(Ne){e:{try{ne(c.nodeName);var b=!0;break e}catch{}b=!1}b||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:m_[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Er.aa.h.call(this)}}O(Er,Ae);var m_={2:"touch",3:"pen",4:"mouse"};Er.prototype.h=function(){Er.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var br="closure_listenable_"+(1e6*Math.random()|0),g_=0;function __(s,c,l,f,b){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=b,this.key=++g_,this.da=this.fa=!1}function Oi(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Ni(s){this.src=s,this.g={},this.h=0}Ni.prototype.add=function(s,c,l,f,b){var C=s.toString();s=this.g[C],s||(s=this.g[C]=[],this.h++);var x=Yo(s,c,f,b);return-1<x?(c=s[x],l||(c.fa=!1)):(c=new __(c,this.src,C,!!f,b),c.fa=l,s.push(c)),c};function Qo(s,c){var l=c.type;if(l in s.g){var f=s.g[l],b=Array.prototype.indexOf.call(f,c,void 0),C;(C=0<=b)&&Array.prototype.splice.call(f,b,1),C&&(Oi(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function Yo(s,c,l,f){for(var b=0;b<s.length;++b){var C=s[b];if(!C.da&&C.listener==c&&C.capture==!!l&&C.ha==f)return b}return-1}var Jo="closure_lm_"+(1e6*Math.random()|0),Xo={};function oh(s,c,l,f,b){if(f&&f.once)return ch(s,c,l,f,b);if(Array.isArray(c)){for(var C=0;C<c.length;C++)oh(s,c[C],l,f,b);return null}return l=na(l),s&&s[br]?s.K(c,l,d(f)?!!f.capture:!!f,b):ah(s,c,l,!1,f,b)}function ah(s,c,l,f,b,C){if(!c)throw Error("Invalid event type");var x=d(b)?!!b.capture:!!b,re=ea(s);if(re||(s[Jo]=re=new Ni(s)),l=re.add(c,l,f,x,C),l.proxy)return l;if(f=y_(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)p_||(b=x),b===void 0&&(b=!1),s.addEventListener(c.toString(),f,b);else if(s.attachEvent)s.attachEvent(lh(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function y_(){function s(l){return c.call(s.src,s.listener,l)}let c=v_;return s}function ch(s,c,l,f,b){if(Array.isArray(c)){for(var C=0;C<c.length;C++)ch(s,c[C],l,f,b);return null}return l=na(l),s&&s[br]?s.L(c,l,d(f)?!!f.capture:!!f,b):ah(s,c,l,!0,f,b)}function uh(s,c,l,f,b){if(Array.isArray(c))for(var C=0;C<c.length;C++)uh(s,c[C],l,f,b);else f=d(f)?!!f.capture:!!f,l=na(l),s&&s[br]?(s=s.i,c=String(c).toString(),c in s.g&&(C=s.g[c],l=Yo(C,l,f,b),-1<l&&(Oi(C[l]),Array.prototype.splice.call(C,l,1),C.length==0&&(delete s.g[c],s.h--)))):s&&(s=ea(s))&&(c=s.g[c.toString()],s=-1,c&&(s=Yo(c,l,f,b)),(l=-1<s?c[s]:null)&&Zo(l))}function Zo(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[br])Qo(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(lh(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=ea(c))?(Qo(l,s),l.h==0&&(l.src=null,c[Jo]=null)):Oi(s)}}}function lh(s){return s in Xo?Xo[s]:Xo[s]="on"+s}function v_(s,c){if(s.da)s=!0;else{c=new Er(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&Zo(s),s=l.call(f,c)}return s}function ea(s){return s=s[Jo],s instanceof Ni?s:null}var ta="__closure_events_fn_"+(1e9*Math.random()>>>0);function na(s){return typeof s=="function"?s:(s[ta]||(s[ta]=function(c){return s.handleEvent(c)}),s[ta])}function Ce(){Dt.call(this),this.i=new Ni(this),this.M=this,this.F=null}O(Ce,Dt),Ce.prototype[br]=!0,Ce.prototype.removeEventListener=function(s,c,l,f){uh(this,s,c,l,f)};function xe(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new Ae(c,s);else if(c instanceof Ae)c.target=c.target||s;else{var b=c;c=new Ae(f,s),v(c,b)}if(b=!0,l)for(var C=l.length-1;0<=C;C--){var x=c.g=l[C];b=xi(x,f,!0,c)&&b}if(x=c.g=s,b=xi(x,f,!0,c)&&b,b=xi(x,f,!1,c)&&b,l)for(C=0;C<l.length;C++)x=c.g=l[C],b=xi(x,f,!1,c)&&b}Ce.prototype.N=function(){if(Ce.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)Oi(l[f]);delete s.g[c],s.h--}}this.F=null},Ce.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},Ce.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function xi(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var b=!0,C=0;C<c.length;++C){var x=c[C];if(x&&!x.da&&x.capture==l){var re=x.listener,Te=x.ha||x.src;x.fa&&Qo(s.i,x),b=re.call(Te,f)!==!1&&b}}return b&&!f.defaultPrevented}function hh(s,c,l){if(typeof s=="function")l&&(s=w(s,l));else if(s&&typeof s.handleEvent=="function")s=w(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function dh(s){s.g=hh(()=>{s.g=null,s.i&&(s.i=!1,dh(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class w_ extends Dt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:dh(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tr(s){Dt.call(this),this.h=s,this.g={}}O(Tr,Dt);var fh=[];function ph(s){te(s.g,function(c,l){this.g.hasOwnProperty(l)&&Zo(c)},s),s.g={}}Tr.prototype.N=function(){Tr.aa.N.call(this),ph(this)},Tr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ra=u.JSON.stringify,I_=u.JSON.parse,E_=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function ia(){}ia.prototype.h=null;function mh(s){return s.h||(s.h=s.i())}function gh(){}var Ar={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sa(){Ae.call(this,"d")}O(sa,Ae);function oa(){Ae.call(this,"c")}O(oa,Ae);var Jt={},_h=null;function Vi(){return _h=_h||new Ce}Jt.La="serverreachability";function yh(s){Ae.call(this,Jt.La,s)}O(yh,Ae);function Cr(s){let c=Vi();xe(c,new yh(c))}Jt.STAT_EVENT="statevent";function vh(s,c){Ae.call(this,Jt.STAT_EVENT,s),this.stat=c}O(vh,Ae);function Ve(s){let c=Vi();xe(c,new vh(c,s))}Jt.Ma="timingevent";function wh(s,c){Ae.call(this,Jt.Ma,s),this.size=c}O(wh,Ae);function Sr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function Pr(){this.g=!0}Pr.prototype.xa=function(){this.g=!1};function b_(s,c,l,f,b,C){s.info(function(){if(s.g)if(C)for(var x="",re=C.split("&"),Te=0;Te<re.length;Te++){var X=re[Te].split("=");if(1<X.length){var Se=X[0];X=X[1];var Pe=Se.split("_");x=2<=Pe.length&&Pe[1]=="type"?x+(Se+"="+X+"&"):x+(Se+"=redacted&")}}else x=null;else x=C;return"XMLHTTP REQ ("+f+") [attempt "+b+"]: "+c+`
`+l+`
`+x})}function T_(s,c,l,f,b,C,x){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+b+"]: "+c+`
`+l+`
`+C+" "+x})}function Nn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+C_(s,l)+(f?" "+f:"")})}function A_(s,c){s.info(function(){return"TIMEOUT: "+c})}Pr.prototype.info=function(){};function C_(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var b=f[1];if(Array.isArray(b)&&!(1>b.length)){var C=b[0];if(C!="noop"&&C!="stop"&&C!="close")for(var x=1;x<b.length;x++)b[x]=""}}}}return ra(l)}catch{return c}}var Mi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ih={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},aa;function Fi(){}O(Fi,ia),Fi.prototype.g=function(){return new XMLHttpRequest},Fi.prototype.i=function(){return{}},aa=new Fi;function kt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Tr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Eh}function Eh(){this.i=null,this.g="",this.h=!1}var bh={},ca={};function ua(s,c,l){s.L=1,s.v=ji(pt(c)),s.m=l,s.P=!0,Th(s,null)}function Th(s,c){s.F=Date.now(),Li(s),s.A=pt(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Lh(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Eh,s.g=nd(s.j,l?c:null,!s.m),0<s.O&&(s.M=new w_(w(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var b="readystatechange";Array.isArray(b)||(b&&(fh[0]=b.toString()),b=fh);for(var C=0;C<b.length;C++){var x=oh(l,b[C],f||c.handleEvent,!1,c.h||c);if(!x)break;c.g[x.key]=x}c=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),Cr(),b_(s.i,s.u,s.A,s.l,s.R,s.m)}kt.prototype.ca=function(s){s=s.target;let c=this.M;c&&mt(s)==3?c.j():this.Y(s)},kt.prototype.Y=function(s){try{if(s==this.g)e:{let Pe=mt(this.g);var c=this.g.Ba();let Mn=this.g.Z();if(!(3>Pe)&&(Pe!=3||this.g&&(this.h.h||this.g.oa()||Gh(this.g)))){this.J||Pe!=4||c==7||(c==8||0>=Mn?Cr(3):Cr(2)),la(this);var l=this.g.Z();this.X=l;t:if(Ah(this)){var f=Gh(this.g);s="";var b=f.length,C=mt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xt(this),Rr(this);var x="";break t}this.h.i=new u.TextDecoder}for(c=0;c<b;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(C&&c==b-1)});f.length=0,this.h.g+=s,this.C=0,x=this.h.g}else x=this.g.oa();if(this.o=l==200,T_(this.i,this.u,this.A,this.l,this.R,Pe,l),this.o){if(this.T&&!this.K){t:{if(this.g){var re,Te=this.g;if((re=Te.g?Te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(re)){var X=re;break t}}X=null}if(l=X)Nn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ha(this,l);else{this.o=!1,this.s=3,Ve(12),Xt(this),Rr(this);break e}}if(this.P){l=!0;let Qe;for(;!this.J&&this.C<x.length;)if(Qe=S_(this,x),Qe==ca){Pe==4&&(this.s=4,Ve(14),l=!1),Nn(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==bh){this.s=4,Ve(15),Nn(this.i,this.l,x,"[Invalid Chunk]"),l=!1;break}else Nn(this.i,this.l,Qe,null),ha(this,Qe);if(Ah(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||x.length!=0||this.h.h||(this.s=1,Ve(16),l=!1),this.o=this.o&&l,!l)Nn(this.i,this.l,x,"[Invalid Chunked Response]"),Xt(this),Rr(this);else if(0<x.length&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.ba&&!Se.M&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),_a(Se),Se.M=!0,Ve(11))}}else Nn(this.i,this.l,x,null),ha(this,x);Pe==4&&Xt(this),this.o&&!this.J&&(Pe==4?Xh(this.j,this):(this.o=!1,Li(this)))}else z_(this.g),l==400&&0<x.indexOf("Unknown SID")?(this.s=3,Ve(12)):(this.s=0,Ve(13)),Xt(this),Rr(this)}}}catch{}finally{}};function Ah(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function S_(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?ca:(l=Number(c.substring(l,f)),isNaN(l)?bh:(f+=1,f+l>c.length?ca:(c=c.slice(f,f+l),s.C=f+l,c)))}kt.prototype.cancel=function(){this.J=!0,Xt(this)};function Li(s){s.S=Date.now()+s.I,Ch(s,s.I)}function Ch(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=Sr(w(s.ba,s),c)}function la(s){s.B&&(u.clearTimeout(s.B),s.B=null)}kt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(A_(this.i,this.A),this.L!=2&&(Cr(),Ve(17)),Xt(this),this.s=2,Rr(this)):Ch(this,this.S-s)};function Rr(s){s.j.G==0||s.J||Xh(s.j,s)}function Xt(s){la(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,ph(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function ha(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||da(l.h,s))){if(!s.K&&da(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var b=f;if(b[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)Wi(l),zi(l);else break e;ga(l),Ve(18)}}else l.za=b[1],0<l.za-l.T&&37500>b[2]&&l.F&&l.v==0&&!l.C&&(l.C=Sr(w(l.Za,l),6e3));if(1>=Rh(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else en(l,11)}else if((s.K||l.g==s)&&Wi(l),!q(c))for(b=l.Da.g.parse(c),c=0;c<b.length;c++){let X=b[c];if(l.T=X[0],X=X[1],l.G==2)if(X[0]=="c"){l.K=X[1],l.ia=X[2];let Se=X[3];Se!=null&&(l.la=Se,l.j.info("VER="+l.la));let Pe=X[4];Pe!=null&&(l.Aa=Pe,l.j.info("SVER="+l.Aa));let Mn=X[5];Mn!=null&&typeof Mn=="number"&&0<Mn&&(f=1.5*Mn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Qe=s.g;if(Qe){let Ki=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ki){var C=f.h;C.g||Ki.indexOf("spdy")==-1&&Ki.indexOf("quic")==-1&&Ki.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(fa(C,C.h),C.h=null))}if(f.D){let ya=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;ya&&(f.ya=ya,ie(f.I,f.D,ya))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var x=s;if(f.qa=td(f,f.J?f.ia:null,f.W),x.K){Dh(f.h,x);var re=x,Te=f.L;Te&&(re.I=Te),re.B&&(la(re),Li(re)),f.g=x}else Yh(f);0<l.i.length&&Gi(l)}else X[0]!="stop"&&X[0]!="close"||en(l,7);else l.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?en(l,7):ma(l):X[0]!="noop"&&l.l&&l.l.ta(X),l.v=0)}}Cr(4)}catch{}}var P_=class{constructor(s,c){this.g=s,this.map=c}};function Sh(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ph(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Rh(s){return s.h?1:s.g?s.g.size:0}function da(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function fa(s,c){s.g?s.g.add(c):s.h=c}function Dh(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Sh.prototype.cancel=function(){if(this.i=kh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function kh(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return L(s.i)}function R_(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function D_(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Oh(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=D_(s),f=R_(s),b=f.length,C=0;C<b;C++)c.call(void 0,f[C],l&&l[C],s)}var Nh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function k_(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),b=null;if(0<=f){var C=s[l].substring(0,f);b=s[l].substring(f+1)}else C=s[l];c(C,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Zt(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Zt){this.h=s.h,Ui(this,s.j),this.o=s.o,this.g=s.g,Bi(this,s.s),this.l=s.l;var c=s.i,l=new Or;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),xh(this,l),this.m=s.m}else s&&(c=String(s).match(Nh))?(this.h=!1,Ui(this,c[1]||"",!0),this.o=Dr(c[2]||""),this.g=Dr(c[3]||"",!0),Bi(this,c[4]),this.l=Dr(c[5]||"",!0),xh(this,c[6]||"",!0),this.m=Dr(c[7]||"")):(this.h=!1,this.i=new Or(null,this.h))}Zt.prototype.toString=function(){var s=[],c=this.j;c&&s.push(kr(c,Vh,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(kr(c,Vh,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(kr(l,l.charAt(0)=="/"?x_:N_,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",kr(l,M_)),s.join("")};function pt(s){return new Zt(s)}function Ui(s,c,l){s.j=l?Dr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function Bi(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function xh(s,c,l){c instanceof Or?(s.i=c,F_(s.i,s.h)):(l||(c=kr(c,V_)),s.i=new Or(c,s.h))}function ie(s,c,l){s.i.set(c,l)}function ji(s){return ie(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function Dr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function kr(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,O_),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function O_(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Vh=/[#\/\?@]/g,N_=/[#\?:]/g,x_=/[#\?]/g,V_=/[#\?@]/g,M_=/#/g;function Or(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function Ot(s){s.g||(s.g=new Map,s.h=0,s.i&&k_(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=Or.prototype,n.add=function(s,c){Ot(this),this.i=null,s=xn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function Mh(s,c){Ot(s),c=xn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Fh(s,c){return Ot(s),c=xn(s,c),s.g.has(c)}n.forEach=function(s,c){Ot(this),this.g.forEach(function(l,f){l.forEach(function(b){s.call(c,b,f,this)},this)},this)},n.na=function(){Ot(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let b=s[f];for(let C=0;C<b.length;C++)l.push(c[f])}return l},n.V=function(s){Ot(this);let c=[];if(typeof s=="string")Fh(this,s)&&(c=c.concat(this.g.get(xn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return Ot(this),this.i=null,s=xn(this,s),Fh(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Lh(s,c,l){Mh(s,c),0<l.length&&(s.i=null,s.g.set(xn(s,c),L(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let C=encodeURIComponent(String(f)),x=this.V(f);for(f=0;f<x.length;f++){var b=C;x[f]!==""&&(b+="="+encodeURIComponent(String(x[f]))),s.push(b)}}return this.i=s.join("&")};function xn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function F_(s,c){c&&!s.j&&(Ot(s),s.i=null,s.g.forEach(function(l,f){var b=f.toLowerCase();f!=b&&(Mh(this,f),Lh(this,b,l))},s)),s.j=c}function L_(s,c){let l=new Pr;if(u.Image){let f=new Image;f.onload=S(Nt,l,"TestLoadImage: loaded",!0,c,f),f.onerror=S(Nt,l,"TestLoadImage: error",!1,c,f),f.onabort=S(Nt,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=S(Nt,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function U_(s,c){let l=new Pr,f=new AbortController,b=setTimeout(()=>{f.abort(),Nt(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(C=>{clearTimeout(b),C.ok?Nt(l,"TestPingServer: ok",!0,c):Nt(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(b),Nt(l,"TestPingServer: error",!1,c)})}function Nt(s,c,l,f,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),f(l)}catch{}}function B_(){this.g=new E_}function j_(s,c,l){let f=l||"";try{Oh(s,function(b,C){let x=b;d(b)&&(x=ra(b)),c.push(f+C+"="+encodeURIComponent(x))})}catch(b){throw c.push(f+"type="+encodeURIComponent("_badmap")),b}}function Nr(s){this.l=s.Ub||null,this.j=s.eb||!1}O(Nr,ia),Nr.prototype.g=function(){return new qi(this.l,this.j)},Nr.prototype.i=(function(s){return function(){return s}})({});function qi(s,c){Ce.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}O(qi,Ce),n=qi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,Vr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,xr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,Vr(this)),this.g&&(this.readyState=3,Vr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Uh(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Uh(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?xr(this):Vr(this),this.readyState==3&&Uh(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,xr(this))},n.Qa=function(s){this.g&&(this.response=s,xr(this))},n.ga=function(){this.g&&xr(this)};function xr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,Vr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function Vr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(qi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Bh(s){let c="";return te(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function pa(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Bh(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):ie(s,c,l))}function ue(s){Ce.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}O(ue,Ce);var q_=/^https?$/i,$_=["POST","PUT"];n=ue.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():aa.g(),this.v=this.o?mh(this.o):mh(aa),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(C){jh(this,C);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var b in f)l.set(b,f[b]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())l.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(C=>C.toLowerCase()=="content-type"),b=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call($_,c,void 0))||f||b||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,x]of l)this.g.setRequestHeader(C,x);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zh(this),this.u=!0,this.g.send(s),this.u=!1}catch(C){jh(this,C)}};function jh(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,qh(s),$i(s)}function qh(s){s.A||(s.A=!0,xe(s,"complete"),xe(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,xe(this,"complete"),xe(this,"abort"),$i(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$i(this,!0)),ue.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$h(this):this.bb())},n.bb=function(){$h(this)};function $h(s){if(s.h&&typeof a<"u"&&(!s.v[1]||mt(s)!=4||s.Z()!=2)){if(s.u&&mt(s)==4)hh(s.Ea,0,s);else if(xe(s,"readystatechange"),mt(s)==4){s.h=!1;try{let x=s.Z();e:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=x===0){var b=String(s.D).match(Nh)[1]||null;!b&&u.self&&u.self.location&&(b=u.self.location.protocol.slice(0,-1)),f=!q_.test(b?b.toLowerCase():"")}l=f}if(l)xe(s,"complete"),xe(s,"success");else{s.m=6;try{var C=2<mt(s)?s.g.statusText:""}catch{C=""}s.l=C+" ["+s.Z()+"]",qh(s)}}finally{$i(s)}}}}function $i(s,c){if(s.g){zh(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||xe(s,"ready");try{l.onreadystatechange=f}catch{}}}function zh(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function mt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<mt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),I_(c)}};function Gh(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function z_(s){let c={};s=(s.g&&2<=mt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(q(s[f]))continue;var l=E(s[f]);let b=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let C=c[b]||[];c[b]=C,C.push(l)}I(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Wh(s){this.Aa=0,this.i=[],this.j=new Pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mr("baseRetryDelayMs",5e3,s),this.cb=Mr("retryDelaySeedMs",1e4,s),this.Wa=Mr("forwardChannelMaxRetries",2,s),this.wa=Mr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Sh(s&&s.concurrentRequestLimit),this.Da=new B_,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Wh.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){Ve(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=td(this,null,this.W),Gi(this)};function ma(s){if(Hh(s),s.G==3){var c=s.U++,l=pt(s.I);if(ie(l,"SID",s.K),ie(l,"RID",c),ie(l,"TYPE","terminate"),Fr(s,l),c=new kt(s,s.j,c),c.L=2,c.v=ji(pt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=nd(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Li(c)}ed(s)}function zi(s){s.g&&(_a(s),s.g.cancel(),s.g=null)}function Hh(s){zi(s),s.u&&(u.clearTimeout(s.u),s.u=null),Wi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function Gi(s){if(!Ph(s.h)&&!s.s){s.s=!0;var c=s.Ga;wr||sh(),Ir||(wr(),Ir=!0),Ko.add(c,s),s.B=0}}function G_(s,c){return Rh(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=Sr(w(s.Ga,s,c),Zh(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let b=new kt(this,this.j,s),C=this.o;if(this.S&&(C?(C=m(C),v(C,this.S)):C=this.S),this.m!==null||this.O||(b.H=C,C=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Qh(this,b,c),l=pt(this.I),ie(l,"RID",s),ie(l,"CVER",22),this.D&&ie(l,"X-HTTP-Session-Id",this.D),Fr(this,l),C&&(this.O?c="headers="+encodeURIComponent(String(Bh(C)))+"&"+c:this.m&&pa(l,this.m,C)),fa(this.h,b),this.Ua&&ie(l,"TYPE","init"),this.P?(ie(l,"$req",c),ie(l,"SID","null"),b.T=!0,ua(b,l,null)):ua(b,l,c),this.G=2}}else this.G==3&&(s?Kh(this,s):this.i.length==0||Ph(this.h)||Kh(this))};function Kh(s,c){var l;c?l=c.l:l=s.U++;let f=pt(s.I);ie(f,"SID",s.K),ie(f,"RID",l),ie(f,"AID",s.T),Fr(s,f),s.m&&s.o&&pa(f,s.m,s.o),l=new kt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Qh(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),fa(s.h,l),ua(l,f,c)}function Fr(s,c){s.H&&te(s.H,function(l,f){ie(c,f,l)}),s.l&&Oh({},function(l,f){ie(c,f,l)})}function Qh(s,c,l){l=Math.min(s.i.length,l);var f=s.l?w(s.l.Na,s.l,s):null;e:{var b=s.i;let C=-1;for(;;){let x=["count="+l];C==-1?0<l?(C=b[0].g,x.push("ofs="+C)):C=0:x.push("ofs="+C);let re=!0;for(let Te=0;Te<l;Te++){let X=b[Te].g,Se=b[Te].map;if(X-=C,0>X)C=Math.max(0,b[Te].g-100),re=!1;else try{j_(Se,x,"req"+X+"_")}catch{f&&f(Se)}}if(re){f=x.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Yh(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;wr||sh(),Ir||(wr(),Ir=!0),Ko.add(c,s),s.v=0}}function ga(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=Sr(w(s.Fa,s),Zh(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Jh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=Sr(w(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ve(10),zi(this),Jh(this))};function _a(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Jh(s){s.g=new kt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=pt(s.qa);ie(c,"RID","rpc"),ie(c,"SID",s.K),ie(c,"AID",s.T),ie(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&ie(c,"TO",s.ja),ie(c,"TYPE","xmlhttp"),Fr(s,c),s.m&&s.o&&pa(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=ji(pt(c)),l.m=null,l.P=!0,Th(l,s)}n.Za=function(){this.C!=null&&(this.C=null,zi(this),ga(this),Ve(19))};function Wi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Xh(s,c){var l=null;if(s.g==c){Wi(s),_a(s),s.g=null;var f=2}else if(da(s.h,c))l=c.D,Dh(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var b=s.B;f=Vi(),xe(f,new wh(f,l)),Gi(s)}else Yh(s);else if(b=c.s,b==3||b==0&&0<c.X||!(f==1&&G_(s,c)||f==2&&ga(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),b){case 1:en(s,5);break;case 4:en(s,10);break;case 3:en(s,6);break;default:en(s,2)}}}function Zh(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function en(s,c){if(s.j.info("Error code "+c),c==2){var l=w(s.fb,s),f=s.Xa;let b=!f;f=new Zt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ui(f,"https"),ji(f),b?L_(f.toString(),l):U_(f.toString(),l)}else Ve(2);s.G=0,s.l&&s.l.sa(c),ed(s),Hh(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Ve(2)):(this.j.info("Failed to ping google.com"),Ve(1))};function ed(s){if(s.G=0,s.ka=[],s.l){let c=kh(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ka,c),N(s.ka,s.i),s.h.i.length=0,L(s.i),s.i.length=0),s.l.ra()}}function td(s,c,l){var f=l instanceof Zt?pt(l):new Zt(l);if(f.g!="")c&&(f.g=c+"."+f.g),Bi(f,f.s);else{var b=u.location;f=b.protocol,c=c?c+"."+b.hostname:b.hostname,b=+b.port;var C=new Zt(null);f&&Ui(C,f),c&&(C.g=c),b&&Bi(C,b),l&&(C.l=l),f=C}return l=s.D,c=s.ya,l&&c&&ie(f,l,c),ie(f,"VER",s.la),Fr(s,f),f}function nd(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new ue(new Nr({eb:l})):new ue(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function rd(){}n=rd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Hi(){}Hi.prototype.g=function(s,c){return new Be(s,c)};function Be(s,c){Ce.call(this),this.g=new Wh(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!q(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!q(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new Vn(this)}O(Be,Ce),Be.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Be.prototype.close=function(){ma(this.g)},Be.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=ra(s),s=l);c.i.push(new P_(c.Ya++,s)),c.G==3&&Gi(c)},Be.prototype.N=function(){this.g.l=null,delete this.j,ma(this.g),delete this.g,Be.aa.N.call(this)};function id(s){sa.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}O(id,sa);function sd(){oa.call(this),this.status=1}O(sd,oa);function Vn(s){this.g=s}O(Vn,rd),Vn.prototype.ua=function(){xe(this.g,"a")},Vn.prototype.ta=function(s){xe(this.g,new id(s))},Vn.prototype.sa=function(s){xe(this.g,new sd)},Vn.prototype.ra=function(){xe(this.g,"b")},Hi.prototype.createWebChannel=Hi.prototype.g,Be.prototype.send=Be.prototype.o,Be.prototype.open=Be.prototype.m,Be.prototype.close=Be.prototype.close,Uc=Et.createWebChannelTransport=function(){return new Hi},Lc=Et.getStatEventTarget=function(){return Vi()},Fc=Et.Event=Jt,Ks=Et.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mi.NO_ERROR=0,Mi.TIMEOUT=8,Mi.HTTP_ERROR=6,li=Et.ErrorCode=Mi,Ih.COMPLETE="complete",Mc=Et.EventType=Ih,gh.EventType=Ar,Ar.OPEN="a",Ar.CLOSE="b",Ar.ERROR="c",Ar.MESSAGE="d",Ce.prototype.listen=Ce.prototype.K,Qn=Et.WebChannel=gh,aI=Et.FetchXmlHttpFactory=Nr,ue.prototype.listenOnce=ue.prototype.L,ue.prototype.getLastError=ue.prototype.Ka,ue.prototype.getLastErrorCode=ue.prototype.Ba,ue.prototype.getStatus=ue.prototype.Z,ue.prototype.getResponseJson=ue.prototype.Oa,ue.prototype.getResponseText=ue.prototype.oa,ue.prototype.send=ue.prototype.ea,ue.prototype.setWithCredentials=ue.prototype.Ha,Vc=Et.XhrIo=ue}).apply(typeof Hs<"u"?Hs:typeof self<"u"?self:typeof window<"u"?window:{});var Ap="@firebase/firestore",Cp="4.8.0";var Ee=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ee.UNAUTHENTICATED=new Ee(null),Ee.GOOGLE_CREDENTIALS=new Ee("google-credentials-uid"),Ee.FIRST_PARTY=new Ee("first-party-uid"),Ee.MOCK_USER=new Ee("mock-user");var mr="11.10.0";var In=new ot("@firebase/firestore");function Yn(){return In.logLevel}function F(n,...e){if(In.logLevel<=K.DEBUG){let t=e.map(kl);In.debug(`Firestore (${mr}): ${n}`,...t)}}function Tt(n,...e){if(In.logLevel<=K.ERROR){let t=e.map(kl);In.error(`Firestore (${mr}): ${n}`,...t)}}function Wt(n,...e){if(In.logLevel<=K.WARN){let t=e.map(kl);In.warn(`Firestore (${mr}): ${n}`,...t)}}function kl(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function j(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,vm(n,r,t)}function vm(n,e,t){let r=`FIRESTORE (${mr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Tt(r),new Error(r)}function ee(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||vm(e,i,r)}function $(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var bt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var to=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},zc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ee.UNAUTHENTICATED))}shutdown(){}},Gc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Wc=class{constructor(e){this.t=e,this.currentUser=Ee.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new bt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new bt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>A(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},u=h=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new bt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new to(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new Ee(e)}},Hc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ee.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Kc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Hc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ee.FIRST_PARTY))}shutdown(){}invalidateToken(){}},no=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Qc=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);let r=o=>{o.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,F("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new no(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new no(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function cI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function wm(){return new TextEncoder}var _i=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=cI(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function H(n,e){return n<e?-1:n>e?1:0}function Yc(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return H(r,i);{let o=wm(),a=uI(o.encode(Sp(n,t)),o.encode(Sp(e,t)));return a!==0?a:H(r,i)}}t+=r>65535?2:1}return H(n.length,e.length)}function Sp(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function uI(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return H(n[t],e[t]);return H(n.length,e.length)}function ir(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Pp="__name__",ro=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&j(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return H(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Yc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return It.fromString(e.substring(4,e.length-2))}},ce=class n extends ro{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},lI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends ro{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return lI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Pp}static keyField(){return new n([Pp])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};function Im(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hI(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Rp(n){if(!B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Dp(n){if(B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Em(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function xo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j(12329,{type:typeof n})}function di(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=xo(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function _e(n,e){let t={typeString:n};return e&&(t.value=e),t}function Ri(n,e){if(!Em(n))throw new M(P.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new M(P.INVALID_ARGUMENT,t);return!0}var kp=-62135596800,Op=1e6,ye=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Op);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kp)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Op}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ri(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-kp;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ye._jsonSchemaVersion="firestore/timestamp/1.0",ye._jsonSchema={type:_e("string",ye._jsonSchemaVersion),seconds:_e("number"),nanoseconds:_e("number")};var z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var yi=-1,Jc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Jc.UNKNOWN_ID=-1;function dI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=z.fromTimestamp(r===1e9?new ye(t+1,0):new ye(t,r));return new En(i,B.empty(),e)}function fI(n){return new En(n.readTime,n.key,yi)}var En=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(z.min(),B.empty(),yi)}static max(){return new n(z.max(),B.empty(),yi)}};function pI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:H(n.largestBatchId,e.largestBatchId))}var mI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Xc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function gr(n){return A(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==mI)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++u,u===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function gI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _r(n){return n.name==="IndexedDbTransactionError"}var Ol=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Nl=-1;function Vo(n){return n==null}function vi(n){return n===0&&1/n==-1/0}function _I(n){return typeof n=="number"&&Number.isInteger(n)&&!vi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var bm="";function yI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Np(e)),e=vI(n.get(t),e);return Np(e)}function vI(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case bm:t+="";break;default:t+=o}}return t}function Np(n){return n+bm+""}var wI="remoteDocuments",Tm="owner";var Am="mutationQueues";var Cm="mutations";var Sm="documentMutations",II="remoteDocumentsV14";var Pm="remoteDocumentGlobal";var Rm="targets";var Dm="targetDocuments";var km="targetGlobal",Om="collectionParents";var Nm="clientMetadata";var xm="bundles";var Vm="namedQueries";var EI="indexConfiguration";var bI="indexState";var TI="indexEntries";var Mm="documentOverlays";var AI="globals";var CI=[Am,Cm,Sm,wI,Rm,Tm,km,Dm,Nm,Pm,Om,xm,Vm],iS=[...CI,Mm],SI=[Am,Cm,Sm,II,Rm,Tm,km,Dm,Nm,Pm,Om,xm,Vm,Mm],PI=SI,RI=[...PI,EI,bI,TI];var sS=[...RI,AI];function xp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Dn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Fm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var he=class n{constructor(e,t){this.comparator=e,this.root=t||ut.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ut.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ut.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new er(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new er(this.root,e,this.comparator,!1)}getReverseIterator(){return new er(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new er(this.root,e,this.comparator,!0)}},er=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ut=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw j(27949);return e+(this.isRed()?0:1)}};ut.EMPTY=null,ut.RED=!0,ut.BLACK=!1;ut.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new ut(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var be=class n{constructor(e){this.comparator=e,this.data=new he(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new io(this.data.getIterator())}getIteratorFrom(e){return new io(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},io=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ct=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new be(ze.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ir(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var so=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Oe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new so("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Oe.EMPTY_BYTE_STRING=new Oe("");var DI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function At(n){if(ee(!!n,39018),typeof n=="string"){let e=0,t=DI.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ae(n.seconds),nanos:ae(n.nanos)}}function ae(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ct(n){return typeof n=="string"?Oe.fromBase64String(n):Oe.fromUint8Array(n)}var Lm="server_timestamp",Um="__type__",Bm="__previous_value__",jm="__local_write_time__";function xl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Um])===null||t===void 0?void 0:t.stringValue)===Lm}function Mo(n){let e=n.mapValue.fields[Bm];return xl(e)?Mo(e):e}function wi(n){let e=At(n.mapValue.fields[jm].timestampValue);return new ye(e.seconds,e.nanos)}var Zc=class{constructor(e,t,r,i,o,a,u,h,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}},oo="(default)",ao=class n{constructor(e,t){this.projectId=e,this.database=t||oo}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===oo}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Vl="__type__",qm="__max__",Qs={mapValue:{fields:{__type__:{stringValue:qm}}}},Ml="__vector__",sr="value";function Ht(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xl(n)?4:zm(n)?9007199254740991:$m(n)?10:11:j(28295,{value:n})}function dt(n,e){if(n===e)return!0;let t=Ht(n);if(t!==Ht(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wi(n).isEqual(wi(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=At(i.timestampValue),u=At(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return Ct(i.bytesValue).isEqual(Ct(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return ae(i.geoPointValue.latitude)===ae(o.geoPointValue.latitude)&&ae(i.geoPointValue.longitude)===ae(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return ae(i.integerValue)===ae(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ae(i.doubleValue),u=ae(o.doubleValue);return a===u?vi(a)===vi(u):isNaN(a)&&isNaN(u)}return!1})(n,e);case 9:return ir(n.arrayValue.values||[],e.arrayValue.values||[],dt);case 10:case 11:return(function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(xp(a)!==xp(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!dt(a[h],u[h])))return!1;return!0})(n,e);default:return j(52216,{left:n})}}function Ii(n,e){return(n.values||[]).find(t=>dt(t,e))!==void 0}function or(n,e){if(n===e)return 0;let t=Ht(n),r=Ht(e);if(t!==r)return H(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return H(n.booleanValue,e.booleanValue);case 2:return(function(o,a){let u=ae(o.integerValue||o.doubleValue),h=ae(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return Vp(n.timestampValue,e.timestampValue);case 4:return Vp(wi(n),wi(e));case 5:return Yc(n.stringValue,e.stringValue);case 6:return(function(o,a){let u=Ct(o),h=Ct(a);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let p=H(u[d],h[d]);if(p!==0)return p}return H(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,a){let u=H(ae(o.latitude),ae(a.latitude));return u!==0?u:H(ae(o.longitude),ae(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Mp(n.arrayValue,e.arrayValue);case 10:return(function(o,a){var u,h,d,p;let y=o.fields||{},w=a.fields||{},S=(u=y[sr])===null||u===void 0?void 0:u.arrayValue,O=(h=w[sr])===null||h===void 0?void 0:h.arrayValue,L=H(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=O?.values)===null||p===void 0?void 0:p.length)||0);return L!==0?L:Mp(S,O)})(n.mapValue,e.mapValue);case 11:return(function(o,a){if(o===Qs.mapValue&&a===Qs.mapValue)return 0;if(o===Qs.mapValue)return 1;if(a===Qs.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let y=0;y<h.length&&y<p.length;++y){let w=Yc(h[y],p[y]);if(w!==0)return w;let S=or(u[h[y]],d[p[y]]);if(S!==0)return S}return H(h.length,p.length)})(n.mapValue,e.mapValue);default:throw j(23264,{le:t})}}function Vp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return H(n,e);let t=At(n),r=At(e),i=H(t.seconds,r.seconds);return i!==0?i:H(t.nanos,r.nanos)}function Mp(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=or(t[i],r[i]);if(o)return o}return H(t.length,r.length)}function ar(n){return eu(n)}function eu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=At(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ct(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return B.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=eu(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${eu(t.fields[a])}`;return i+"}"})(n.mapValue):j(61005,{value:n})}function Xs(n){switch(Ht(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Mo(n);return e?16+Xs(e):16;case 5:return 2*n.stringValue.length;case 6:return Ct(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+Xs(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Dn(r.fields,(o,a)=>{i+=o.length+Xs(a)}),i})(n.mapValue);default:throw j(13486,{value:n})}}function Fp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function tu(n){return!!n&&"integerValue"in n}function Fl(n){return!!n&&"arrayValue"in n}function Lp(n){return!!n&&"nullValue"in n}function Up(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Zs(n){return!!n&&"mapValue"in n}function $m(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Vl])===null||t===void 0?void 0:t.stringValue)===Ml}function fi(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Dn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=fi(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=fi(n.arrayValue.values[t]);return e}return Object.assign({},n)}function zm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===qm}var aS={mapValue:{fields:{[Vl]:{stringValue:Ml},[sr]:{arrayValue:{}}}}};var rt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Zs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=fi(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=fi(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Zs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Zs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Dn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(fi(this.value))}};function Gm(n){let e=[];return Dn(n.fields,(t,r)=>{let i=new ze([t]);if(Zs(r)){let o=Gm(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new ct(e)}var it=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,z.min(),z.min(),z.min(),rt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,z.min(),z.min(),rt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,z.min(),z.min(),rt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var cr=class{constructor(e,t){this.position=e,this.inclusive=t}};function Bp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=or(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function jp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dt(n.position[t],e.position[t]))return!1;return!0}var bn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function kI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var co=class{},ge=class n extends co{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ru(e,t,r):t==="array-contains"?new ou(e,r):t==="in"?new au(e,r):t==="not-in"?new cu(e,r):t==="array-contains-any"?new uu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new iu(e,r):new su(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(or(t,this.value)):t!==null&&Ht(this.value)===Ht(t)&&this.matchesComparison(or(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},st=class n extends co{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return Wm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function Wm(n){return n.op==="and"}function Hm(n){return OI(n)&&Wm(n)}function OI(n){for(let e of n.filters)if(e instanceof st)return!1;return!0}function nu(n){if(n instanceof ge)return n.field.canonicalString()+n.op.toString()+ar(n.value);if(Hm(n))return n.filters.map(e=>nu(e)).join(",");{let e=n.filters.map(t=>nu(t)).join(",");return`${n.op}(${e})`}}function Km(n,e){return n instanceof ge?(function(r,i){return i instanceof ge&&r.op===i.op&&r.field.isEqual(i.field)&&dt(r.value,i.value)})(n,e):n instanceof st?(function(r,i){return i instanceof st&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&Km(a,i.filters[u]),!0):!1})(n,e):void j(19439)}function Qm(n){return n instanceof ge?(function(t){return`${t.field.canonicalString()} ${t.op} ${ar(t.value)}`})(n):n instanceof st?(function(t){return t.op.toString()+" {"+t.getFilters().map(Qm).join(" ,")+"}"})(n):"Filter"}var ru=class extends ge{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},iu=class extends ge{constructor(e,t){super(e,"in",t),this.keys=Ym("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},su=class extends ge{constructor(e,t){super(e,"not-in",t),this.keys=Ym("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ym(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var ou=class extends ge{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Fl(t)&&Ii(t.arrayValue,this.value)}},au=class extends ge{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ii(this.value.arrayValue,t)}},cu=class extends ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ii(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ii(this.value.arrayValue,t)}},uu=class extends ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Fl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ii(this.value.arrayValue,r))}};var lu=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Pe=null}};function qp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new lu(n,e,t,r,i,o,a)}function Ll(n){let e=$(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>nu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),Vo(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ar(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ar(r)).join(",")),e.Pe=t}return e.Pe}function Ul(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!kI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Km(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jp(n.startAt,e.startAt)&&jp(n.endAt,e.endAt)}function hu(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Kt=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function NI(n,e,t,r,i,o,a,u){return new Kt(n,e,t,r,i,o,a,u)}function Bl(n){return new Kt(n)}function $p(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Jm(n){return n.collectionGroup!==null}function pi(n){let e=$(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new be(ze.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new bn(o,r))}),t.has(ze.keyField().canonicalString())||e.Te.push(new bn(ze.keyField(),r))}return e.Te}function lt(n){let e=$(n);return e.Ie||(e.Ie=xI(e,pi(n))),e.Ie}function xI(n,e){if(n.limitType==="F")return qp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new bn(i.field,o)});let t=n.endAt?new cr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new cr(n.startAt.position,n.startAt.inclusive):null;return qp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function du(n,e){let t=n.filters.concat([e]);return new Kt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function fu(n,e,t){return new Kt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Fo(n,e){return Ul(lt(n),lt(e))&&n.limitType===e.limitType}function Xm(n){return`${Ll(lt(n))}|lt:${n.limitType}`}function Jn(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Qm(i)).join(", ")}]`),Vo(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ar(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ar(i)).join(",")),`Target(${r})`})(lt(n))}; limitType=${n.limitType})`}function Lo(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):B.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of pi(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,u,h){let d=Bp(a,u,h);return a.inclusive?d<=0:d<0})(r.startAt,pi(r),i)||r.endAt&&!(function(a,u,h){let d=Bp(a,u,h);return a.inclusive?d>=0:d>0})(r.endAt,pi(r),i))})(n,e)}function VI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Zm(n){return(e,t)=>{let r=!1;for(let i of pi(n)){let o=MI(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function MI(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):(function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?or(h,d):j(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j(19790,{direction:n.dir})}}var St=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Dn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Fm(this.inner)}size(){return this.innerSize}};var FI=new he(B.comparator);function Pt(){return FI}var eg=new he(B.comparator);function hi(...n){let e=eg;for(let t of n)e=e.insert(t.key,t);return e}function tg(n){let e=eg;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function gn(){return mi()}function ng(){return mi()}function mi(){return new St(n=>n.toString(),(n,e)=>n.isEqual(e))}var LI=new he(B.comparator),UI=new be(B.comparator);function Y(...n){let e=UI;for(let t of n)e=e.add(t);return e}var BI=new be(H);function jI(){return BI}function jl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function rg(n){return{integerValue:""+n}}function qI(n,e){return _I(e)?rg(e):jl(n,e)}var ur=class{constructor(){this._=void 0}};function $I(n,e,t){return n instanceof Tn?(function(i,o){let a={fields:{[Um]:{stringValue:Lm},[jm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&xl(o)&&(o=Mo(o)),o&&(a.fields[Bm]=o),{mapValue:a}})(t,e):n instanceof An?sg(n,e):n instanceof Cn?og(n,e):(function(i,o){let a=ig(i,o),u=zp(a)+zp(i.Ee);return tu(a)&&tu(i.Ee)?rg(u):jl(i.serializer,u)})(n,e)}function zI(n,e,t){return n instanceof An?sg(n,e):n instanceof Cn?og(n,e):t}function ig(n,e){return n instanceof lr?(function(r){return tu(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var Tn=class extends ur{},An=class extends ur{constructor(e){super(),this.elements=e}};function sg(n,e){let t=ag(e);for(let r of n.elements)t.some(i=>dt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Cn=class extends ur{constructor(e){super(),this.elements=e}};function og(n,e){let t=ag(e);for(let r of n.elements)t=t.filter(i=>!dt(i,r));return{arrayValue:{values:t}}}var lr=class extends ur{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function zp(n){return ae(n.integerValue||n.doubleValue)}function ag(n){return Fl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var pu=class{constructor(e,t){this.field=e,this.transform=t}};function GI(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof An&&i instanceof An||r instanceof Cn&&i instanceof Cn?ir(r.elements,i.elements,dt):r instanceof lr&&i instanceof lr?dt(r.Ee,i.Ee):r instanceof Tn&&i instanceof Tn})(n.transform,e.transform)}var mu=class{constructor(e,t){this.version=e,this.transformResults=t}},vn=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function eo(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var hr=class{};function cg(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new uo(n.key,vn.none()):new Sn(n.key,n.data,vn.none());{let t=n.data,r=rt.empty(),i=new be(ze.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new Rt(n.key,r,new ct(i.toArray()),vn.none())}}function WI(n,e,t){n instanceof Sn?(function(i,o,a){let u=i.value.clone(),h=Wp(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Rt?(function(i,o,a){if(!eo(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=Wp(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(ug(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function gi(n,e,t,r){return n instanceof Sn?(function(o,a,u,h){if(!eo(o.precondition,a))return u;let d=o.value.clone(),p=Hp(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Rt?(function(o,a,u,h){if(!eo(o.precondition,a))return u;let d=Hp(o.fieldTransforms,h,a),p=a.data;return p.setAll(ug(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))})(n,e,t,r):(function(o,a,u){return eo(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(n,e,t)}function HI(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=ig(r.transform,i||null);o!=null&&(t===null&&(t=rt.empty()),t.set(r.field,o))}return t||null}function Gp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ir(r,i,(o,a)=>GI(o,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Sn=class extends hr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Rt=class extends hr{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function ug(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Wp(n,e,t){let r=new Map;ee(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,zI(a,u,t[i]))}return r}function Hp(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,$I(o,a,e))}return r}var uo=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},gu=class extends hr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var _u=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&WI(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=gi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=gi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=ng();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=cg(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Y())}isEqual(e){return this.batchId===e.batchId&&ir(this.mutations,e.mutations,(t,r)=>Gp(t,r))&&ir(this.baseMutations,e.baseMutations,(t,r)=>Gp(t,r))}},yu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ee(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return LI})(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var vu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var wu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var pe,J;function KI(n){switch(n){case P.OK:return j(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return j(15467,{code:n})}}function lg(n){if(n===void 0)return Tt("GRPC error has no .code"),P.UNKNOWN;switch(n){case pe.OK:return P.OK;case pe.CANCELLED:return P.CANCELLED;case pe.UNKNOWN:return P.UNKNOWN;case pe.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case pe.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case pe.INTERNAL:return P.INTERNAL;case pe.UNAVAILABLE:return P.UNAVAILABLE;case pe.UNAUTHENTICATED:return P.UNAUTHENTICATED;case pe.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case pe.NOT_FOUND:return P.NOT_FOUND;case pe.ALREADY_EXISTS:return P.ALREADY_EXISTS;case pe.PERMISSION_DENIED:return P.PERMISSION_DENIED;case pe.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case pe.ABORTED:return P.ABORTED;case pe.OUT_OF_RANGE:return P.OUT_OF_RANGE;case pe.UNIMPLEMENTED:return P.UNIMPLEMENTED;case pe.DATA_LOSS:return P.DATA_LOSS;default:return j(39323,{code:n})}}(J=pe||(pe={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var Kp=null;var QI=new It([4294967295,4294967295],0);function Qp(n){let e=wm().encode(n),t=new xc;return t.update(e),new Uint8Array(t.digest())}function Yp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new It([t,r],0),new It([i,o],0)]}var Iu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new _n(`Invalid padding: ${t}`);if(r<0)throw new _n(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new _n(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new _n(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=It.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(It.fromNumber(r)));return i.compare(QI)===1&&(i=new It([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=Qp(e),[r,i]=Yp(t);for(let o=0;o<this.hashCount;o++){let a=this.pe(r,i,o);if(!this.ye(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.fe===0)return;let t=Qp(e),[r,i]=Yp(t);for(let o=0;o<this.hashCount;o++){let a=this.pe(r,i,o);this.we(a)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},_n=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var lo=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ei.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(z.min(),i,new he(H),Pt(),Y())}},Ei=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Y(),Y(),Y())}};var tr=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},ho=class{constructor(e,t){this.targetId=e,this.De=t}},fo=class{constructor(e,t,r=Oe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},po=class{constructor(){this.ve=0,this.Ce=Jp(),this.Fe=Oe.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Y(),t=Y(),r=Y();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:j(38017,{changeType:o})}}),new Ei(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Jp()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ee(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},Eu=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Pt(),this.je=Ys(),this.Je=Ys(),this.He=new he(H)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:j(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let o=i.target;if(hu(o))if(r===0){let a=new B(o.path);this.Xe(t,a,it.newNoDocument(a,z.min()))}else ee(r===1,20013,{expectedCount:r});else{let a=this.ot(t);if(a!==r){let u=this._t(e),h=u?this.ut(u,e,a):1;if(h!==0){this.rt(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}Kp?.ct((function(p,y,w,S,O){var L,N,G,q,W,ne;let Ne={localCacheCount:p,existenceFilterCount:y.count,databaseId:w.database,projectId:w.projectId},te=y.unchangedNames;return te&&(Ne.bloomFilter={applied:O===0,hashCount:(L=te?.hashCount)!==null&&L!==void 0?L:0,bitmapLength:(q=(G=(N=te?.bits)===null||N===void 0?void 0:N.bitmap)===null||G===void 0?void 0:G.length)!==null&&q!==void 0?q:0,padding:(ne=(W=te?.bits)===null||W===void 0?void 0:W.padding)!==null&&ne!==void 0?ne:0,mightContain:I=>{var m;return(m=S?.mightContain(I))!==null&&m!==void 0&&m}}),Ne})(a,e.De,this.We.lt(),u,h))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,u;try{a=Ct(r).toUint8Array()}catch(h){if(h instanceof so)return Wt("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Iu(a,i,o)}catch(h){return Wt(h instanceof _n?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.fe===0?null:u}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.We.lt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(t,o,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((o,a)=>{let u=this.st(a);if(u){if(o.current&&hu(u.target)){let h=new B(u.target.path);this.Tt(h).has(a)||this.It(a,h)||this.Xe(a,h,it.newNoDocument(h,e))}o.Ne&&(t.set(a,o.Le()),o.ke())}});let r=Y();this.Je.forEach((o,a)=>{let u=!0;a.forEachWhile(h=>{let d=this.st(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ze.forEach((o,a)=>a.setReadTime(e));let i=new lo(e,t,this.He,this.ze,r);return this.ze=Pt(),this.je=Ys(),this.Je=Ys(),this.He=new he(H),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new po,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new be(H),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new be(H),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new po),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Ys(){return new he(B.comparator)}function Jp(){return new he(B.comparator)}var YI={asc:"ASCENDING",desc:"DESCENDING"},JI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XI={and:"AND",or:"OR"},bu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Tu(n,e){return n.useProto3Json||Vo(e)?e:{value:e}}function mo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hg(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function ZI(n,e){return mo(n,e.toTimestamp())}function ht(n){return ee(!!n,49232),z.fromTimestamp((function(t){let r=At(t);return new ye(r.seconds,r.nanos)})(n))}function ql(n,e){return Au(n,e).canonicalString()}function Au(n,e){let t=(function(i){return new ce(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function dg(n){let e=ce.fromString(n);return ee(_g(e),10190,{key:e.toString()}),e}function Cu(n,e){return ql(n.databaseId,e.path)}function Bc(n,e){let t=dg(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(pg(t))}function fg(n,e){return ql(n.databaseId,e)}function eE(n){let e=dg(n);return e.length===4?ce.emptyPath():pg(e)}function Su(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function pg(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Xp(n,e,t){return{name:Cu(n,e),fields:t.value.mapValue.fields}}function tE(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:j(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(ee(p===void 0||typeof p=="string",58123),Oe.fromBase64String(p||"")):(ee(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Oe.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&(function(d){let p=d.code===void 0?P.UNKNOWN:lg(d.code);return new M(p,d.message||"")})(a);t=new fo(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Bc(n,r.document.name),o=ht(r.document.updateTime),a=r.document.createTime?ht(r.document.createTime):z.min(),u=new rt({mapValue:{fields:r.document.fields}}),h=it.newFoundDocument(i,o,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new tr(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Bc(n,r.document),o=r.readTime?ht(r.readTime):z.min(),a=it.newNoDocument(i,o),u=r.removedTargetIds||[];t=new tr([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Bc(n,r.document),o=r.removedTargetIds||[];t=new tr([],o,i,null)}else{if(!("filter"in e))return j(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new wu(i,o),u=r.targetId;t=new ho(u,a)}}return t}function nE(n,e){let t;if(e instanceof Sn)t={update:Xp(n,e.key,e.value)};else if(e instanceof uo)t={delete:Cu(n,e.key)};else if(e instanceof Rt)t={update:Xp(n,e.key,e.data),updateMask:hE(e.fieldMask)};else{if(!(e instanceof gu))return j(16599,{Rt:e.type});t={verify:Cu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,a){let u=a.transform;if(u instanceof Tn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof An)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Cn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof lr)return{fieldPath:a.field.canonicalString(),increment:u.Ee};throw j(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:ZI(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:j(27497)})(n,e.precondition)),t}function rE(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map(t=>(function(i,o){let a=i.updateTime?ht(i.updateTime):ht(o);return a.isEqual(z.min())&&(a=ht(o)),new mu(a,i.transformResults||[])})(t,e))):[]}function iE(n,e){return{documents:[fg(n,e.path)]}}function sE(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=fg(n,i);let o=(function(d){if(d.length!==0)return gg(st.create(d,"and"))})(e.filters);o&&(t.structuredQuery.where=o);let a=(function(d){if(d.length!==0)return d.map(p=>(function(w){return{field:Xn(w.field),direction:cE(w.dir)}})(p))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Tu(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{Vt:t,parent:i}}function oE(n){let e=eE(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ee(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=(function(y){let w=mg(y);return w instanceof st&&Hm(w)?w.getFilters():[w]})(t.where));let a=[];t.orderBy&&(a=(function(y){return y.map(w=>(function(O){return new bn(Zn(O.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(O.direction))})(w))})(t.orderBy));let u=null;t.limit&&(u=(function(y){let w;return w=typeof y=="object"?y.value:y,Vo(w)?null:w})(t.limit));let h=null;t.startAt&&(h=(function(y){let w=!!y.before,S=y.values||[];return new cr(S,w)})(t.startAt));let d=null;return t.endAt&&(d=(function(y){let w=!y.before,S=y.values||[];return new cr(S,w)})(t.endAt)),NI(e,i,a,o,u,"F",h,d)}function aE(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function mg(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Zn(t.unaryFilter.field);return ge.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Zn(t.unaryFilter.field);return ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Zn(t.unaryFilter.field);return ge.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Zn(t.unaryFilter.field);return ge.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}})(n):n.fieldFilter!==void 0?(function(t){return ge.create(Zn(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return st.create(t.compositeFilter.filters.map(r=>mg(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j(1026)}})(t.compositeFilter.op))})(n):j(30097,{filter:n})}function cE(n){return YI[n]}function uE(n){return JI[n]}function lE(n){return XI[n]}function Xn(n){return{fieldPath:n.canonicalString()}}function Zn(n){return ze.fromServerFormat(n.fieldPath)}function gg(n){return n instanceof ge?(function(t){if(t.op==="=="){if(Up(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NAN"}};if(Lp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Up(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NAN"}};if(Lp(t.value))return{unaryFilter:{field:Xn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xn(t.field),op:uE(t.op),value:t.value}}})(n):n instanceof st?(function(t){let r=t.getFilters().map(i=>gg(i));return r.length===1?r[0]:{compositeFilter:{op:lE(t.op),filters:r}}})(n):j(54877,{filter:n})}function hE(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function _g(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var bi=class n{constructor(e,t,r,i,o=z.min(),a=z.min(),u=Oe.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Pu=class{constructor(e){this.gt=e}};function dE(n){let e=oE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?fu(e,e.limit,"L"):e}var go=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ae(e.integerValue));else if("doubleValue"in e){let r=ae(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),vi(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=At(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Ct(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?zm(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):$m(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):j(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let o=e.fields||{};this.Ct(t,53);let a=sr,u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(ae(u)),this.xt(a,t),this.Dt(o[a],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),B.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};go.Ut=new go;var Ru=class{constructor(){this.Dn=new Du}addToCollectionParentIndex(e,t){return this.Dn.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(En.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(En.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},Du=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new be(ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new be(ce.comparator)).toArray()}};var cS=new Uint8Array(0);var Zp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},yg=41943040,Ke=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ke.DEFAULT_COLLECTION_PERCENTILE=10,Ke.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ke.DEFAULT=new Ke(yg,Ke.DEFAULT_COLLECTION_PERCENTILE,Ke.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ke.DISABLED=new Ke(-1,0,0);var Ti=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var em="LruGarbageCollector",fE=1048576;function tm([n,e],[t,r]){let i=H(n,t);return i===0?H(e,r):i}var ku=class{constructor(e){this.Tr=e,this.buffer=new be(tm),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();tm(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ou=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){F(em,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>A(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){_r(t)?F(em,"Ignoring IndexedDB error during garbage collection: ",t):yield gr(t)}yield this.Rr(3e5)}))}},Nu=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return D.resolve(Ol.ue);let r=new ku(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(Zp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Zp):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,a,u,h,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,a=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,u=Date.now(),this.removeTargets(e,r,t))).next(y=>(o=y,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(d=Date.now(),Yn()<=K.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${y} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}};function pE(n,e){return new Nu(n,e)}var xu=class{constructor(){this.changes=new St(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,it.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Vu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Mu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&gi(r.mutation,i,ct.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Y()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Y()){let i=gn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=hi();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=gn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Y()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=Pt(),a=mi(),u=(function(){return mi()})();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Rt)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),gi(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,ct.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var y;return u.set(d,new Vu(p,(y=a.get(d))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,t){let r=mi(),i=new he((a,u)=>a-u),o=Y();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||ct.empty();p=u.applyToLocalView(d,p),r.set(h,p);let y=(i.get(u.batchId)||Y()).add(h);i=i.insert(u.batchId,y)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,p=h.value,y=ng();p.forEach(w=>{if(!o.has(w)){let S=cg(t.get(w),r.get(w));S!==null&&y.set(w,S),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,y))}return D.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Jm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):D.resolve(gn()),u=yi,h=o;return a.next(d=>D.forEach(d,(p,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),o.get(p)?D.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{h=h.insert(p,w)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Y())).next(p=>({batchId:u,changes:tg(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=hi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=hi();return this.indexManager.getCollectionParents(e,o).next(u=>D.forEach(u,h=>{let d=(function(y,w){return new Kt(w,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((y,w)=>{a=a.insert(y,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,it.newInvalidDocument(p)))});let u=hi();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&gi(p.mutation,d,ct.empty(),ye.now()),Lo(t,d)&&(u=u.insert(h,d))}),u})}};var Fu=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return D.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ht(i.createTime)}})(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:dE(i.bundledQuery),readTime:ht(i.readTime)}})(t)),D.resolve()}};var Lu=class{constructor(){this.overlays=new he(B.comparator),this.kr=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let r=gn();return D.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.wt(e,t,o)}),D.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){let i=gn(),o=t.length+1,a=new B(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new he((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=gn(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=gn(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return D.resolve(u)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new vu(t,r));let o=this.kr.get(t);o===void 0&&(o=Y(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var Uu=class{constructor(){this.sessionToken=Oe.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}};var Ai=class{constructor(){this.qr=new be(me.Qr),this.$r=new be(me.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new me(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new me(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new B(new ce([])),r=new me(t,e),i=new me(t,e+1),o=[];return this.$r.forEachInRange([r,i],a=>{this.Wr(a),o.push(a.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new B(new ce([])),r=new me(t,e),i=new me(t,e+1),o=Y();return this.$r.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new me(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},me=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return B.comparator(e.key,t.key)||H(e.Hr,t.Hr)}static Ur(e,t){return H(e.Hr,t.Hr)||B.comparator(e.key,t.key)}};var Bu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new be(me.Qr)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new _u(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.Yr=this.Yr.add(new me(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return D.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?Nl:this.er-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new me(t,0),i=new me(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],a=>{let u=this.Zr(a.Hr);o.push(u)}),D.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new be(H);return t.forEach(i=>{let o=new me(i,0),a=new me(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,a],u=>{r=r.add(u.Hr)})}),D.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;B.isDocumentKey(o)||(o=o.child(""));let a=new me(new B(o),0),u=new be(H);return this.Yr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Hr)),!0)},a),D.resolve(this.ei(u))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return D.forEach(t.mutations,i=>{let o=new me(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new me(t,0),i=this.Yr.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ju=class{constructor(e){this.ni=e,this.docs=(function(){return new he(B.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():it.newInvalidDocument(t))}getEntries(e,t){let r=Pt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():it.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Pt(),a=t.path,u=new B(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||pI(fI(p),r)<=0||(i.has(p.key)||Lo(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return D.resolve(o)}getAllFromCollectionGroup(e,t,r,i){j(9500)}ri(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new qu(this)}getSize(e){return D.resolve(this.size)}},qu=class extends xu{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var $u=class{constructor(e){this.persistence=e,this.ii=new St(t=>Ll(t),Ul),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.si=0,this.oi=new Ai,this.targetCount=0,this._i=Ti.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),D.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Ti(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.hr(t),D.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ii.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ii.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),D.waitFor(o).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),D.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.oi.containsKey(t))}};var _o=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Ol(0),this.ci=!1,this.ci=!0,this.li=new Uu,this.referenceDelegate=e(this),this.hi=new $u(this),this.indexManager=new Ru,this.remoteDocumentCache=(function(i){return new ju(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Pu(t),this.Ti=new Fu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Lu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Bu(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new zu(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return D.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},zu=class extends Xc{constructor(e){super(),this.currentSequenceNumber=e}},Gu=class n{constructor(e){this.persistence=e,this.Ai=new Ai,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw j(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),D.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.mi,r=>{let i=B.fromPath(r);return this.fi(e,i).next(o=>{o||t.removeEntry(i,z.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return D.or([()=>D.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},yo=class n{constructor(e,t){this.persistence=e,this.gi=new St(r=>yI(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=pE(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return D.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(o=>o?D.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,a=>this.Sr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,z.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),D.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xs(e.data.value)),t}Sr(e,t,r){return D.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return D.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Wu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Y(),i=Y();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var Hu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ku=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return Pf()?8:gI($e())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ps(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ys(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new Hu;return this.ws(e,t,a).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,t,a,u.size)})}).next(()=>o.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Yn()<=K.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Jn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),D.resolve()):(Yn()<=K.DEBUG&&F("QueryEngine","Query:",Jn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Yn()<=K.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Jn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lt(t))):D.resolve())}ps(e,t){if($p(t))return D.resolve(null);let r=lt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=fu(t,null,"F"),r=lt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Y(...o);return this.gs.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.bs(t,u);return this.Ds(t,d,a,h.readTime)?this.ps(e,fu(t,null,"F")):this.vs(e,d,t,h)}))})))}ys(e,t,r,i){return $p(t)||i.isEqual(z.min())?D.resolve(null):this.gs.getDocuments(e,r).next(o=>{let a=this.bs(t,o);return this.Ds(t,a,r,i)?D.resolve(null):(Yn()<=K.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jn(t)),this.vs(e,a,t,dI(i,yi)).next(u=>u))})}bs(e,t){let r=new be(Zm(e));return t.forEach((i,o)=>{Lo(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return Yn()<=K.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Jn(t)),this.gs.getDocumentsMatchingQuery(e,t,En.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var $l="LocalStore",mE=3e8,Qu=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new he(H),this.Ms=new St(o=>Ll(o),Ul),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Mu(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function gE(n,e,t,r){return new Qu(n,e,t,r)}function vg(n,e){return A(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=Y();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){u.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({Bs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function _E(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,p){let y=d.batch,w=y.keys(),S=D.resolve();return w.forEach(O=>{S=S.next(()=>p.getEntry(h,O)).next(L=>{let N=d.docVersions.get(O);ee(N!==null,48541),L.version.compareTo(N)<0&&(y.applyToRemoteDocument(L,d),L.isValidDocument()&&(L.setReadTime(d.commitVersion),p.addEntry(L)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(h,y))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=Y();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function wg(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function yE(n,e){let t=$(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let u=[];e.targetChanges.forEach((p,y)=>{let w=i.get(y);if(!w)return;u.push(t.hi.removeMatchingKeys(o,p.removedDocuments,y).next(()=>t.hi.addMatchingKeys(o,p.addedDocuments,y)));let S=w.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?S=S.withResumeToken(Oe.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(y,S),(function(L,N,G){return L.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=mE?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0})(w,S,p)&&u.push(t.hi.updateTargetData(o,S))});let h=Pt(),d=Y();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),u.push(vE(o,a,e.documentUpdates).next(p=>{h=p.Ls,d=p.ks})),!r.isEqual(z.min())){let p=t.hi.getLastRemoteSnapshotVersion(o).next(y=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(p)}return D.waitFor(u).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.Fs=i,o))}function vE(n,e,t){let r=Y(),i=Y();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=Pt();return t.forEach((u,h)=>{let d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(z.min())?(e.removeEntry(u,h.readTime),a=a.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(u,h)):F($l,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ls:a,ks:i}})}function wE(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Nl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function IE(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(o=>o?(i=o,D.resolve(i)):t.hi.allocateTargetId(r).next(a=>(i=new bi(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function Yu(n,e,t){return A(this,null,function*(){let r=$(n),i=r.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!_r(a))throw a;F($l,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function nm(n,e,t){let r=$(n),i=z.min(),o=Y();return r.persistence.runTransaction("Execute query","readwrite",a=>(function(h,d,p){let y=$(h),w=y.Ms.get(p);return w!==void 0?D.resolve(y.Fs.get(w)):y.hi.getTargetData(d,p)})(r,a,lt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,u.targetId).next(h=>{o=h})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,e,t?i:z.min(),t?o:Y())).next(u=>(EE(r,VI(e),u),{documents:u,qs:o})))}function EE(n,e,t){let r=n.xs.get(e)||z.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.xs.set(e,r)}var vo=class{constructor(){this.activeTargetIds=jI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Ju=class{constructor(){this.Fo=new vo,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new vo,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Xu=class{xo(e){}shutdown(){}};var rm="ConnectivityMonitor",wo=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){F(rm,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){F(rm,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Js=null;function Zu(){return Js===null?Js=(function(){return 268435456+Math.round(2147483648*Math.random())})():Js++,"0x"+Js.toString(16)}var jc="RestConnection",bE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},el=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===oo?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let a=Zu(),u=this.Go(e,t.toUriEncodedString());F(jc,`Sending RPC '${e}' ${a}:`,u,r);let h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,o);let{host:d}=new URL(u),p=on(d);return this.jo(e,u,h,r,p).then(y=>(F(jc,`Received RPC '${e}' ${a}: `,y),y),y=>{throw Wt(jc,`RPC '${e}' ${a} failed with error: `,y,"url: ",u,"request:",r),y})}Jo(e,t,r,i,o,a){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+mr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Go(e,t){let r=bE[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var tl=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var De="WebChannelConnection",nl=class extends el{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){let a=Zu();return new Promise((u,h)=>{let d=new Vc;d.setWithCredentials(!0),d.listenOnce(Mc.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case li.NO_ERROR:let y=d.getResponseJson();F(De,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),u(y);break;case li.TIMEOUT:F(De,`RPC '${e}' ${a} timed out`),h(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case li.HTTP_ERROR:let w=d.getStatus();if(F(De,`RPC '${e}' ${a} failed with status:`,w,"response text:",d.getResponseText()),w>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);let O=S?.error;if(O&&O.status&&O.message){let L=(function(G){let q=G.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(q)>=0?q:P.UNKNOWN})(O.status);h(new M(L,O.message))}else h(new M(P.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new M(P.UNAVAILABLE,"Connection failed."));break;default:j(9055,{c_:e,streamId:a,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{F(De,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);F(De,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}P_(e,t,r){let i=Zu(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Uc(),u=Lc(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");F(De,`Creating RPC '${e}' stream ${i}: ${p}`,h);let y=a.createWebChannel(p,h);this.T_(y);let w=!1,S=!1,O=new tl({Ho:N=>{S?F(De,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(w||(F(De,`Opening RPC '${e}' stream ${i} transport.`),y.open(),w=!0),F(De,`RPC '${e}' stream ${i} sending:`,N),y.send(N))},Yo:()=>y.close()}),L=(N,G,q)=>{N.listen(G,W=>{try{q(W)}catch(ne){setTimeout(()=>{throw ne},0)}})};return L(y,Qn.EventType.OPEN,()=>{S||(F(De,`RPC '${e}' stream ${i} transport opened.`),O.s_())}),L(y,Qn.EventType.CLOSE,()=>{S||(S=!0,F(De,`RPC '${e}' stream ${i} transport closed`),O.__(),this.I_(y))}),L(y,Qn.EventType.ERROR,N=>{S||(S=!0,Wt(De,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),O.__(new M(P.UNAVAILABLE,"The operation could not be completed")))}),L(y,Qn.EventType.MESSAGE,N=>{var G;if(!S){let q=N.data[0];ee(!!q,16349);let W=q,ne=W?.error||((G=W[0])===null||G===void 0?void 0:G.error);if(ne){F(De,`RPC '${e}' stream ${i} received error:`,ne);let Ne=ne.status,te=(function(_){let v=pe[_];if(v!==void 0)return lg(v)})(Ne),I=ne.message;te===void 0&&(te=P.INTERNAL,I="Unknown error status: "+Ne+" with message "+ne.message),S=!0,O.__(new M(te,I)),y.close()}else F(De,`RPC '${e}' stream ${i} received:`,q),O.a_(q)}}),L(u,Fc.STAT_EVENT,N=>{N.stat===Ks.PROXY?F(De,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Ks.NOPROXY&&F(De,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{O.o_()},0),O}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function qc(){return typeof document<"u"?document:null}function Uo(n){return new bu(n,!0)}var Io=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var im="PersistentStream",Eo=class{constructor(e,t,r,i,o,a,u,h){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Io(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return A(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return A(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return A(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Tt(t.toString()),Tt("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>A(this,null,function*(){this.state=0,this.start()}))}G_(e){return F(im,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(F(im,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},rl=class extends Eo{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=tE(this.serializer,e),r=(function(o){if(!("targetChange"in o))return z.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?z.min():a.readTime?ht(a.readTime):z.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=Su(this.serializer),t.addTarget=(function(o,a){let u,h=a.target;if(u=hu(h)?{documents:iE(o,h)}:{query:sE(o,h).Vt},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=hg(o,a.resumeToken);let d=Tu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(z.min())>0){u.readTime=mo(o,a.snapshotVersion.toTimestamp());let d=Tu(o,a.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);let r=aE(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=Su(this.serializer),t.removeTarget=e,this.k_(t)}},il=class extends Eo{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=rE(e.writeResults,e.commitTime),r=ht(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=Su(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>nE(this.serializer,r))};this.k_(t)}};var sl=class{},ol=class extends sl{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,Au(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())})}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Jo(e,Au(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(P.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},al=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Tt(t),this._a=!1):F("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Pn="RemoteStore",cl=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(a=>{r.enqueueAndForget(()=>A(this,null,function*(){kn(this)&&(F(Pn,"Restarting streams for network reachability change."),yield(function(h){return A(this,null,function*(){let d=$(h);d.Ia.add(4),yield Di(d),d.Aa.set("Unknown"),d.Ia.delete(4),yield Bo(d)})})(this))}))}),this.Aa=new al(r,i)}};function Bo(n){return A(this,null,function*(){if(kn(n))for(let e of n.da)yield e(!0)})}function Di(n){return A(this,null,function*(){for(let e of n.da)yield e(!1)})}function Ig(n,e){let t=$(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Hl(t)?Wl(t):yr(t).x_()&&Gl(t,e))}function zl(n,e){let t=$(n),r=yr(t);t.Ta.delete(e),r.x_()&&Eg(t,e),t.Ta.size===0&&(r.x_()?r.B_():kn(t)&&t.Aa.set("Unknown"))}function Gl(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}yr(n).H_(e)}function Eg(n,e){n.Ra.$e(e),yr(n).Y_(e)}function Wl(n){n.Ra=new Eu({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),yr(n).start(),n.Aa.aa()}function Hl(n){return kn(n)&&!yr(n).M_()&&n.Ta.size>0}function kn(n){return $(n).Ia.size===0}function bg(n){n.Ra=void 0}function TE(n){return A(this,null,function*(){n.Aa.set("Online")})}function AE(n){return A(this,null,function*(){n.Ta.forEach((e,t)=>{Gl(n,e)})})}function CE(n,e){return A(this,null,function*(){bg(n),Hl(n)?(n.Aa.la(e),Wl(n)):n.Aa.set("Unknown")})}function SE(n,e,t){return A(this,null,function*(){if(n.Aa.set("Online"),e instanceof fo&&e.state===2&&e.cause)try{yield(function(i,o){return A(this,null,function*(){let a=o.cause;for(let u of o.targetIds)i.Ta.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.Ta.delete(u),i.Ra.removeTarget(u))})})(n,e)}catch(r){F(Pn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield bo(n,r)}else if(e instanceof tr?n.Ra.Ye(e):e instanceof ho?n.Ra.it(e):n.Ra.et(e),!t.isEqual(z.min()))try{let r=yield wg(n.localStore);t.compareTo(r)>=0&&(yield(function(o,a){let u=o.Ra.Pt(a);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.Ta.get(d);p&&o.Ta.set(d,p.withResumeToken(h.resumeToken,a))}}),u.targetMismatches.forEach((h,d)=>{let p=o.Ta.get(h);if(!p)return;o.Ta.set(h,p.withResumeToken(Oe.EMPTY_BYTE_STRING,p.snapshotVersion)),Eg(o,h);let y=new bi(p.target,h,d,p.sequenceNumber);Gl(o,y)}),o.remoteSyncer.applyRemoteEvent(u)})(n,t))}catch(r){F(Pn,"Failed to raise snapshot:",r),yield bo(n,r)}})}function bo(n,e,t){return A(this,null,function*(){if(!_r(e))throw e;n.Ia.add(1),yield Di(n),n.Aa.set("Offline"),t||(t=()=>wg(n.localStore)),n.asyncQueue.enqueueRetryable(()=>A(null,null,function*(){F(Pn,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield Bo(n)}))})}function Tg(n,e){return e().catch(t=>bo(n,t,e))}function jo(n){return A(this,null,function*(){let e=$(n),t=Qt(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Nl;for(;PE(e);)try{let i=yield wE(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,RE(e,i)}catch(i){yield bo(e,i)}Ag(e)&&Cg(e)})}function PE(n){return kn(n)&&n.Pa.length<10}function RE(n,e){n.Pa.push(e);let t=Qt(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Ag(n){return kn(n)&&!Qt(n).M_()&&n.Pa.length>0}function Cg(n){Qt(n).start()}function DE(n){return A(this,null,function*(){Qt(n).na()})}function kE(n){return A(this,null,function*(){let e=Qt(n);for(let t of n.Pa)e.X_(t.mutations)})}function OE(n,e,t){return A(this,null,function*(){let r=n.Pa.shift(),i=yu.from(r,e,t);yield Tg(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield jo(n)})}function NE(n,e){return A(this,null,function*(){e&&Qt(n).Z_&&(yield(function(r,i){return A(this,null,function*(){if((function(a){return KI(a)&&a!==P.ABORTED})(i.code)){let o=r.Pa.shift();Qt(r).N_(),yield Tg(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield jo(r)}})})(n,e)),Ag(n)&&Cg(n)})}function sm(n,e){return A(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),F(Pn,"RemoteStore received new credentials");let r=kn(t);t.Ia.add(3),yield Di(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield Bo(t)})}function xE(n,e){return A(this,null,function*(){let t=$(n);e?(t.Ia.delete(2),yield Bo(t)):e||(t.Ia.add(2),yield Di(t),t.Aa.set("Unknown"))})}function yr(n){return n.Va||(n.Va=(function(t,r,i){let o=$(t);return o.ia(),new rl(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:TE.bind(null,n),e_:AE.bind(null,n),n_:CE.bind(null,n),J_:SE.bind(null,n)}),n.da.push(e=>A(null,null,function*(){e?(n.Va.N_(),Hl(n)?Wl(n):n.Aa.set("Unknown")):(yield n.Va.stop(),bg(n))}))),n.Va}function Qt(n){return n.ma||(n.ma=(function(t,r,i){let o=$(t);return o.ia(),new il(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:DE.bind(null,n),n_:NE.bind(null,n),ea:kE.bind(null,n),ta:OE.bind(null,n)}),n.da.push(e=>A(null,null,function*(){e?(n.ma.N_(),yield jo(n)):(yield n.ma.stop(),n.Pa.length>0&&(F(Pn,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var ul=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Kl(n,e){if(Tt("AsyncQueue",`${e}: ${n}`),_r(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var To=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=hi(),this.sortedSet=new he(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ao=class{constructor(){this.fa=new he(B.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):j(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},dr=class n{constructor(e,t,r,i,o,a,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,To.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ll=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},hl=class{constructor(){this.queries=om(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=$(t),o=i.queries;i.queries=om(),o.forEach((a,u)=>{for(let h of u.wa)h.onError(r)})})(this,new M(P.ABORTED,"Firestore shutting down"))}};function om(){return new St(n=>Xm(n),Fo)}function VE(n,e){return A(this,null,function*(){let t=$(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.ba()&&(r=2):(o=new ll,r=e.ba()?0:1);try{switch(r){case 0:o.ya=yield t.onListen(i,!0);break;case 1:o.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Kl(a,`Initialization of query '${Jn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&Ql(t)})}function ME(n,e){return A(this,null,function*(){let t=$(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.wa.indexOf(e);a>=0&&(o.wa.splice(a,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function FE(n,e){let t=$(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let u of a.wa)u.Ca(i)&&(r=!0);a.ya=i}}r&&Ql(t)}function LE(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let o of i.wa)o.onError(t);r.queries.delete(e)}function Ql(n){n.Da.forEach(e=>{e.next()})}var dl,am;(am=dl||(dl={})).Fa="default",am.Cache="cache";var fl=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new dr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==dl.Cache}};var Co=class{constructor(e){this.key=e}},So=class{constructor(e){this.key=e}},pl=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Y(),this.mutatedKeys=Y(),this.Xa=Zm(e),this.eu=new To(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new Ao,i=t?t.eu:this.eu,o=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,y)=>{let w=i.get(p),S=Lo(this.query,y)?y:null,O=!!w&&this.mutatedKeys.has(w.key),L=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),N=!1;w&&S?w.data.isEqual(S.data)?O!==L&&(r.track({type:3,doc:S}),N=!0):this.iu(w,S)||(r.track({type:2,doc:S}),N=!0,(h&&this.Xa(S,h)>0||d&&this.Xa(S,d)<0)&&(u=!0)):!w&&S?(r.track({type:0,doc:S}),N=!0):w&&!S&&(r.track({type:1,doc:w}),N=!0,(h||d)&&(u=!0)),N&&(S?(a=a.add(S),o=L?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{eu:a,ru:r,Ds:u,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let a=e.ru.pa();a.sort((p,y)=>(function(S,O){let L=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{At:N})}};return L(S)-L(O)})(p.type,y.type)||this.Xa(p.doc,y.doc)),this.su(r),i=i!=null&&i;let u=t&&!i?this.ou():[],h=this.Za.size===0&&this.current&&!i?1:0,d=h!==this.Ya;return this.Ya=h,a.length!==0||d?{snapshot:new dr(this.query,e.eu,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ao,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=Y(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new So(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new Co(r))}),t}uu(e){this.Ha=e.qs,this.Za=Y();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return dr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Yl="SyncEngine",ml=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},gl=class{constructor(e){this.key=e,this.lu=!1}},_l=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new St(u=>Xm(u),Fo),this.Tu=new Map,this.Iu=new Set,this.du=new he(B.comparator),this.Eu=new Map,this.Au=new Ai,this.Ru={},this.Vu=new Map,this.mu=Ti.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function UE(n,e,t=!0){return A(this,null,function*(){let r=Og(n),i,o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=yield Sg(r,e,t,!0),i})}function BE(n,e){return A(this,null,function*(){let t=Og(n);yield Sg(t,e,!0,!1)})}function Sg(n,e,t,r){return A(this,null,function*(){let i=yield IE(n.localStore,lt(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),u;return r&&(u=yield jE(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ig(n.remoteStore,i),u})}function jE(n,e,t,r,i){return A(this,null,function*(){n.gu=(y,w,S)=>(function(L,N,G,q){return A(this,null,function*(){let W=N.view.nu(G);W.Ds&&(W=yield nm(L.localStore,N.query,!1).then(({documents:I})=>N.view.nu(I,W)));let ne=q&&q.targetChanges.get(N.targetId),Ne=q&&q.targetMismatches.get(N.targetId)!=null,te=N.view.applyChanges(W,L.isPrimaryClient,ne,Ne);return um(L,N.targetId,te._u),te.snapshot})})(n,y,w,S);let o=yield nm(n.localStore,e,!0),a=new pl(e,o.qs),u=a.nu(o.documents),h=Ei.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,h);um(n,t,d._u);let p=new ml(e,t,a);return n.Pu.set(e,p),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot})}function qE(n,e,t){return A(this,null,function*(){let r=$(n),i=r.Pu.get(e),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter(a=>!Fo(a,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Yu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&zl(r.remoteStore,i.targetId),yl(r,i.targetId)}).catch(gr))):(yl(r,i.targetId),yield Yu(r.localStore,i.targetId,!0))})}function $E(n,e){return A(this,null,function*(){let t=$(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),zl(t.remoteStore,r.targetId))})}function zE(n,e,t){return A(this,null,function*(){let r=JE(n);try{let i=yield(function(a,u){let h=$(a),d=ye.now(),p=u.reduce((S,O)=>S.add(O.key),Y()),y,w;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let O=Pt(),L=Y();return h.Os.getEntries(S,p).next(N=>{O=N,O.forEach((G,q)=>{q.isValidDocument()||(L=L.add(G))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,O)).next(N=>{y=N;let G=[];for(let q of u){let W=HI(q,y.get(q.key).overlayedDocument);W!=null&&G.push(new Rt(q.key,W,Gm(W.value.mapValue),vn.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,G,u)}).next(N=>{w=N;let G=N.applyToLocalDocumentSet(y,L);return h.documentOverlayCache.saveOverlays(S,N.batchId,G)})}).then(()=>({batchId:w.batchId,changes:tg(y)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,u,h){let d=a.Ru[a.currentUser.toKey()];d||(d=new he(H)),d=d.insert(u,h),a.Ru[a.currentUser.toKey()]=d})(r,i.batchId,t),yield ki(r,i.changes),yield jo(r.remoteStore)}catch(i){let o=Kl(i,"Failed to persist write");t.reject(o)}})}function Pg(n,e){return A(this,null,function*(){let t=$(n);try{let r=yield yE(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Eu.get(o);a&&(ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?ee(a.lu,14607):i.removedDocuments.size>0&&(ee(a.lu,42227),a.lu=!1))}),yield ki(t,r,e)}catch(r){yield gr(r)}})}function cm(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((o,a)=>{let u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),(function(a,u){let h=$(a);h.onlineState=u;let d=!1;h.queries.forEach((p,y)=>{for(let w of y.wa)w.va(u)&&(d=!0)}),d&&Ql(h)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function GE(n,e,t){return A(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),o=i&&i.key;if(o){let a=new he(B.comparator);a=a.insert(o,it.newNoDocument(o,z.min()));let u=Y().add(o),h=new lo(z.min(),new Map,new he(H),a,u);yield Pg(r,h),r.du=r.du.remove(o),r.Eu.delete(e),Jl(r)}else yield Yu(r.localStore,e,!1).then(()=>yl(r,e,t)).catch(gr)})}function WE(n,e){return A(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield _E(t.localStore,e);Dg(t,r,null),Rg(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ki(t,i)}catch(i){yield gr(i)}})}function HE(n,e,t){return A(this,null,function*(){let r=$(n);try{let i=yield(function(a,u){let h=$(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next(y=>(ee(y!==null,37113),p=y.keys(),h.mutationQueue.removeMutationBatch(d,y))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})})(r.localStore,e);Dg(r,e,t),Rg(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ki(r,i)}catch(i){yield gr(i)}})}function Rg(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function Dg(n,e,t){let r=$(n),i=r.Ru[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function yl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||kg(n,r)})}function kg(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(zl(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Jl(n))}function um(n,e,t){for(let r of t)r instanceof Co?(n.Au.addReference(r.key,e),KE(n,r)):r instanceof So?(F(Yl,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||kg(n,r.key)):j(19791,{yu:r})}function KE(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(F(Yl,"New document in limbo: "+t),n.Iu.add(r),Jl(n))}function Jl(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new B(ce.fromString(e)),r=n.mu.next();n.Eu.set(r,new gl(t)),n.du=n.du.insert(t,r),Ig(n.remoteStore,new bi(lt(Bl(t.path)),r,"TargetPurposeLimboResolution",Ol.ue))}}function ki(n,e,t){return A(this,null,function*(){let r=$(n),i=[],o=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((u,h)=>{a.push(r.gu(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let y=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,y?"current":"not-current")}if(d){i.push(d);let y=Wu.Es(h.targetId,d);o.push(y)}}))}),yield Promise.all(a),r.hu.J_(i),yield(function(h,d){return A(this,null,function*(){let p=$(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>D.forEach(d,w=>D.forEach(w.Is,S=>p.persistence.referenceDelegate.addReference(y,w.targetId,S)).next(()=>D.forEach(w.ds,S=>p.persistence.referenceDelegate.removeReference(y,w.targetId,S)))))}catch(y){if(!_r(y))throw y;F($l,"Failed to update sequence numbers: "+y)}for(let y of d){let w=y.targetId;if(!y.fromCache){let S=p.Fs.get(w),O=S.snapshotVersion,L=S.withLastLimboFreeSnapshotVersion(O);p.Fs=p.Fs.insert(w,L)}}})})(r.localStore,o))})}function QE(n,e){return A(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){F(Yl,"User change. New user:",e.toKey());let r=yield vg(t.localStore,e);t.currentUser=e,(function(o,a){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new M(P.CANCELLED,a))})}),o.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ki(t,r.Bs)}})}function YE(n,e){let t=$(n),r=t.Eu.get(e);if(r&&r.lu)return Y().add(r.key);{let i=Y(),o=t.Tu.get(e);if(!o)return i;for(let a of o){let u=t.Pu.get(a);i=i.unionWith(u.view.tu)}return i}}function Og(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GE.bind(null,e),e.hu.J_=FE.bind(null,e.eventManager),e.hu.pu=LE.bind(null,e.eventManager),e}function JE(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HE.bind(null,e),e}var Ng=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return A(this,null,function*(){this.serializer=Uo(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return gE(this.persistence,new Ku,t.initialUser,this.serializer)}Du(t){return new _o(Gu.Vi,this.serializer)}bu(t){return new Ju}terminate(){return A(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),vl=class extends Ng{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ee(this.persistence.referenceDelegate instanceof yo,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Ou(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Ke.withCacheSize(this.cacheSizeBytes):Ke.DEFAULT;return new _o(r=>yo.Vi(r,t),this.serializer)}};var XE=(()=>{class n{initialize(t,r){return A(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>cm(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QE.bind(null,this.syncEngine),yield xE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return(function(){return new hl})()}createDatastore(t){let r=Uo(t.databaseInfo.databaseId),i=(function(a){return new nl(a)})(t.databaseInfo);return(function(a,u,h,d){return new ol(a,u,h,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,a,u,h){return new cl(i,o,a,u,h)})(this.localStore,this.datastore,t.asyncQueue,r=>cm(this.syncEngine,r,0),(function(){return wo.C()?new wo:new Xu})())}createSyncEngine(t,r){return(function(o,a,u,h,d,p,y){let w=new _l(o,a,u,h,d,p);return y&&(w.fu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return A(this,null,function*(){var t,r;yield(function(o){return A(this,null,function*(){let a=$(o);F(Pn,"RemoteStore shutting down."),a.Ia.add(5),yield Di(a),a.Ea.shutdown(),a.Aa.set("Unknown")})})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var wl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Tt("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Yt="FirestoreClient",Il=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ee.UNAUTHENTICATED,this.clientId=_i.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>A(this,null,function*(){F(Yt,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(F(Yt,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>A(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Kl(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function $c(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F(Yt,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>A(null,null,function*(){r.isEqual(i)||(yield vg(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{Wt("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{F("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Wt("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function lm(n,e){return A(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield ZE(n);F(Yt,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>sm(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>sm(e.remoteStore,i)),n._onlineComponents=e})}function ZE(n){return A(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F(Yt,"Using user provided OfflineComponentProvider");try{yield $c(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;Wt("Error using user provided cache. Falling back to memory cache: "+t),yield $c(n,new Ng)}}else F(Yt,"Using default OfflineComponentProvider"),yield $c(n,new vl(void 0));return n._offlineComponents})}function xg(n){return A(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F(Yt,"Using user provided OnlineComponentProvider"),yield lm(n,n._uninitializedComponentsProvider._online)):(F(Yt,"Using default OnlineComponentProvider"),yield lm(n,new XE))),n._onlineComponents})}function eb(n){return xg(n).then(e=>e.syncEngine)}function hm(n){return A(this,null,function*(){let e=yield xg(n),t=e.eventManager;return t.onListen=UE.bind(null,e.syncEngine),t.onUnlisten=qE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=BE.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=$E.bind(null,e.syncEngine),t})}function Vg(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var dm=new Map;var Mg="firestore.googleapis.com",fm=!0,Po=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Mg,this.ssl=fm}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:fm;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=yg;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fE)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vg((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},fr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Po({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Po(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new zc;switch(r.type){case"firstParty":return new Kc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return A(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=dm.get(t);r&&(F("ComponentProvider","Removing Datastore"),dm.delete(t),r.terminate())})(this),Promise.resolve()}};function Fg(n,e,t,r={}){var i;n=di(n,fr);let o=on(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;o&&(Qa(`https://${h}`),Ya("Firestore",!0)),a.host!==Mg&&a.host!==h&&Wt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:h,ssl:o,emulatorOptions:r});if(!an(d,u)&&(n._setSettings(d),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=Ee.MOCK_USER;else{p=bf(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Ee(w)}n._authCredentials=new Gc(new to(p,y))}}var Rn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ke=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Ri(t,n._jsonSchema))return new n(e,r||null,new B(ce.fromString(t.referencePath)))}};ke._jsonSchemaVersion="firestore/documentReference/1.0",ke._jsonSchema={type:_e("string",ke._jsonSchemaVersion),referencePath:_e("string")};var qt=class n extends Rn{constructor(e,t,r){super(e,t,Bl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ke(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Lg(n,e,...t){if(n=Ue(n),Im("collection","path",e),n instanceof fr){let r=ce.fromString(e,...t);return Dp(r),new qt(n,null,r)}{if(!(n instanceof ke||n instanceof qt))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return Dp(r),new qt(n.firestore,null,r)}}function Ug(n,e,...t){if(n=Ue(n),arguments.length===1&&(e=_i.newId()),Im("doc","path",e),n instanceof fr){let r=ce.fromString(e,...t);return Rp(r),new ke(n,null,new B(r))}{if(!(n instanceof ke||n instanceof qt))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return Rp(r),new ke(n.firestore,n instanceof qt?n.converter:null,new B(r))}}var pm="AsyncQueue",Ro=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Io(this,"async_queue_retry"),this.oc=()=>{let r=qc();r&&F(pm,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=qc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=qc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new bt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return A(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!_r(e))throw e;F(pm,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Tt("INTERNAL UNHANDLED ERROR: ",mm(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=ul.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&j(47125,{hc:mm(this.tc)})}verifyOperationInProgress(){}Pc(){return A(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function mm(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function gm(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}var pr=class extends fr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ro,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return A(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ro(e),this._firestoreClient=void 0,yield e}})}};function Bg(n,e){let t=typeof n=="object"?n:Wn(),r=typeof n=="string"?n:e||oo,i=Rs(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=If("firestore");o&&Fg(i,...o)}return i}function jg(n){if(n._terminated)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||tb(n),n._firestoreClient}function tb(n){var e,t,r;let i=n._freezeSettings(),o=(function(u,h,d,p){return new Zc(u,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Vg(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Il(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(u){let h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}})(n._componentsProvider))}var $t=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Oe.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ri(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};$t._jsonSchemaVersion="firestore/bytes/1.0",$t._jsonSchema={type:_e("string",$t._jsonSchemaVersion),bytes:_e("string")};var Ci=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Si=class{constructor(e){this._methodName=e}};var zt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Ri(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};zt._jsonSchemaVersion="firestore/geoPoint/1.0",zt._jsonSchema={type:_e("string",zt._jsonSchemaVersion),latitude:_e("number"),longitude:_e("number")};var Gt=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ri(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new M(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Gt._jsonSchemaVersion="firestore/vectorValue/1.0",Gt._jsonSchema={type:_e("string",Gt._jsonSchemaVersion),vectorValues:_e("object")};var nb=/^__.*__$/,El=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Rt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Sn(e,this.data,t,this.fieldTransforms)}};function qg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ec:n})}}var bl=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Do(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(qg(this.Ec)&&nb.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Tl=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Uo(e)}Dc(e,t,r,i=!1){return new bl({Ec:e,methodName:t,bc:r,path:ze.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function $g(n){let e=n._freezeSettings(),t=Uo(n._databaseId);return new Tl(n._databaseId,!!e.ignoreUndefinedProperties,t)}function rb(n,e,t,r,i,o={}){let a=n.Dc(o.merge||o.mergeFields?2:0,e,t,i);Wg("Data must be an object, but it was:",a,r);let u=zg(r,a),h,d;if(o.merge)h=new ct(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let y of o.mergeFields){let w=sb(e,y,t);if(!a.contains(w))throw new M(P.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);ab(p,w)||p.push(w)}h=new ct(p),d=a.fieldTransforms.filter(y=>h.covers(y.field))}else h=null,d=a.fieldTransforms;return new El(new rt(u),h,d)}var Al=class n extends Si{_toFieldTransform(e){return new pu(e.path,new Tn)}isEqual(e){return e instanceof n}};function ib(n,e,t,r=!1){return Xl(t,n.Dc(r?4:3,e))}function Xl(n,e){if(Gg(n=Ue(n)))return Wg("Unsupported field value:",e,n),zg(n,e);if(n instanceof Si)return(function(r,i){if(!qg(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let o=[],a=0;for(let u of r){let h=Xl(u,i.yc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ye.fromDate(r);return{timestampValue:mo(i.serializer,o)}}if(r instanceof ye){let o=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mo(i.serializer,o)}}if(r instanceof zt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $t)return{bytesValue:hg(i.serializer,r._byteString)};if(r instanceof ke){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ql(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Gt)return(function(a,u){return{mapValue:{fields:{[Vl]:{stringValue:Ml},[sr]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return jl(u.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${xo(r)}`)})(n,e)}function zg(n,e){let t={};return Fm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Dn(n,(r,i)=>{let o=Xl(i,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Gg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof zt||n instanceof $t||n instanceof ke||n instanceof Si||n instanceof Gt)}function Wg(n,e,t){if(!Gg(t)||!Em(t)){let r=xo(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function sb(n,e,t){if((e=Ue(e))instanceof Ci)return e._internalPath;if(typeof e=="string")return Hg(n,e);throw Do("Field path arguments must be of type string or ",n,!1,void 0,t)}var ob=new RegExp("[~\\*/\\[\\]]");function Hg(n,e,t){if(e.search(ob)>=0)throw Do(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ci(...e.split("."))._internalPath}catch{throw Do(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Do(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new M(P.INVALID_ARGUMENT,u+n+h)}function ab(n,e){return n.some(t=>t.isEqual(e))}var ko=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Cl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Zl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Cl=class extends ko{data(){return super.data()}};function Zl(n,e){return typeof e=="string"?Hg(n,e):e instanceof Ci?e._internalPath:e._delegate._internalPath}function cb(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Pi=class{},Oo=class extends Pi{};function Kg(n,e,...t){let r=[];e instanceof Pi&&r.push(e),r=r.concat(t),(function(o){let a=o.filter(h=>h instanceof Pl).length,u=o.filter(h=>h instanceof Sl).length;if(a>1||a>0&&u>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var Sl=class n extends Oo{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Yg(e._query,t),new Rn(e.firestore,e.converter,du(e._query,t))}_parse(e){let t=$g(e.firestore);return(function(o,a,u,h,d,p,y){let w;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){ym(y,p);let O=[];for(let L of y)O.push(_m(h,o,L));w={arrayValue:{values:O}}}else w=_m(h,o,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||ym(y,p),w=ib(u,a,y,p==="in"||p==="not-in");return ge.create(d,p,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Pl=class n extends Pi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:st.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let a=i,u=o.getFlattenedFilters();for(let h of u)Yg(a,h),a=du(a,h)})(e._query,t),new Rn(e.firestore,e.converter,du(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Rl=class n extends Oo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,o,a){if(i.startAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bn(o,a)})(e._query,this._field,this._direction);return new Rn(e.firestore,e.converter,(function(i,o){let a=i.explicitOrderBy.concat([o]);return new Kt(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function Qg(n,e="asc"){let t=e,r=Zl("orderBy",n);return Rl._create(r,t)}function _m(n,e,t){if(typeof(t=Ue(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jm(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ce.fromString(t));if(!B.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Fp(n,new B(r))}if(t instanceof ke)return Fp(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xo(t)}.`)}function ym(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yg(n,e){let t=(function(i,o){for(let a of i)for(let u of a.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Dl=class{convertValue(e,t="none"){switch(Ht(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ae(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ct(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Dn(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[sr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ae(a.doubleValue));return new Gt(o)}convertGeoPoint(e){return new zt(ae(e.latitude),ae(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Mo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(wi(e));default:return null}}convertTimestamp(e){let t=At(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);ee(_g(r),9688,{name:e});let i=new ao(r.get(1),r.get(3)),o=new B(r.popFirst(5));return i.isEqual(t)||Tt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function ub(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},wn=class n extends ko{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new nr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Zl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new M(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};wn._jsonSchemaVersion="firestore/documentSnapshot/1.0",wn._jsonSchema={type:_e("string",wn._jsonSchemaVersion),bundleSource:_e("string","DocumentSnapshot"),bundleName:_e("string"),bundle:_e("string")};var nr=class extends wn{data(e={}){return super.data(e)}},rr=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new nr(this._firestore,this._userDataWriter,r.key,r,new yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new nr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:lb(u.type),doc:h,oldIndex:d,newIndex:p}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new M(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_i.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function lb(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:n})}}rr._jsonSchemaVersion="firestore/querySnapshot/1.0",rr._jsonSchema={type:_e("string",rr._jsonSchemaVersion),bundleSource:_e("string","QuerySnapshot"),bundleName:_e("string"),bundle:_e("string")};var No=class extends Dl{constructor(e){super(),this.firestore=e}convertBytes(e){return new $t(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ke(this.firestore,null,t)}};function Jg(n,e){let t=di(n.firestore,pr),r=Ug(n),i=ub(n.converter,e);return hb(t,[rb($g(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,vn.exists(!1))]).then(()=>r)}function eh(n,...e){var t,r,i;n=Ue(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||gm(e[a])||(o=e[a++]);let u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(gm(e[a])){let y=e[a];e[a]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[a+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[a+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let h,d,p;if(n instanceof ke)d=di(n.firestore,pr),p=Bl(n._key.path),h={next:y=>{e[a]&&e[a](db(d,n,y))},error:e[a+1],complete:e[a+2]};else{let y=di(n,Rn);d=di(y.firestore,pr),p=y._query;let w=new No(d);h={next:S=>{e[a]&&e[a](new rr(d,w,y,S))},error:e[a+1],complete:e[a+2]},cb(n._query)}return(function(w,S,O,L){let N=new wl(L),G=new fl(S,N,O);return w.asyncQueue.enqueueAndForget(()=>A(null,null,function*(){return VE(yield hm(w),G)})),()=>{N.Ou(),w.asyncQueue.enqueueAndForget(()=>A(null,null,function*(){return ME(yield hm(w),G)}))}})(jg(d),p,u,h)}function hb(n,e){return(function(r,i){let o=new bt;return r.asyncQueue.enqueueAndForget(()=>A(null,null,function*(){return zE(yield eb(r),i,o)})),o.promise})(jg(n),e)}function db(n,e,t){let r=t.docs.get(e._key),i=new No(n);return new wn(n,i,e._key,r,new yn(t.hasPendingWrites,t.fromCache),e.converter)}function Xg(){return new Al("serverTimestamp")}(function(e,t=!0){(function(i){mr=i})(Gn),et(new Me("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new pr(new Wc(r.getProvider("auth-internal")),new Qc(a,r.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ao(d.options.projectId,p)})(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),de(Ap,Cp,e),de(Ap,Cp,"esm2017")})();var qo=function(){return qo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},qo.apply(this,arguments)};var mb={includeMetadataChanges:!1};function Zg(n,e){return e===void 0&&(e=mb),new tn(function(t){var r=eh(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function e_(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:qo(qo({},r),(t={},t[e.idField]=n.id,t))}function t_(n){return Zg(n,{includeMetadataChanges:!0}).pipe(Lr(function(e){return e.docs}))}function n_(n,e){return e===void 0&&(e={}),t_(n).pipe(Lr(function(t){return t.map(function(r){return e_(r,e)})}))}var On=class{constructor(e){return e}},r_="firestore",th=class{constructor(){return Kn(r_)}};var nh=new Ye("angularfire2.firestore-instances");function gb(n,e){let t=Os(r_,n,e);return t&&new On(t)}function _b(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new On(r)}}var yb={provide:th,deps:[[new xt,nh]]},vb={provide:On,useFactory:gb,deps:[[new xt,nh],dn]};function i_(n,...e){return de("angularfire",ln.full,"fst"),Qi([vb,yb,{provide:nh,useFactory:_b(n),multi:!0,deps:[Vt,nn,hn,ri,[new xt,Ws],[new xt,xs],...e]}])}var s_=tt(n_,!0);var o_=tt(Jg,!0,2);var rh=tt(Lg,!0,2);var a_=tt(Bg,!0);var ih=tt(Qg,!0,2),c_=tt(Kg,!0,2);var $o=class n{firestore=we(On);bookAppointment(e){let t=rh(this.firestore,"appointments");return o_(t,Re(ve({},e),{createdAt:Xg()}))}getAllAppointments(){let e=rh(this.firestore,"appointments"),t=c_(e,ih("date"),ih("time"));return s_(t,{idField:"id"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ln({token:n,factory:n.\u0275fac,providedIn:"root"})};function wb(n,e){n&1&&(k(0,"small",27),V(1," Bitte gib Deinen Namen ein. "),R())}function Ib(n,e){n&1&&(k(0,"small",27),V(1," Bitte gib eine g\xFCltige E-Mail-Adresse ein. "),R())}function Eb(n,e){if(n&1&&(k(0,"option",28),V(1),R()),n&2){let t=e.$implicit;Q("value",t.value),U(),Le(" ",t.label," ")}}function bb(n,e){n&1&&(k(0,"small",27),V(1," Bitte w\xE4hle einen Service. "),R())}function Tb(n,e){if(n&1&&(k(0,"option",28),V(1),R()),n&2){let t=e.$implicit;Q("value",t.value),U(),Le(" ",t.label," ")}}function Ab(n,e){n&1&&(k(0,"small",27),V(1," Bitte w\xE4hle eine:n Stylist:in. "),R())}function Cb(n,e){n&1&&(vd(0),V(1," Termine nur Montag bis Donnerstag buchbar. "),wd())}function Sb(n,e){n&1&&V(0,"Bitte w\xE4hle ein Datum.")}function Pb(n,e){if(n&1&&(k(0,"small",27),se(1,Cb,2,0,"ng-container",29)(2,Sb,1,0,"ng-template",null,0,Ed),R()),n&2){let t,r=Id(3),i=Je();U(),Q("ngIf",(t=i.appointmentForm.get("date"))==null||t.errors==null?null:t.errors.disallowedDay)("ngIfElse",r)}}function Rb(n,e){n&1&&(k(0,"small",27),V(1," Bitte w\xE4hle eine Uhrzeit. "),R())}function Db(n,e){n&1&&(k(0,"p",30),V(1," Danke! Termin erfolgreich reserviert. "),R())}function kb(n,e){if(n&1&&(k(0,"p",31),V(1),R()),n&2){let t=Je();U(),qe(t.submitError)}}function Ob(n,e){if(n&1){let t=ns();k(0,"button",32),Fe("click",function(){let i=Ji(t).$implicit,o=Je();return Xi(o.selectTime(i))}),V(1),R()}if(n&2){let t=e.$implicit,r=Je();_t("selected",r.selectedTime===t),Pa("aria-pressed",r.selectedTime===t),U(),Le(" ",t," ")}}var zo=class n{formBuilder=we(pf);bookingService=we($o);services=[{value:"herren-schneiden-foehnen",label:"Herren \xB7 Schneiden/F\xF6hnen"},{value:"herren-waschen-schneiden-foehnen",label:"Herren \xB7 Waschen/Schneiden/F\xF6hnen"},{value:"herren-nassrasur",label:"Herren \xB7 Nassrasur"},{value:"herren-schneiden-formen-schere",label:"Herren \xB7 Schneiden/Formen mit Schere"},{value:"herren-bart-stutzen",label:"Herren \xB7 Bart stutzen"},{value:"herren-bart-formen",label:"Herren \xB7 Bart formen"},{value:"herren-augenbrauen-faden",label:"Herren \xB7 Augenbrauen zupfen mit Faden"},{value:"herren-wachs-gesicht",label:"Herren \xB7 Wachs Gesicht komplett"},{value:"herren-augenbrauen-messer",label:"Herren \xB7 Augenbrauen mit Messer"},{value:"herren-farbe-strahnen",label:"Herren \xB7 Farbe/Str\xE4hnen"},{value:"herren-dauerwelle",label:"Herren \xB7 Dauerwelle"},{value:"herren-haare-glaettung",label:"Herren \xB7 Haare Gl\xE4ttung"},{value:"herren-haare-waschen",label:"Herren \xB7 Haare Waschen"},{value:"damen-waschen-schneiden-kurz",label:"Damen \xB7 Waschen/Schneiden (kurz)"},{value:"damen-waschen-schneiden-lang",label:"Damen \xB7 Waschen/Schneiden (lang)"},{value:"damen-waschen-schneiden-foehnen",label:"Damen \xB7 Waschen/Schneiden/F\xF6hnen"},{value:"damen-haarmaske",label:"Damen \xB7 Haarmaske"},{value:"damen-pony-schneiden",label:"Damen \xB7 Pony schneiden"},{value:"damen-ansaetze-faerben",label:"Damen \xB7 Ans\xE4tze f\xE4rben"},{value:"damen-komplett-faerben",label:"Damen \xB7 Komplett f\xE4rben"},{value:"damen-strahnen-oberkopf",label:"Damen \xB7 Str\xE4hnen am Oberkopf"},{value:"damen-strahnen-komplett",label:"Damen \xB7 Str\xE4hnen komplett"},{value:"damen-foehnen",label:"Damen \xB7 F\xF6hnen"},{value:"damen-dauerwelle",label:"Damen \xB7 Dauerwelle"},{value:"damen-haare-glaettung",label:"Damen \xB7 Haare Gl\xE4ttung"},{value:"damen-augenbrauen-faden",label:"Damen \xB7 Augenbrauen zupfen (Faden)"},{value:"damen-augenbrauen-faerben",label:"Damen \xB7 Augenbrauen f\xE4rben"},{value:"damen-wimpern-faerben",label:"Damen \xB7 Wimpern f\xE4rben"},{value:"damen-balayage",label:"Damen \xB7 Balayage"},{value:"kinder-jungs-bis-7",label:"Kinder \xB7 Jungs bis 7 Jahre"},{value:"kinder-maedchen-bis-7",label:"Kinder \xB7 M\xE4dchen bis 7 Jahre"}];stylists=[{value:"egal",label:"Beliebig"},{value:"mahmoud",label:"Mahmoud"},{value:"tarek",label:"Tarek"}];timeSlots=this.createTimeSlots(8,21,30);appointmentForm=this.formBuilder.group({service:["",Xe.required],stylist:["",Xe.required],date:["",[Xe.required,this.validateAllowedWeekdays.bind(this)]],time:["",Xe.required],name:["",[Xe.required,Xe.minLength(2)]],email:["",[Xe.required,Xe.email]],notes:[""]});selectedTime=null;isSubmitting=!1;submitError="";submitSuccess=!1;submitted=!1;selectTime(e){this.selectedTime=e;let t=this.appointmentForm.get("time");t?.setValue(e),t?.markAsDirty(),t?.markAsTouched()}submit(){return A(this,null,function*(){if(console.log("\u2705 submit() aufgerufen"),this.submitted=!0,this.submitError="",this.submitSuccess=!1,this.appointmentForm.invalid){console.warn("\u274C Formular ist ung\xFCltig",this.appointmentForm.value),this.appointmentForm.markAllAsTouched();return}let e=this.appointmentForm.value;console.log("\u{1F4E6} Payload f\xFCr Firestore & Mail:",e),this.isSubmitting=!0;try{console.log("\u{1F4BE} Speichere Termin in Firestore \u2026"),yield this.bookingService.bookAppointment(e),console.log("\u2705 Termin in Firestore gespeichert"),console.log("\u{1F4E8} Sende Daten an Vercel/Resend \u2026");let t=yield fetch("https://city-style-mail-api.vercel.app/api/send-appointment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log("\u{1F501} Response von Vercel:",t.status,t.statusText);let r="";try{r=yield t.text(),console.log("\u{1F4E8} Response-Body:",r)}catch(i){console.warn("Konnte Response-Body nicht lesen",i)}if(!t.ok)throw new Error(`E-Mail API Fehler: ${t.status} ${r}`);this.submitSuccess=!0,this.appointmentForm.reset(),this.selectedTime=null,this.submitted=!1,console.log("\u{1F389} Alles erfolgreich \u2013 Termin + E-Mails")}catch(t){console.error("\u274C Fehler bei Buchung oder Mail-Versand:",t),this.submitError="Ups! Etwas ist schiefgelaufen. Bitte versuche es erneut."}finally{this.isSubmitting=!1}})}createTimeSlots(e,t,r){let i=[],o=e*60,a=t*60;for(let u=o;u<=a;u+=r){let h=Math.floor(u/60),d=u%60;i.push(`${h.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`)}return i}validateAllowedWeekdays(e){if(!e.value)return null;let t=new Date(e.value).getDay();return t===0||t>=5?{disallowedDay:!0}:null}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-appointment"]],decls:65,vars:17,consts:[["requiredDate",""],["id","termine",1,"appointment-section"],[1,"section-heading"],[1,"eyebrow"],["href","tel:+49911421966"],[1,"appointment-wrapper"],[3,"ngSubmit","formGroup"],[1,"form-grid"],["type","text","formControlName","name","placeholder","Dein Name"],["class","error",4,"ngIf"],["type","email","formControlName","email","placeholder","you@citymail.de"],["formControlName","service"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","stylist"],["type","date","formControlName","date"],[1,"time-display"],[1,"time-value"],["type","hidden","formControlName","time"],[1,"notes"],["formControlName","notes","rows","4","placeholder","Moodboard, Haarstruktur oder W\xFCnsche \u2026"],["type","submit",1,"submit",3,"disabled"],["class","confirmation",4,"ngIf"],["class","error global",4,"ngIf"],[1,"info-card"],[1,"time-grid"],["type","button","class","time-slot",3,"selected","click",4,"ngFor","ngForOf"],[1,"error"],[3,"value"],[4,"ngIf","ngIfElse"],[1,"confirmation"],[1,"error","global"],["type","button",1,"time-slot",3,"click"]],template:function(t,r){if(t&1&&(k(0,"section",1)(1,"div",2)(2,"span",3),V(3,"Termin vereinbaren"),R(),k(4,"h2"),V(5,"Dein Termin im City-Style Salon"),R(),k(6,"p"),V(7," Service, Stylist:in und Termin w\xE4hlen \u2013 wir melden uns blitzschnell zur Best\xE4tigung. Kurzfristig erreichbar unter "),k(8,"a",4),V(9,"0911 421966"),R(),V(10,". "),R()(),k(11,"div",5)(12,"form",6),Fe("ngSubmit",function(){return r.submit()}),k(13,"div",7)(14,"label")(15,"span"),V(16,"Name"),R(),oe(17,"input",8),se(18,wb,2,0,"small",9),R(),k(19,"label")(20,"span"),V(21,"E-Mail"),R(),oe(22,"input",10),se(23,Ib,2,0,"small",9),R(),k(24,"label")(25,"span"),V(26,"Service"),R(),k(27,"select",11)(28,"option",12),V(29,"Bitte ausw\xE4hlen"),R(),se(30,Eb,2,2,"option",13),R(),se(31,bb,2,0,"small",9),R(),k(32,"label")(33,"span"),V(34,"Stylist:in"),R(),k(35,"select",14)(36,"option",12),V(37,"Bitte ausw\xE4hlen"),R(),se(38,Tb,2,2,"option",13),R(),se(39,Ab,2,0,"small",9),R(),k(40,"label")(41,"span"),V(42,"Datum"),R(),oe(43,"input",15),se(44,Pb,4,2,"small",9),R(),k(45,"label",16)(46,"span"),V(47,"Uhrzeit"),R(),k(48,"div",17),V(49),R(),oe(50,"input",18),se(51,Rb,2,0,"small",9),R()(),k(52,"label",19)(53,"span"),V(54,"Styling-Notes (optional)"),R(),oe(55,"textarea",20),R(),k(56,"button",21),V(57),R(),se(58,Db,2,0,"p",22)(59,kb,2,1,"p",23),R(),k(60,"aside",24)(61,"h3"),V(62,"W\xE4hle Deine Uhrzeit"),R(),k(63,"div",25),se(64,Ob,2,4,"button",26),R()()()()),t&2){let i,o,a,u,h,d;U(12),Q("formGroup",r.appointmentForm),U(6),Q("ngIf",((i=r.appointmentForm.get("name"))==null?null:i.touched)&&((i=r.appointmentForm.get("name"))==null?null:i.invalid)),U(5),Q("ngIf",((o=r.appointmentForm.get("email"))==null?null:o.touched)&&((o=r.appointmentForm.get("email"))==null?null:o.invalid)),U(7),Q("ngForOf",r.services),U(),Q("ngIf",((a=r.appointmentForm.get("service"))==null?null:a.touched)&&((a=r.appointmentForm.get("service"))==null?null:a.invalid)),U(7),Q("ngForOf",r.stylists),U(),Q("ngIf",((u=r.appointmentForm.get("stylist"))==null?null:u.touched)&&((u=r.appointmentForm.get("stylist"))==null?null:u.invalid)),U(5),Q("ngIf",((h=r.appointmentForm.get("date"))==null?null:h.touched)&&((h=r.appointmentForm.get("date"))==null?null:h.invalid)),U(4),_t("empty",!r.selectedTime),U(),Le(" ",r.selectedTime??"Bitte rechts eine Uhrzeit anklicken"," "),U(2),Q("ngIf",((d=r.appointmentForm.get("time"))==null?null:d.touched)&&((d=r.appointmentForm.get("time"))==null?null:d.invalid)),U(5),Q("disabled",r.isSubmitting),U(),Le(" ",r.isSubmitting?"Wird gesendet \u2026":"Termin sichern"," "),U(),Q("ngIf",r.submitSuccess),U(),Q("ngIf",r.submitError),U(5),Q("ngForOf",r.timeSlots)}},dependencies:[Ie,Ge,rs,mf,cf,hf,ff,Is,bs,tf,nf,qa,$a],styles:[".appointment-section[_ngcontent-%COMP%]{padding:3.5rem 0;background:#f1edf4;min-height:100vh;display:flex;flex-direction:column;justify-content:center;gap:1.6rem}.section-heading[_ngcontent-%COMP%]{text-align:center;max-width:640px;margin:0 auto 1.6rem;color:#0c0a18}.section-heading[_ngcontent-%COMP%]   .eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.45rem;color:#dcbf68;display:block;margin-bottom:1.1rem}.section-heading[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:clamp(2.1rem,2.6vw,3.1rem);margin-bottom:.8rem}.section-heading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.5;font-size:.96rem}.section-heading[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#dcbf68;font-weight:600;text-decoration:none}.appointment-wrapper[_ngcontent-%COMP%]{width:100%;max-width:1400px;margin:0 auto;padding:0 2.5rem;display:grid;grid-template-columns:minmax(0,1.4fr) minmax(0,1fr);gap:1.6rem;align-items:stretch}form[_ngcontent-%COMP%]{background:#fff;padding:1.75rem;border-radius:1.5rem;box-shadow:0 20px 48px #0c0a181a;border:1px solid rgba(12,10,24,.04);display:flex;flex-direction:column;height:100%}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:1rem}label[_ngcontent-%COMP%]{display:grid;gap:.45rem;color:#0c0a18c7;font-weight:600;letter-spacing:.02rem}.time-display[_ngcontent-%COMP%]   .time-value[_ngcontent-%COMP%]{background:#0c0a180a;border:1px dashed rgba(12,10,24,.18);border-radius:.85rem;padding:.7rem .95rem;font-weight:600;color:#0c0a18}.time-display[_ngcontent-%COMP%]   .time-value.empty[_ngcontent-%COMP%]{color:#0c0a1873}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem .95rem;border-radius:1rem;border:1px solid rgba(12,10,24,.1);font-size:1rem;background:#0c0a1805;transition:border-color .3s ease,box-shadow .3s ease;font-family:Poppins,sans-serif}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#dcbf68;box-shadow:0 0 0 4px #dcbf6838;outline:none}.notes[_ngcontent-%COMP%]{margin-top:1rem}textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.submit[_ngcontent-%COMP%]{margin-top:1.5rem;width:100%;padding:.9rem 1.4rem;border-radius:999px;border:none;background:linear-gradient(135deg,#f7e7b4,#dcbf68);color:#0c0a18;font-weight:700;letter-spacing:.08rem;text-transform:uppercase;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease,opacity .3s ease}.submit[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-4px);box-shadow:0 20px 35px #dcbf6861}.submit[_ngcontent-%COMP%]:disabled{opacity:.65;cursor:not-allowed;box-shadow:none}.error[_ngcontent-%COMP%]{font-size:.78rem;color:#d92855;font-weight:500}.error.global[_ngcontent-%COMP%]{text-align:center;margin-top:.8rem}.confirmation[_ngcontent-%COMP%]{margin-top:1.5rem;text-align:center;font-weight:600;color:#28a97a}.info-card[_ngcontent-%COMP%]{background:linear-gradient(145deg,#0c0a18,#1c1133);color:#fff;padding:1.7rem;border-radius:1.5rem;box-shadow:0 20px 48px #0c0a1833;display:flex;flex-direction:column;gap:1.2rem;height:100%}.info-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.35rem;color:#dcbf68}.time-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:.6rem;max-height:clamp(260px,45vh,360px);overflow-y:auto;padding-right:.2rem;scroll-snap-type:y proximity;flex:1 1 auto}.time-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.time-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.time-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff59}.time-slot[_ngcontent-%COMP%]{width:100%;padding:.7rem .4rem;border-radius:.85rem;border:1px solid rgba(255,255,255,.12);background:#ffffff14;color:#fff;font-weight:600;letter-spacing:.04rem;cursor:pointer;transition:transform .2s ease,background .2s ease,border-color .2s ease;scroll-snap-align:start}.time-slot[_ngcontent-%COMP%]:hover{transform:translateY(-1px);background:#ffffff29}.time-slot.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f7e7b4,#dcbf68);color:#0c0a18;border-color:transparent;box-shadow:0 12px 24px #dcbf6847}.time-note[_ngcontent-%COMP%]{margin:0;font-size:.85rem;line-height:1.45;color:#ffffffb8;flex-shrink:0}@media (max-width: 900px){.appointment-wrapper[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1.5rem;padding:0 1.5rem}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media (max-width: 600px){.time-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,minmax(0,1fr));max-height:240px}}"]})};function Nb(n,e){if(n&1&&(k(0,"figure"),oe(1,"img",6),R()),n&2){let t=e.$implicit,r=e.index,i=Je();U(),Q("src",t.image,ts)("alt","City-Style Look "+(r%i.itemCount+1))}}var Go=class n{baseItems=[{image:"assets/bild1.jpeg"},{image:"assets/bild2.jpeg"},{image:"assets/bild3.jpeg"},{image:"assets/city5.webp"},{image:"assets/city6.webp"},{image:"assets/city8.webp"},{image:"assets/city9.webp"}];marqueeItems=[...this.baseItems,...this.baseItems];itemCount=this.baseItems.length;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-gallery"]],decls:11,vars:1,consts:[["id","galerie",1,"gallery-section"],[1,"section-heading"],[1,"eyebrow"],["aria-label","City-Style Galerie",1,"marquee"],[1,"marquee-track"],[4,"ngFor","ngForOf"],["loading","lazy",3,"src","alt"]],template:function(t,r){t&1&&(k(0,"section",0)(1,"div",1)(2,"span",2),V(3,"Galerie"),R(),k(4,"h2"),V(5,"Looks, die City-Style definieren"),R(),k(6,"p"),V(7," Lass Dich von unseren aktuellen Trend- und Signature-Looks inspirieren. "),R()(),k(8,"div",3)(9,"div",4),se(10,Nb,2,2,"figure",5),R()()()),t&2&&(U(10),Q("ngForOf",r.marqueeItems))},dependencies:[Ie,Ge],styles:[".gallery-section[_ngcontent-%COMP%]{padding:4.5rem 1.5rem;min-height:100vh;display:flex;flex-direction:column;justify-content:center;gap:2.5rem}.section-heading[_ngcontent-%COMP%]{text-align:center;max-width:680px;margin:0 auto 2rem}.section-heading[_ngcontent-%COMP%]   .eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.45rem;color:#dcbf68;display:block;margin-bottom:1.1rem}.section-heading[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:clamp(2.2rem,3vw,3.3rem);margin-bottom:1rem;color:#0c0a18}.section-heading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#0c0a18a6;line-height:1.6;font-size:1rem}.marquee[_ngcontent-%COMP%]{position:relative;width:100%;overflow:hidden;border-radius:1.5rem;box-shadow:0 20px 45px #0c0a182e}.marquee-track[_ngcontent-%COMP%]{display:flex;gap:1.2rem;animation:_ngcontent-%COMP%_gallery-scroll 18s linear infinite}.marquee[_ngcontent-%COMP%]:hover   .marquee-track[_ngcontent-%COMP%]{animation-play-state:paused}.marquee-track[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{flex:0 0 clamp(240px,28vw,380px);margin:0;border-radius:1.4rem;overflow:hidden;box-shadow:0 18px 35px #0c0a182e}.marquee-track[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:clamp(220px,45vh,420px);object-fit:cover;display:block}@keyframes _ngcontent-%COMP%_gallery-scroll{0%{transform:translate(0)}to{transform:translate(-50%)}}@media (max-width: 900px){.marquee-track[_ngcontent-%COMP%]{gap:1rem;animation-duration:10s}.marquee-track[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{flex:0 0 clamp(200px,45vw,320px)}}@media (max-width: 600px){.marquee-track[_ngcontent-%COMP%]{gap:.75rem;animation-duration:10s}.marquee-track[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{flex:0 0 clamp(180px,70vw,260px)}.marquee-track[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:clamp(200px,40vh,320px)}}"]})};function xb(n,e){if(n&1&&(k(0,"li")(1,"a",15),V(2),k(3,"span"),V(4),R()()()),n&2){let t=e.$implicit;U(),Q("href",t.url,ts),U(),Le(" ",t.label," "),U(2),qe(t.handle)}}function Vb(n,e){if(n&1&&(k(0,"li")(1,"span",16),V(2),R(),k(3,"span",17),V(4),R()()),n&2){let t=e.$implicit;U(2),qe(t.day),U(2),qe(t.time)}}var Wo=class n{socials=[{label:"Instagram",url:"https://www.instagram.com/city0style/",handle:"@citystyle.salon"},{label:"Facebook",url:"https://www.facebook.com/City0Style/",handle:"/citystyle.salon"}];hours=[{day:"Mo \xB7 Sa",time:"09:00 \u2013 20:00"},{day:"So",time:"Geschlossen"}];static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-contact"]],decls:28,vars:2,consts:[["id","kontakt",1,"contact-section"],["data-animate","fade-right",1,"contact-info"],[1,"contact-header"],[1,"eyebrow"],[1,"intro"],[1,"contact-details"],["href","tel:+49911421966"],["href","mailto:hallo@city-style.de"],[1,"socials"],[4,"ngFor","ngForOf"],[1,"map-embed"],["title","City-Style Salon N\xFCrnberg","src",fd`https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2597.1069302718883!2d11.08333667633661!3d49.4385072629948!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x479f5668c4e5c543%3A0xdaf7c1d508edc437!2sGibitzenhofstra%C3%9Fe%2019%2C%2090443%20N%C3%BCrnberg!5e0!3m2!1sde!2sde!4v1700000000000!5m2!1sde!2sde`,"loading","lazy","referrerpolicy","no-referrer-when-downgrade"],["data-animate","fade-left",1,"hours-card"],[1,"hours-list"],[1,"hours-note"],["target","_blank","rel","noopener noreferrer",3,"href"],[1,"day"],[1,"time"]],template:function(t,r){t&1&&(k(0,"section",0)(1,"div",1)(2,"header",2)(3,"p",3),V(4,"City-Style N\xFCrnberg"),R(),k(5,"h2"),V(6,"Kontakt & Anfahrt"),R(),k(7,"p",4),V(8," Gibitzenhofstra\xDFe 19 \xB7 90443 N\xFCrnberg"),oe(9,"br"),R()(),k(10,"div",5)(11,"a",6),V(12,"0911 421966"),R(),k(13,"a",7),V(14,"hallo@city-style.de"),R()(),k(15,"ul",8),se(16,xb,5,3,"li",9),R(),k(17,"div",10),oe(18,"iframe",11),R()(),k(19,"div",12)(20,"h3"),V(21,"\xD6ffnungszeiten"),R(),k(22,"p"),V(23," Wir arbeiten mit flexiblen Slots \u2013 sichere Dir Deinen Termin online oder ruf kurz durch, wenn Du einen Express-Service brauchst. "),R(),k(24,"ul",13),se(25,Vb,5,2,"li",9),R(),k(26,"p",14),V(27," Late-Night-Termine auf Anfrage \xB7 Silent Appointments m\xF6glich \xB7 Walk-ins nach Verf\xFCgbarkeit "),R()()()),t&2&&(U(16),Q("ngForOf",r.socials),U(9),Q("ngForOf",r.hours))},dependencies:[Ie,Ge],styles:['.contact-section[_ngcontent-%COMP%]{width:100%;max-width:1360px;margin:0 auto;padding:2rem 0;display:grid;grid-template-columns:minmax(0,1.15fr) minmax(0,.85fr);gap:1.5rem;align-items:stretch;min-height:85vh}.contact-info[_ngcontent-%COMP%]{background:linear-gradient(145deg,#0c0a18,#1c1133);color:#fff;border-radius:1.6rem;padding:1.8rem;display:flex;flex-direction:column;gap:1rem;position:relative;overflow:hidden;box-shadow:0 22px 45px #0c0a1842}.contact-info[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;background:radial-gradient(circle at top right,rgba(220,191,104,.3),transparent 60%);pointer-events:none}.contact-header[_ngcontent-%COMP%]   .eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.4rem;color:#f7e7b4e6;font-size:.8rem}.contact-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Playfair Display,serif;font-size:clamp(1.8rem,2.6vw,2.3rem);margin:.2rem 0 .5rem}.contact-header[_ngcontent-%COMP%]   .intro[_ngcontent-%COMP%]{margin:0;line-height:1.45;color:#ffffffc7;font-size:.9rem}.contact-details[_ngcontent-%COMP%]{display:grid;gap:.65rem}.contact-details[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#dcbf68;text-decoration:none;font-weight:600}.map-embed[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;border-radius:1.3rem;overflow:hidden;box-shadow:0 16px 32px #00000047}.map-embed[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{border:0;width:100%;height:100%;min-height:230px;filter:saturate(.9)}.map-overlay[_ngcontent-%COMP%]{position:absolute;left:.8rem;bottom:.8rem;right:.8rem;display:flex;justify-content:space-between;padding:.75rem 1rem;border-radius:.9rem;background:#0c0a18cc;color:#f7e7b4;font-weight:600;letter-spacing:.04rem}.socials[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:grid;gap:.8rem}.socials[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ffffffbf;text-decoration:none;display:flex;justify-content:space-between;align-items:center;padding:.85rem 1rem;border-radius:1rem;transition:background .3s ease,transform .3s ease}.socials[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#dcbf68}.socials[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:translate(6px)}.hours-card[_ngcontent-%COMP%]{background:#fff;border-radius:1.5rem;box-shadow:0 18px 40px #0c0a1817;padding:1.8rem;display:flex;flex-direction:column;gap:.9rem}.hours-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.8rem;color:#0c0a18;margin:0}.hours-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#0c0a18a6;font-size:.95rem;line-height:1.5}.hours-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:grid;gap:.65rem}.hours-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:600;color:#0c0a18;padding:.45rem 0;border-bottom:1px solid rgba(12,10,24,.08)}.hours-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.hours-list[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{color:#0c0a188c}.hours-note[_ngcontent-%COMP%]{font-size:.85rem;color:#0c0a1899;margin-top:auto}[data-animate=fade-right][_ngcontent-%COMP%], [data-animate=fade-left][_ngcontent-%COMP%]{opacity:0;transform:translate3d(-30px,0,0);animation:_ngcontent-%COMP%_contactFade 1.1s ease forwards}[data-animate=fade-left][_ngcontent-%COMP%]{transform:translate3d(30px,0,0);animation-delay:.2s}@keyframes _ngcontent-%COMP%_contactFade{to{opacity:1;transform:translateZ(0)}}@media (max-width: 1024px){.contact-section[_ngcontent-%COMP%]{grid-template-columns:1fr;padding:2.5rem 1.2rem;min-height:auto}.map-embed[_ngcontent-%COMP%]{min-height:280px}}@media (max-width: 600px){.contact-info[_ngcontent-%COMP%]{padding:1.6rem}.hours-card[_ngcontent-%COMP%]{padding:1.5rem}.map-overlay[_ngcontent-%COMP%]{flex-direction:column;gap:.4rem;text-align:center}}']})};var Ho=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=fe({type:n,selectors:[["app-home"]],decls:13,vars:0,consts:[[1,"page"],["id","start"],["id","ueber-uns"],["id","preise"],["id","termine"],["id","galerie"],["id","kontakt"]],template:function(t,r){t&1&&(k(0,"main",0)(1,"section",1),oe(2,"app-hero"),R(),k(3,"section",2),oe(4,"app-about"),R(),k(5,"section",3),oe(6,"app-pricing"),R(),k(7,"section",4),oe(8,"app-appointment"),R(),k(9,"section",5),oe(10,"app-gallery"),R(),k(11,"section",6),oe(12,"app-contact"),R()())},dependencies:[Ie,cs,us,ls,zo,Go,Wo],styles:["[_nghost-%COMP%]{display:block}.page[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}"]})};var u_=[{path:"",component:Ho},{path:"datenschutzundimpressum",loadComponent:()=>import("./chunk-BGLLGJ4B.js").then(n=>n.LegalComponent)},{path:"**",redirectTo:""}];var l_={production:!1,firebase:{apiKey:"AIzaSyDHr47BoMyrRiuCzPHp85fFWEIwmjBFLkU",authDomain:"city-style-d7c72.firebaseapp.com",projectId:"city-style-d7c72",storageBucket:"city-style-d7c72.firebasestorage.app",messagingSenderId:"860651812709",appId:"1:860651812709:web:0330305fe6234ed626d38c",measurementId:"G-SQVWDV27QS"}};var h_={providers:[Sd(u_,Rd(),Pd({anchorScrolling:"enabled",scrollPositionRestoration:"enabled"})),Kf(()=>Qf(l_.firebase)),i_(()=>a_())]};Td(as,h_).catch(n=>console.error(n));
